2012-04-30  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* defaults.h (TARGET_COMPACT_EH): Provide default definition.

	libstdc++-v3/
	* libsupc++/eh_compact_pr.cc: Build only when MD_HAVE_COMPACT_EH
	is defined.

2012-04-30  Nathan Sidwell  <nathan@codesourcery.com>

	gcc/
	* explow.c (promote_mode): Move local decls to avoid mixing with
	code.

2012-04-27  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: New note.

	gcc/
	* dwarf2asm.c (dw2_asm_output_comment): New function.
	(dw2_asm_output_delta_setbit0_uleb128): New function.
	* dwarf2asm.h (dw2_asm_output_comment): Declare.
	(dw2_asm_output_delta_setbit0_uleb128): Declare.
	* unwind-compact.h (EH_FRAME_HEADER_VERSION): Define.
	* unwind-compat.c (_Unwind_GetEhEncoding): New function.
	* unwind-dw2-fde.h (dwarf_eh_bases): Add eh_encoding field.
	* tree.c (lhd_gcc_personality): Add argument to call to
	build_personality_function.
	* tree.h (DECL_FUNCTION_PERSONALITY2): New macro.
	(tree_function_decl): Add personality2 field.
	* cp/cp-lang.c (cp_eh_personality): Initialize personality2.
	* expr.c (build_personality_function):  Build __gnu_compact_pr2
	and __gnu_compact_pr3.
	* unwind-dw2.c (_Unwind_GetEhEncoding): New function.
	(uw_frame_state_for): Save the eh_encoding.
	* tree-eh.c (lower_eh_dispatch): Use compact_filter_list for
	TARGET_COMPACT_EH.
	* except.c (assign_filter_values): Set up filter values for
	the compact encoding.
	(compact_encode_catch_count): New function.
	(compact_count_eh_specs): New function.
	(compact_ends_in_catchall): New function.
	(compact_count_like_headers): New function.
	(compact_emit_region_header): New function.
	(read_sleb128): New function.
	(output_one_function_compact_eh_table): New function.
	(output_one_function_exception_table): Emit compact exception
	tables.
	* except.h (eh_compact_header_type): New enumeration.
	(eh_catch_d): Add compact_filter_list field.
	* unwind-generic.h (_Unwind_GetEhEncoding): Declare.
	* config/mips/mips.c (mips_unspec_may_trap_p): New function.
	(TARGET_UNSPEC_MAY_TRAP_P): Define.

	libgcc/
	* libgcc-std.ver.in

	libstdc++-v3/
	* libsupc++/eh_compact_pr.cc: New file.
	* libsupc++/unwind-cxx.h (__gnu_compact_pr2): Declare.
	(__gnu_compact_pr3): Declare.
	* libsupc++/eh_personality.cc (check_compact_exception_spec):
	New function.
	(__cxa_call_unexpected): Handle compact exception specs.
	* libsupc++/Makefile.am: Build eh_compact_pr.cc
	* libsupc++/Makefile.in: Regenerate.
	* config/abi/pre/gnu.ver: Add __gnu_compact_pr2 and
	__gnu_compact_pr3.
	* config/abi/pre/gnu-versioned-namespace.ver: Likewise.

2012-04-27  Iain Sandoe  <iain@codesourcery.com>

	Issue #13149

	gcc/
	* config/mips/mips.c (micromips_save_restore_pattern_p): Disallow
	volatile mems.
	* config/mips/predicates.md (non_volatile_mem_operand): New.
	* config/mips/micromips.md (lwp peephole):
	Use non_volatile_mem_operand predicate.
	(swp peephole): Likewise.

	gcc/testsuite/
	* gcc.target/mips/micromips-lwp-swp-volatile.c: New.

2012-04-26  Joseph Myers  <joseph@codesourcery.com>

	Forward port:

	2011-03-22  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #10800

	gcc/
	* tree-ssa-loop-promote.c (struct promote_info): Add uid field.
	(promote_info_p): Define.  Declare a VEC of it.
	(compare_promote_info): New function.
	(gimple_p): Define.  Declare a VEC of it.
	(phi_uid): Declare.
	(analyze_loop): Change return type and take proper argument types.
	(add_variable, promote_phi_node): Likewise.
	(create_promoted_variable, promote_variable): Likewise.
	(record_promotable_variables): New function.
	(record_phi_node): New function.
	(rebuild_with_promotion): Set the UID of the phi.
	(collection_promotion_candidates): Set uid.
	(compare_gimple_phis): New function.
	(promote_short_indices): Iterate over things in stable order.

2012-04-17  Meador Inge  <meadori@codesourcery.com>

	CB-1003

	* release-notes-csl.xml (Internal compiler error): New note.
	* config/arm/arm.md (*arm_zero_extendhisi2): Add pool range attributes.
	(*arm_zero_extendhisi2_v6): Ditto.
	(*arm_zero_extendqisi2): Ditto.
	(*arm_zero_extendqisi2_v6): Ditto.

2012-04-17  Meador Inge  <meadori@codesourcery.com>

	Issue #13031

	* release-notes-csl.xml (Fix for internal compiler error): New note.

	Backport from mainline (with minor adjustments for 4.6):

	gcc/
	2012-03-29 Meador Inge <meadori@codesourcery.com>

 	PR c++/52672
 	* semantics.c (cxx_eval_indirect_ref): Don't attempt to fold
 	stripped child trees that are not pointer types.

	2012-03-29 Meador Inge <meadori@codesourcery.com>

	gcc/testsuite/
	2012-03-29 Meador Inge <meadori@codesourcery.com>

 	PR c++/52672
 	* g++.dg/cpp0x/constexpr-52672.C: New testcase.

2012-04-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2012-04-06  Mike Stump  <mikestump@comcast.net>

	PR testsuite/50722
	* gcc.dg/pr49994-3.c: Use -w to squelch non-portable warnings.

2012-04-03  Chung-Lin Tang  <cltang@codesourcery.com>

	* release-notes-csl.xml
	(Improvement of backtrace on &csl_target_name;): New note.

	Issue #12949

	* release-notes-csl.xml (Compiler crash fixed): New note.

2012-04-02  Catherine Moore  <clm@codesourcery.com>

	Backport from mainline:

	gcc/
	2011-11-27  Richard Sandiford  <rdsandiford@googlemail.com>
	* config/mips/mips.c (mips16_unextended_reference_p): Test for BLKmode.

2012-04-01  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config.gcc (powerpc*-*-linux*): Enable PowerPC 476 features
	for LSI powerpc-lsi-linux* configuration.

	Backport from mainline:

	2012-01-27  Peter Bergner  <bergner@vnet.ibm.com>

	gcc/
	* config/rs6000/rs6000.c (rs6000_option_override_internal):
	Set rs6000_always_hint to false for 476.

	2011-11-02  Peter Bergner  <bergner@vnet.ibm.com>
	Iain Sandoe  <iains@gcc.gnu.org>

	gcc/
	* config/rs6000/rs6000.c (USE_HIDDEN_LINKONCE): New define.
	(get_ppc476_thunk_name): Use it.
	(rs6000_code_end): Likewise.
	(macho_branch_islands): Fix typo.

	2011-11-02  Alan Modra  <amodra@gmail.com>

	gcc/
	* config/rs6000/rs6000.c (rs6000_code_end): Declare ATTRIBUTE_UNUSED.

	2011-11-01  Peter Bergner  <bergner@vnet.ibm.com>

	gcc/
	* config.gcc (powerpc*-*-linux*): Add powerpc*-*-linux*ppc476* variant.
	* config/rs6000/476.h: New file.
	* config/rs6000/476.opt: Likewise.
	* config/rs6000/rs6000.h (TARGET_LINK_STACK): New define.
	(SET_TARGET_LINK_STACK): Likewise.
	(TARGET_ASM_CODE_END): Define.
	* config/rs6000/rs6000.c (rs6000_option_override_internal): Enable
	TARGET_LINK_STACK for -mtune=476 and -mtune=476fp.
	(rs6000_legitimize_tls_address): Emit the link stack preserving GOT
	code if TARGET_LINK_STACK.
	(rs6000_emit_load_toc_table): Likewise.
	(output_function_profiler): Likewise
	(macho_branch_islands): Likewise
	(machopic_output_stub): Likewise
	(get_ppc476_thunk_name): New function.
	(rs6000_code_end): Likewise.
	* config/rs6000/rs6000.md (load_toc_v4_PIC_1, load_toc_v4_PIC_1b):
	Convert to a define_expand.
	(load_toc_v4_PIC_1_normal): New define_insn.
	(load_toc_v4_PIC_1_476): Likewise.
	(load_toc_v4_PIC_1b_normal): Likewise.
	(load_toc_v4_PIC_1b_476): Likewise.

2012-03-30  Catherine Moore  <clm@codesourcery.com>

	Merge from SCB GCC 4.5:

	2010-11-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/micromips.md (define_peephole2 for lwp)
	(define_insn "*lwp", define_peephole2 for swp, define_insn "*swp")
	(define_peephole2 for movep, define_insn "*movepsisi")
	(define_insn "*movepsisf", define_insn "*movepsfsi"): Guard usage of
	REGNO with REG_P.

2012-03-29  Catherine Moore  <clm@codesourcery.com>

	Merge from SCB GCC 4.5:
	
	2010-10-14  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* config/mips/micromips.md (*lwp, *swp): Fix 'control reaches end of
	non-void function' warnings.

2012-03-27  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #12949

	Backport from mainline:

	gcc/
	2012-03-27  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/52667
	* config/sh/sh.c (find_barrier): Add equality check of last_got
	to avoid going above orig insn. Update comments.

2012-03-27  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12928
	gcc/
	* haifa-sched.c (prune_ready_list): Rework handling of SHCED_GROUP_P
	insns so that no other insn is queued for a time before them.

2012-03-22  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #13105
	gcc/
	* config/m68k/m68k.c (m68k_sched_md_init): Reset curr_state.

	Issue #13105
	gcc/
	* sel-sched.c (sel_global_init): Swap order of sched_rgn_init and
	sched_init calls.

2012-03-19  Joseph Myers  <joseph@codesourcery.com>

	Backport from mainline:

	libstdc++-v3/
	2011-12-15  Benjamin Kosnik  <bkoz@redhat.com>

	* testsuite/22_locale/num_put/put/char/9780-2.cc: Add test for "C"
	locale, add sanity checks in case of grouping.

2012-03-19  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config/sh/sh.c (output_stack_adjust): Remove !epilogue_p
	condition for generating REG_FRAME_RELATED_EXPR note.
	(pop): Add code for generating REG_CFA_RESTORE, REG_CFA_ADJUST_CFA
	notes. Set RTX_FRAME_RELATED_P to 1.
	(sh_expand_epilogue): Use frame_insn() for FP to SP move.
	Set 'frame_p' of calls to output_stack_adjust() to 'true'.
	* config/sh/sh.h (BASE_DRIVER_SELF_SPECS): Rename from
	DRIVER_SELF_SPECS.
	(DRIVER_SELF_SPECS): Define using BASE_DRIVER_SELF_SPECS.
	* config/sh/linux.h (DRIVER_SELF_SPECS): Enable -funwind-tables by
	default.
	* config/sh/t-linux (CRTSTUFF_T_CFLAGS): Add -fno-unwind-tables.
	(CRTSTUFF_T_CFLAGS_S): Define using CRTSTUFF_T_CFLAGS.

2012-03-19  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* dwarf2out.c (dwarf2out_cfi_begin_epilogue): Move detection of
	frame-insns inside SEQUENCE body earlier in loop. Skip labels when
	scanning to locate the NOTE_INSN_CFA_RESTORE_STATE insert point.
	* final.c (final_scan_insn): Move the frame debug generation of
	JUMP delay slot insns till after they are scanned.

2012-03-16  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #13105
	gcc/
	* sched-rgn.c (sched_rgn_init): Use last_basic_block, not
	n_basic_blocks.

2012-03-15  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #13028

	* release-notes-csl.xml (Fix for bit-field optimization bug): New
	note.

	Backport from mainline:

	gcc/
	2012-03-10  Chung-Lin Tang  <cltang@codesourcery.com>

	PR rtl-optimization/52528
	* combine.c (can_combine_p): Add setting of subst_low_luid
	before call to expand_field_assignment().

2012-03-13  Meador Inge  <meadori@codesourcery.com>

	CB-950: Merging upstream GCC 4.6.3.

	* release-notes-csl.xml (GCC version 4.6.3): New note.

2012-03-13  Meador Inge  <meadori@codesourcery.com>

	CB-957

	* release-notes-csl.xml (Internal compiler error): New note.

	Backport from mainline:

	gcc/
	2011-09-30  Ramana Radhakrishnan  <ramana.radhakrishnan@linaro.org>

        PR target/50099
	* config/arm/iterators.md (qhs_zextenddi_cstr): New.
	(qhs_zextenddi_op): New.
	* config/arm/arm.md ("zero_extend<mode>di2"): Use them.
	* config/arm/predicates.md ("arm_extendqisi_mem_op"):
	Distinguish between ARM and Thumb2 states.

	gcc/testsuite/
	2011-09-30  Ramana Radhakrishnan  <ramana.radhakrishnan@linaro.org>

	* gcc.target/arm/pr50099.c: New test.

2012-03-07  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* sched-int.h (schedule_block): Adjust declaration.
	* sched-rgn.c (bb_state_array, bb_state): New static variables.
	(sched_rgn_init): Initialize them.
	(sched_rgn_free): Free them.
	(schedule_region): Save scheduling state for future blocks, and
	pass such state to schedule_block.
	* params.def (PARAM_SCHED_STATE_EDGE_PROB_CUTOFF): New.
	* doc/invoke.texi (--param): Document it.
	* haifa-sched.c (schedule_block): New arg init_state.  Use it to
	initialize state if nonnull.  All callers changed.
	Call advance_one_cycle after scheduling.

2012-02-23  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from SCB GCC 4.5:
	gcc/testsuite/
	* g++.dg/torture/type-generic-1.C: Add options for mips-sde-elf to
	enable FPU-exception-handling library.

2012-02-23  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from SCB GCC 4.5:
	gcc/
	* config/mips/t-sgxx-sde: Add 64-bit multilibs.

2012-02-23  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from SCB GCC 4.5:
	gcc/
	* config/mips/t-fprules-softfp (LIB2_SIDITI_CONV_FUNCS): Define to
	make 64-bit ABIs use proper names __fixuns* routines.

2012-02-17  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* ira.c (create_sets_for_returned_args): Check modified_between_p
	in both cases.

2012-02-13  Janis Johnson  <janisjo@codesourcery.com>

	Backport from mainline:

	2011-11-07  Terry Guo  <terry.guo@arm.com>

	* gcc/testsuite/gcc.target/arm/wmul-1.c: Adjust optimization level.
	* gcc/testsuite/gcc.target/arm/wmul-2.c: Ditto.
	* gcc/testsuite/gcc.target/arm/wmul-3.c: Ditto.
	* gcc/testsuite/gcc.target/arm/wmul-4.c: Ditto.

	Backport from mainline:

	2011-08-09  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>

	* gcc/testsuite/gcc.dg/pr49948.c: Require pthread effective target.

2012-02-08  Tom de Vries  <tom@codesourcery.com>

	#Issue 12865
	* dwarf2out.c (asm_cfi_special_encoding): New function.
	(dwarf2out_do_cfi_asm, dwarf2out_do_cfi_startproc): Use
	asm_cfi_special_encoding instead of ASM_CFI_SPECIAL_ENCODING.

2012-02-07 Paul Brook <paul@codesourcery.com>

	gcc/
	* Makefile.in (LIB2ADDEH): Add unwind-compact.c
	(LIB2ADDEHDEP): Add unwind-compact.h.
	* config/mips/elf.h (MD_HAVE_COMPACT_EH, MD_UNWIND_SUPPORT): Define.
	(config/mips/linux-unwind.h): Include mips-unwind.h.
	* config/mips/linux.h (MD_HAVE_COMPACT_EH): Define.
	* config/mips/mips-protos.h (mips_fixup_cfi_sections): Add prototype.
	* config/mips/mips-unwind.h: New file.
	* config/mips/mips.c (done_cfi_sections): New variable.
	(mips_fixup_cfi_sections, mips_asm_init_sections): New functions.
	(mips_file_start): Clear done_cfi_sections.
	(mips_override_options): Disable compact EH if not supported.
	(TARGET_ASM_INIT_SECTIONS): Define.
	* config/mips/mips.h (MIPS_CPP_SET_PROCESSOR): Add __GNU_COMPACT_EH__.
	(ASM_DECLARE_FUNCTION_NAME): Use mips_fixup_cfi_sections.
	(ASM_PREFERRED_EH_DATA_FORMAT): Define.
	(ASM_CFI_SPECIAL_ENCODING): New hook.
	(ASM_MAYBE_OUTPUT_ENCODED_ADDR_RTX): Define.
	(MIPS_EH_ENCODING): Define.
	(CRT_GET_RFIB_DATA): Define.
	* config/mips/mips.opt: Add -mcompact-eh.
	* config/mips/sde.h (LINK_EH_SPEC, MIPS_EH_ENCODING): Define.
	(LINK_SPEC): Use LINK_EH_SPEC.
	* gcc/config/t-linux (LIB2ADDEH): Add unwind-compact.c
	(LIB2ADDEHDEP): Add unwind-compact.h.
	* configure.ac: Add HAVE_GAS_EH_FRAME_ENTRY check.
	* crtstuff.c (__register_frame_info_header_bases): Declare
	(__GNU_EH_FRAME_HDR): Declare.
	(frame_dummy): Register eh_frame_hdr tables.
	* doc/invoke.texi: Document MIPS -mno-compact-eh.
	* dwarf2out.c (dwarf2out_do_cfi_asm): Use ASM_CFI_SPECIAL_ENCODING.
	(dwarf2out_do_cfi_startproc): Ditto.
	* unwind-compact.c: New file.
	* unwind-compact.h: New file.
	* unwind-dw2-fde-glibc.c: Include unwind-compact.h.
	(_Unwind_Find_registered_Index): Add declaration.
	(unw_eh_callback_data): Use struct compact_eh_bases.  Add type.
	(base_from_cb_data): Use data->bases.
	(_Unwind_IteratePhdrCallback): Search compact frame headers.
	Use data->bases.  Set data->type.
	(_Unwind_Find_FDE): Rename...
	(_Unwind_Find_Index): To this.  Adjust for compact EH.
	* unwind-dw2-fde.c: Include unwind-compact.h.
	(__register_frame_info_1, __register_frame_info_header_bases): New
	functions.
	(__register_frame_info_bases): Use __register_frame_info_1.
	(search_object): Search compact unwdind table headers.
	Set bases->entry.  Return entry type.
	(_Unwind_Find_FDE): Implement as wrapper around _Unwind_Find_Index.
	(_Unwind_Find_registered_Index): New function.
	* unwind-dw2-fde.h (object): Add flag for compact frame headers.
	(__register_frame_info_header_bases): Add prototype.
	(compact_eh_bases, compact_entry_type): New.
	(_Unwind_Find_Index): Add prototype.
	* unwind-dw2.c (__gnu_compact_pr1, uw_frame_state_compact):
	New functions.
	(__gnu_compact_pr2, __gnu_compact_pr3): Use weak references.
	(uw_frame_state_for): Handle compact frame entries.
	* configure: Regenerate.
	* config.in: Regenerate.

2012-02-07  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12856

	gcc/
	* ira.c (find_moveable_pseudos): Avoid moving insns after a cc0
	setter.

	Issue #12854

	gcc/
	* haifa-sched.c (prune_ready_list): Ensure that if there is a
	sched-group insn, it either remains alone or the entire list is
	pruned.

2012-02-01  Catherine Moore  <clm@codesourcery.com>

	gcc/

	Merge from Sourceryg++ 4.5:

	2011-04-22  Zoran Jovanovic  <zoran.jovanovic@rt-rk.com>
	gcc/
	* config/mips/mips.opt (mframe-header-opt): New option.
	* config/mips/mips.c (struct mips_frame_info): Add
	skip_stack_frame_allocation_p field.
	(struct machine_function): Add fields callees_use_frame_header_p,
	uses_frame_header_p, initial_total_size.
	(struct frame_header_usage): New struct.
	(frame_header_usage_htab): New variable.
	(mips_rest_of_frame_header_opt, frame_header_usage_htab_hash)
	(frame_header_usage_htab_eq, mips_find_if_frame_header_is_used)
	(mips_callee_use_frame_header, mips_callees_use_frame_header_p)
	(mips_cfun_use_frame_header_p): New function.
	(mips_compute_frame_info): Add parameter recalculate.  Move frame to
	parameter.  Move cprestore_size init up.  Use recalculate.  Use
	mips_must_initialize_gp_p.
	(mips_frame_pointer_required, mips_initial_elimination_offset): Add
	args to call to mips_compute_frame_info.
	(mips_expand_prologue): Use mips_compute_frame_info.  Move frame init
	up.  Set initial_total_size.
	(mips_gp_expand_needed_p): Factor new function out of
	mips_expand_ghost_gp_insns.
	(mips_expand_ghost_gp_insns): Use mips_gp_expand_needed_p.
	(mips_reorg): Use mips_rest_of_frame_header_opt.
	(mips_override_options): Switch off flag_frame_header_optimization if
	flag_exceptions or flag_unwind_tables.
	(mips_get_updated_offset, mips_skip_stack_frame_alloc)
	(mips_frame_header_update_insn): New function.

2012-02-01  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* incpath.c (diagnostic-core.h): Include.

2012-02-01  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2011-12-28  Michael Meissner  <meissner@linux.vnet.ibm.com>

	PR target/51623

	gcc/
	* config/rs6000/rs6000.c (rs6000_assemble_integer): Don't call
	unlikely_text_section_p.  Instead check for being in a code
	section.

	gcc/testsuite/
	* gcc.target/powerpc/pr51623.c: New file.

2012-02-01  Chung-Lin Tang  <cltang@codesourcery.com>

	Revert:

	2012-12-20  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* varasm.c (default_section_type_flags): Set SECTION_CODE in
	flags when decl is NULL_TREE, and section name matches ".text*".

	gcc/testsuite/
	* gcc.target/powerpc/pr51623.c: New testcase.

2012-01-31  Catherine Moore  <clm@codesourcery.com>

	Backport from mainline:

	gcc/
	2011-12-22  Richard Sandiford  <rdsandiford@googlemail.com>
        * doc/tm.texi.in (TARGET_PREPARE_PCH_SAVE): New hook.
        * doc/tm.texi: Regenerate.
        * target.def (prepare_pch_save): New hook.
        * c-family/c-pch.c (c_common_write_pch): Call it.
        * config/mips/mips.c (was_mips16_pch_p): Delete.
        (mips_set_mips16_mode): Don't refer to was_mips16_pch_p.
        (mips_prepare_pch_save): New function.
        (TARGET_PREPARE_PCH_SAVE): Define.

2012-01-30  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12824

	Backport

	gcc/
	2011-10-21  Bernd Schmidt  <bernds@codesourcery.com>
	PR bootstrap/50825
	* sched-deps.c (add_dependence): If not doing predication, promote
	REG_DEP_CONTROL to REG_DEP_ANTI.

2012-01-27  Catherine Moore  <clm@codesourcery.com>

	gcc/testsuite/
	* gcc.target/mips/octeon-useun.c: Fix merge error.

2012-01-27  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/sync.md (mips_val_compare_and_swap<d>_acq): Use YE
	memory constraint.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/sync.md (sync_compare_and_swap<mode>,
 	mips_bool_compare_and_swap<d>_acq, compare_and_swap_12,
	sync_<optab>_12, sync_old_<optab>_12, sync_new_<optab>_12,
	sync_nand_12, sync_old_nand_12, sync_new_nand_12,
	sync_old_add_ll_sc<mode>, sync_old_sub_ll_sc<mode>,
	sync_new_add_ll_sc<mode>, sync_new_sub_ll_sc<mode>,
	sync_<optab><mode>, sync_old_<optab><mode>, sync_new_<optab><mode>,
	sync_insn1_op2, sync_nand<mode>, sync_old_nand<mode>,
	sync_new_nand<mode>, mips_swap<d>_ll_sc_acq,
	mips_swap<d>_ll_sc_rel, test_and_set_12): Use YE memory constraint.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/t-sgxx-sde (MULTILIB_OPTIONS, MULTILIB_DIRNAMES,
	(MULTILIB_EXTRA_OPTS): Update for new SOW.
	(MULTILIB_EXCLUSIONS, MULTILIB_EXCEPTIONS): Remove.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.md (jump_absolute):  Emit a branch for microMIPS.
	(jump_pic): Remove microMIPS-specific code.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourceryg++ 4.5:

	2011-12-19  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* config/mips/mips16.S: Move __mips16_rdhwr inside
	ABI conditional.

	2011-12-21  Catherine Moore  <clm@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc: Use same configuration for
	$enable_extra_sgxx_multilibs and
	$enable_extra_sgxxlite_multilibs.  Use mips/t-linux64 and
	mips/linux64.h.
	* config/mips/cs-sgxxlite-linux.h, config/mips/t-sgxxlite-linux:
	Remove.
	* config/mips/cs-sgxx-linux.h (DRIVER_SELF_SPECS): Define.
	(MULTILIB_DEFAULTS): Add mabi=32.
	(SYSROOT_SUFFIX_SPEC): Remove handling of MIPS architecture
	variants.
	(STARTFILE_PREFIX_SPEC): Define.
	* config/mips/t-sgxx-linux (MULTILIB_OPTIONS, MULTILIB_DIRNAMES)
	(MULTILIB_MATCHES, MULTILIB_EXCEPTIONS, MULTILIB_OSDIRNAMES): Add
	n64 multilibs.  Remove multilibs for MIPS architecture variants.
	(EXTRA_MULTILIB_PARTS): Remove.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourceryg++ 4.5:

	2011-11-04  Maciej W. Rozycki  <macro@codesourcery.com>
	Issue #11931
	gcc/
	* config/mips/mips16.S (RET_FUNCTION): Set hidden ELF symbol
	visibility.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-10-25  Chung-Lin Tang  <cltang@codesourcery.com>
	gcc/
	* config/mips/mips.md (PIC_JUMP_REGNUM): New constant.
	(tls_get_tp_<mode>_mips16,*tls_get_tp_<mode>_mips16_rdhwr): Add
	clobbers of register PIC_JUMP_REGNUM, add explaining comment.
	* config/mips/mips16.S (__mips16_rdhwr): Correct inaccuracy in
	comments about symbol being hidden.

2012-01-26  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-01-30  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/mips.h (MIPS_CALL): Allow microMIPS JALS in direct
	calls if TARGET_JALS.  Always allow microMIPS JALRS in indirect
	calls.  Always use microMIPS JAL in non-explicit-relocs calls.

	2010-01-30  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_CC1_SPEC): Remove -mno-jals.
	(SUBTARGET_OVERRIDE_OPTIONS): Remove code to enable
	-minterlink-mips16.
	* config/mips/mips.c (TARGET_INTERLINK_MIPS16): Remove explicit
	checks against 1.
	* config/mips/mips.opt (minterlink-mips16): Initialize to 0.


2012-01-26  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* genautomata.c (parse_automata_opt): New static function.
	(initiate_automaton_gen): Remove all option handling code.
	(main): Call init_rtx_reader_args_cb with the new function as
	argument.

2012-01-25  Meador Inge  <meadori@codesourcery.com>

	CB-803: Merging upstream GCC 4.6.2.

	* release-notes-csl.xml (GCC version 4.6.2): New note.

2012-01-25  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-10-21  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config.gcc (mips64*-*-linux*,mipsisa64*-*-linux*,mips*-*-linux*):
	Use config/t-slibgcc-libgcc.
	* config/mips/mips.h (CRT_CALL_STATIC_FUNCTION): Define versions
	for MIPS16 O32.
	* config/mips/mips-protos.h (mips_symbol_type): Add
	SYMBOL_DTPREL_HI,SYMBOL_TPREL_HI. Update in comments.
	(mips_output_tls_reloc_directive): New prototype.
	* config/mips/mips16.S (__mips16_rdhwr): New.
	* config/mips/t-libgcc-mips16 (LIB1ASMFUNCS): Add _m16rdhwr.
	* config/mips/mips-ftypes.def: Add (0, (POINTER)) entry.
	* config/mips/predicates.md (tls_reloc_operand): New predicate.
	* config/mips/crtfastmath.c (set_fast_math): Add 'nomips16'
	attribute.
	* config/mips/cs-sgxx-linux.h (SYSROOT_SUFFIX_SPEC): Add MIPS16
	multlibs.
	* config/mips/cs-sgxxlite-linux.h (SYSROOT_SUFFIX_SPEC): Same.
	* config/mips/t-sgxx-linux
	(MULTILIB_OPTIONS,MULTILIB_DIRNAMES,MULTILIB_EXCEPTIONS): Same.
	* config/mips/t-sgxxlite-linux
	(MULTILIB_OPTIONS,MULTILIB_DIRNAMES,MULTILIB_EXCEPTIONS): Same.
	* config/mips/mips.md (V0_REGNUM): New constant.
	(MIPS16 %dtprel_hi,%tprel_hi split pattern): New.
	(consttable_tls_reloc): New.
	(tls_get_tp_<mode>_mips16): New insn and split pattern.
	(*tls_get_tp_<mode>_mips16_rdhwr): New insn pattern.
	* config/mips/mips.c (MIPS_FTYPE_NAME0): New.
	(mips_builtin_type): Add MIPS_BUILTIN_THREAD_POINTER.
	(mips_symbolic_constant_p): Add SYMBOL_DTPREL_HI,SYMBOL_TPREL_HI
	switch cases.
	(mips_symbol_insns_1): Same.
	(mips_cannot_force_const_mem): Return false for SYMBOL_DTPREL/TPREL
	unspecs under TARGET_MIPS16_PCREL_LOADS.
	(mips_get_tp): Add 'target' parameter, add case for TARGET_MIPS16.
	(mips_legitimize_tls_address): Remove MIPS16 TLS sorry(). Add
	required MIPS16 changes to TLS_MODEL_LOCAL_DYNAMIC and
	TLS_MODEL_LOCAL_EXEC cases.
	(mips_init_relocs): Avoid SYMBOL_DTPREL/TPREL initializations
	under TARGET_MIPS16_PCREL_LOADS. Add proper init for
	SYMBOL_DTPREL_HI/TPREL_HI.
	(mips_builtin_description): Update comments for 'avail' field.
	(THREAD_POINTER_BUILTIN): New.
	(mips_builtins): Add __builtin_mips_thread_pointer and
	__builtin_thread_pointer using THREAD_POINTER_BUILTIN().
	(MIPS_FTYPE_ATYPES0): New.
	(mips_init_builtins): Add init code for MIPS_BUILTIN_THREAD_POINTER.
	(mips_expand_builtin): Do not assume mips_builtins[]->avail is
	always non-NULL. Add MIPS_BUILTIN_THREAD_POINTER case.
	(mips16_rewrite_pool_refs): Call force_const_mem() when operand
	is tls_reloc_operand. Filter out UNSPEC_TLS_GET_TP.
	(mips_output_tls_reloc_directive): New.

	libgomp/
	* config/linux/mips/futex.h (sys_futex0): Change to static
	function with noinline, nomips16 attributes under MIPS16.

2012-01-25  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>
	libgomp/
	* config/linux/mips/futex.h (sys_futex0): Adjust asm statement
	to place 'li v0,SYS_futex' immediately before syscall insn.

2012-01-25  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-05  Nathan Sidwell  <nathan@codesourcery.com>
	Issue #10782
	gcc/testsuite/
	* gcc.target/mips/loongson-simd.c: Disable micromips too.
	* gcc.target/mips/mips.exp: Add -m[no-]micromips support.

2012-01-25  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-07-20  Catherine Moore  <clm@codesoucery.com>
	Merge from Sourcery G++ 4.4:
	2010-01-08  Chao-ying Fu  <fu@mips.com>
	Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips-protos.h (micromips_load_store_pair_p): Add
	argument.
	* config/mips/mips.c (micromips_load_store_pair_p): New
	argument swap_p.  Check for base + offset.  Check for
	anti-dependence.
	* config/mips/micromips.md: Adjust callers of
	micromips_load_store_p to pass additional argument.
	
	2010-02-02  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_OVERRIDE_OPTIONS): Set
	TARGET_INTERLINK_MIPS16.

	2010-02-20  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* config/mips/linux-unwind.h (mips_fallback_frame_state): Return
	early if pc not 4-byte aligned.

	2010-02-24  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_CC1_SPEC): Pass -mno-jals
	in the absence of -mjals.
	* config/mips/mips.opt (mjals): Fix typo.

	2010-03-23  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.c (mips_cpu_info_table): Add m14kc.


	2009-12-22  Catherine Moore  <clm@codesourcery.com>
	Merge from micromips branch:
	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/mips.opt (mjals): Fix a typo.

	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-10-01  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.opt (TARGET_JALS): Set to 1 by default.
	* config/mips/mips.md (indirect_jump<mode>): Use JR for
	microMIPS.
	(tablejump<mode>): Likewise.
	* config/mips/micromips.md (peephole2): New patterns for the
	MOVEP instruction.
	(*movepsisi, *movepsisf, *movepsfsi, *movepsfsf): Likewise.
	* config/mips/mips-protos.h (micromips_movep_target_p): New
	prototype.
	* config/mips/mips.c (micromips_movep_target_p): New function.

	* passes.c (init_optimization_passes): Run pass_peephole2 after
	pass_sched2 too.

	gcc/testsuite/
	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	* gcc.target/mips/near-far-1.c: Adjust scan-assembler to handle
	the JALS instruction.
	* gcc.target/mips/near-far-2.c: Likewise.

	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/t-sgxx-sde (MULTILIB_EXTRA_OPTS): New variable,
	set to "mno-jals".

	2009-07-30  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-30  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.h (MIPS_ISA_LEVEL_SPEC): Add march=m14k* to
	-mips32r2 targets.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.opt (mmucon): Rename to...
	(mmcu): ... this.  Replace MUCON with MCU.
	* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Update
	accordingly.
	(ASM_SPEC): Likewise.
	* doc/invoke.texi (MIPS Options): Likewise.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.h (MIPS_ARCH_FLOAT_SPEC): Add march=m14k* to
	-msoft-float targets.
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Likewise.
	
	2009-07-10  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.c (micromips_build_save_restore): Mark the
	built PARALLEL as RTX_FRAME_RELATED_P.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.md (clear_hazard): Remove TARGET_MICROMIPS code.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.md (clear_hazard): Don't use <d>.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips-protos.h (micromips_load_store_pair_p): Adjust
	prototype.
	* config/mips/mips.c (micromips_load_store_pair_p): Add check for
	invalid load instruction.
	* config/mips/micromips.md (*lwp, *swp): Adjust calls to
	micromips_load_store_pair_p.

	2009-06-09  Nathan Sidwell  <nathan@codesourcery.com>
	Port 2009-05-28 Chao-ying Fu <fu@mips.com>
	gcc/
	* config/mips/mips.c (mips_address_insns): Add a new parameter
	check_micromips_12bit_p.
	(mips_load_store_insns): Pass false to mips_address_insns for the new
	parameter.
	(mips_rtx_costs): Pass false to mips_address_insns for the new
	parameter.
	(mips_address_costs): Pass false to mips_address_insns for the new
	parameter.
	* config/mips/constraints.md (YC): New memory constraint.
	(YD): New address constraint.
	* config/mips/mips-protos.h (mips_address_insns): Add a new parameter.
	* doc/md.texi (Constraints for Particular Machines): Document YC.
	* config/mips/mips.md (mov_<load>l, mov_<load>r, mov_<store>l,
	mov_<store>r): Use YC, instead of m.
	(prefetch): Use YD, instead of p.
	(sync_compare_and_swap<mode>, sync_add<mode>, sync_sub<mode>,
	sync_old_add<mode>, sync_old_sub<mode>, sync_new_add<mode>,
	sync_new_sub<mode>, sync_<optab><mode>, sync_old_<optab><mode>,
	sync_new_<optab><mode>, sync_nand<mode>, sync_old_nand<mode>,
	sync_new_nand<mode>, sync_lock_test_and_set<mode>): Use YC,
	instead of R for memory constraints.

	gcc/
	* config/mips/t-sgxx-sde (MULTILIB_OPTIONS): Add mmicromips.
	(MULTILIB_DIRNAMES): Add micromips.
	(MULTILIB_EXCLUSIONS): Exclude -mcode-readable=no when !mips16.
	(MULTILIB_EXCEPTIONS): Remove no-float and fp-64 micromips libraries.

	Port 2009-05-13  Chao-ying Fu  <fu@mips.com>
	gcc/
	* doc/extend.texi (Declare Attributes of Functions): Add "micromips"
	and "nomicromips".
	* doc/invoke.texi (MIPS Options): Add "-mmicromips"/"-mno-mmicromips",
	"-mmucon"/"-mno-mucon", and "-mjals"/"-mno-jals".
	Add "m14k" for processor names.
	Update descriptions for "-minterlink-mips16" for microMIPS.
	Document "-mmicromips"/"-mno-mmicromips".
	Document "-mmucon"/"-mno-mucon".
	Document "-mjals"/"-mno-jals".
	* config/mips/micromips.md (*store_word_multiple, *load_word_multiple):
	New instructions for save to/load from the stack.
	New peephole2 to match load/store word pair.
	(*lwp, *swp): New instructions for load/store word pair.
	(mips_jraddiusp): New instruction.
	* config/mips/crtn.asm: Add labels of "init" and "fini", as
	objdump needs labels before microMIPS/MIPS16 instructions to dump
	instructions correctly.
	* config/mips/mips.md (micromips_type): New attribute for 16-bit
	microMIPS instructions.
	(*add<mode>3): Set micromips_type to add.
	(sub<mode>3): Set micromips_type to sub.
	(one_cmpl<mode>2): Set micromips_type to logical_not.
	(*and<mode>3): Set micromips_type to logical_and.
	(*ior<mode>3): Set micromips_type to logical_or.
	Set micromips_type to logical_xor for unamed xor instructions.
	(*zero_extend<SHORT:mode><GPR:mode>2): Set micromips_type to
	zero_extend.
	(mfhi<GPR:mode>_<HILO:mode>): Set micromips_type to mfhi.
	(clear_hazard_<mode>): Use jrs.hb for microMIPS.
	(*<optab><mode>3): Disable microMIPS for this instruction.
	(*micromips_ashl<mode>3): New instruction for microMIPS.
	(*micromips_ashr<mode>3): New instruction for microMIPS.
	(*micromips_lshr<mode>3): New instruction for microMIPS.
	(*branch_equality<mode>): Check if it is not
	microMIPS.
	(*branch_equality<mode>_micromips): New instruction for microMIPS.
	(*branch_equality<mode>_inverted): Check if it is not microMIPS.
	(*branch_equality<mode>_inverted_micromips): New isntruction for
	microMIPS.
	(jump): Use "b" for microMIPS to save code size.
	(*return): Use "jr" for microMIPS to save code size.
	(return_internal): Use "jr" for microMIPS to save code size.
	(sibcall_internal): Use MICROMIPS_J to enable jrs.
	(sibcall_value_internal): Use MICROMIPS_J to enable jrs.
	(sibcall_value_multiple_internal): Use MICROMIPS_J to enable jrs.
	(micromips.md): New include.
	* config/mips/mips.opt (mjals, mmicromips, mmucon): New options.
	* config/mips/mips16.S: Skip code when __mips_micromips is defined.
	* config/mips/mips-protos.h (micromips_output_save_restore,
	micromips_save_restore_pattern_p, micromips_load_store_pair_p,
	micromips_output_load_store_pair): New prototypes.
	* config/mips/mips.c (MIPS_MAX_FIRST_STACK_STEP): Use 0x7f0 for
	microMIPS.
	(mips_base_micromips): New variable.
	(mips_attribute_table): Add "micromips" and "nomicromips".
	(mips_cpu_info_table): Add "m14k".
	(mips_micromips_decl_p, mips_nomicromips_decl_p): New functions.
	(mips_use_micromips_mode_p): New function.
	(mips_insert_attributes):  Add micromips_p and nomicromips_p.
	Cannot use both mips16 and microMIPS.
	(mips_start_function_definition): Set micromips/nomicromips.
	(mips_function_ok_for_sibcall): Check if sibcall is ok for microMIPS.
	For MIPS32, check if the called function is a microMIPS function.
	(mips_print_operand_punctuation): Add ':' to support compact branches.
	Add '!' to support branches with 16-bit delay slots.
	(mips_init_print_operand_punct): Add ':' to generate compact branches.
	Add '!' to generate branch with 16-bit delay slots by recognizing
	16-bit instructions in delay slots.
	(mips_init_print_operand_punct): Add : and !.
	(mips_save_reg): Add prototype, because it will be used later.
	(micromips_build_save_restore): New function.
	(mips_for_each_saved_reg): Add support for microMIPS lwm/swm.
	(mips_expand_epilogue): Add jraddiusp support.
	(was_micromips_p, was_micromips_pch_p): New variables.
	(mips_set_mips16_micromips_mode): Change it from mips_set_mips16_mode.
	Support the microMIPS mode for functions.
	For microMIPS, we disable branch likely instructions.
	(mips_set_current_function): Rename mips_set_mips16_mode to
	mips_set_mips16_micromips_mode.
	(mips_override_options): Check mips16 and microMIPS.
	Rename mips_set_mips16_mode to mips_set_mips16_micromips_mode.
	(micromips_save_restore_pattern_p, micromips_output_save_restore,
	micromips_load_store_pair_p, micromips_output_load_store_pair):
	New functions.
	* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Add __mips_micromips
	and __mips_mucon.
	(ISA_HAS_LWXS): Enable for microMIPS.
	(ASM_SPEC): Pass -mmicromips/-mno-micromips and -mmucon/-mno-mucon.
	(M16STORE_REG_P): New define for microMIPS store source register.
	(MIPS_CALL): For microMIPS, we try to enable jals and jalrs.
	(MICROMIPS_J): New define for microMIPS to enable jrs.
	* config/mips/t-sde (MULTILIB_OPTIONS): Add mmicromips.
	(MULTILIB_DIRNAMES): Add micromips
	Exclude -mcode-readable=no when !mips16.
	2010-07-26  Catherine Moore  <clm@codesourcery.com>
	Issue #9082
	gcc/
	* config/mips/mips.c (mips_override_options):  Clear the
	micromips and mips16 bits from target_flags after checking
	them.
	* release-notes-csl.xml: Document.

	2010-10-14  Catherine Moore  <clm@codesourcery.com>
	Issue #9808
	gcc/
	* doc/invoke.texi (MIPS options): Document -m14kc.

	2010-10-14  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/micromips.md (*lwp, *swp): Fix 'control reaches end of
	non-void function' warnings.

	2011-04-11  Catherine Moore  <clm@codesourcery.com>
		    Chao-Ying Fu <fu@mips.com>
	Issue #10954
	gcc/
	* config/mips/mips.md (*jump_absolute): Use branch for microMIPS.
	(*jump_pic): Likewise.
	* release-note-csl.xml: New note.

	2010-11-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* config/mips/micromips.md (define_peephole2 for lwp)
	(define_insn "*lwp", define_peephole2 for swp, define_insn "*swp")
	(define_peephole2 for movep, define_insn "*movepsisi")
	(define_insn "*movepsisf", define_insn "*movepsfsi"): Guard usage of
	REGNO with REG_P.

2012-01-25  Bernd Schmidt  <bernds@codesourcery.com>

	Backport some patches from mainline.

	gcc/
	2011-05-26  Bernd Schmidt  <bernds@codesourcery.com>

	* haifa-sched.c (schedule-block): Reorder the inner scheduling loop
	to reduce duplication, and to achieve a slightly more logical order
	of operations.

	gcc/
	2011-07-13  Bernd Schmidt  <bernds@codesourcery.com>

	* sched-int.h (struct _dep): Add member cost.
	(DEP_COST, UNKNOWN_DEP_COST): New macros.
	* sched-deps.c (init_dep_1): Initialize DEP_COST.
	* haifa-sched.c (dep_cost_1): Use and set DEP_COST.
	(sched_change_pattern): Reset it for dependent insns.

	gcc/
	2011-07-13  Bernd Schmidt  <bernds@codesourcery.com>

	* haifa-sched.c (struct sched_block_state): New.
	(schedule_block): Move some local variables into such a structure.

	gcc/
   	2011-07-14  Bernd Schmidt  <bernds@codesourcery.com>

	* haifa-sched.c: Include "hashtab.h"
	(sched_no_dce): New global variable.
	(INSN_EXACT_TICK, INSN_TICK_ESTIMATE, FEEDS_BACKTRACK_INSN,
	SHADOW_P): New macros.
	(last_clock_var, cycle_issued_insns): Move declarations.
	(must_backtrack): New static variable.
	(struct delay_pair): New structure.
	(delay_htab, delay_htab_i2): New static variables.
	(delay_hash_i1, delay_hash_i2, delay_i1_eq, delay_i2_eq,
	record_delay_slot_pair, pair_delay, add_delay_dependencies): New
	functions.
	(dep_cost_1): If delay pairs exist, try to look up the insns and
	use the correct pair delay if we find them.
	(rank-for_schedule): Tweak priority for insns that must be scheduled
	soon to avoid backtracking.
	(queue_insn): Detect conditions which force backtracking.
	(ready_add): Likewise.
	(struct sched_block_state): Add member shadows_only_p.
	(struct haifa_save_data): New structure.
	(backtrack_queue): New static variable.
	(mark_backtrack_feeds, copy_insn_list, save_backtrack_point,
	unschedule_insns_until, restore_last_backtrack_point,
	free_topmost_backtrack_point, free_backtrack_queue,
	estimate_insn_tick, estimate_shadow_tick): New functions.
	(prune_ready_list): New arg shadows_only_p.  All callers changed.
	If true, remove everything that isn't SHADOW_P.  Look up delay
	pairs and estimate ticks to avoid scheduling the first insn too
	early.
	(verify_shadows): New function.
	(schedule_block): Add machinery to enable backtracking.
	(sched_init): Take sched_no_dce into account when setting
	DF_LR_RUN_DCE.
	(free_delay_pairs): New function.
	(init_h_i_d): Initialize INSN_EXACT_TICK.
	* Makefile.in (haifa-sched.o): Add $(HASHTAB_H).
	* sched-deps.c (sd_unresolve_dep): New function.
	* sched-int. (struct haifa_sched_info): New fields save_state
	and restore_state.
	(struct _haifa_insn_data): New fields exact_tick, tick_estimate,
	feeds_backtrack_insn and shadow_p.
	(DO_BACKTRACKING): New value in enum SCHED_FLAGS.
	(sched_no_dce): Declare variable.
	(record_delay_slot_pair, free_delay_pairs, add_delay_dependencies,
	sd_unresolve_dep): Declare functions.
	* modulo-sched.c (sms_sched_info): Clear the two new fields.
	* sched-rgn.c (rgn_const_sched_info): Likewise.
	* sel-sched-ir.c (sched_sel_haifa_sched_info): Likewise.
	* sched-ebb.c (save_ebb_state, restore_ebb_state): New functions.
	(ebb_sched_info): Add them for the two new fields.
	(add_deps_for_risky_insns): Call add_delay_dependencies.

	gcc/
	2011-07-14  Bernd Schmidt  <bernds@codesourcery.com>

	* haifa-sched.c (schedule_insns): Remove outdated comment.
	(schedule_block): When computing a known value for TODO_SPEC,
	just set it rather than using logical operations.
	(try_ready): Likewise.  Use a local variable rather than a
	pointer to TODO_SPEC.  Reorder an if statement to move the
	easy case to the then block.
	* sched-deps.c (dep_spec_p): New static function.
	(update_dep): Use it to decide whether to call
	change_spec_dep_to_hard.
	(get_back_and_forw_lists): Use it.
	(sd_resolve_dep): Likewise.
	(init_dep): If !USE_DEPS_LIST, use zero to initialize status.
	(haifa_note_mem_dep): Likewise.
	(check_dep): Likewise.
	(sd_add_dep): Also clear SPECULATIVE bits if not DO_SPECULATION.
	(sched_free_deps): Free in two passes.

	gcc/
	2011-09-30  Bernd Schmidt  <bernds@codesourcery.com>

	* haifa-sched.c (modulo_ii, modulo_max_states, modulo_n_insns,
	modulo_insns_scheduled, modulo_iter0_max_uid, modulo_backtracks_left,
	modulo_last_stage): New static variables.
	(set_modulo_params, discard_delay_pairs_above): New functions.
	(struct delay_pair): New member stages.
	(htab_i2_traverse, htab_i1_traverse): New static functions.
	(record_delay_slot_pair): New arg stages.  All callers changed.
	Record it.
	(pair_delay): Take stages into account.
	(add_delay_dependencies): Don't do so for stage pairs.
	(struct sched_block_state): New member modulo_epilogue.
	(save_backtrack_point): Don't set SHADOW_P for stage pairs.
	(unschedule_insns_until): Decrease modulo_insns_scheduled.
	Set HARD_DEP without using or.
	(resolve_dependencies): New static function.
	(prune_ready_list): New arg modulo_epilogue_p.  All callers changed.
	If it is true, allow only insns with INSN_EXACT_TICK set.
	(schedule_block): Return bool, always true for normal scheduling,
	true or false depending on modulo scheduling success otherwise.
	Add bookkeeping for modulo scheduling, and call resolve_dependencies
	on everything left over after a modulo schedule.
	(haifa_sched_init): Remove check_cfg call.  Clear modulo_ii.
	* sched-int.h (schedule_block, record_delay_slot_pair): Adjust
	declarations.
	(set_modulo_params, discard_delay_pairs_above): Declare.
	* params.def (PARAM_MAX_MODULO_BACKTRACK_ATTEMPS): New.
	* doc/invoke.texi (--param): Document it.

	gcc/
	2011-05-27  Bernd Schmidt  <bernds@codesourcery.com>

	* sched-int.h (struct _haifa_deps_insn_data): New members cond
	and reverse_cond.
	(INSN_COND, INSN_REVERSE_COND): New macros.
	* sched-deps.c (deps_analyze_insn): Call sched_get_condition_with_rev
	once.
	(sched_get_condition_with_rev): Cache the results, and look them up
	if possible.
	(sched_analyze_insn): Destroy INSN_COND of previous insns if they
	are clobbered by the current insn.
	* target.def (exposed_pipline): New sched data hook.
	* doc/tm.texi.in: TARGET_SCHED_EXPOSED_PIPELINE: Add hook.
	* doc/tm.texi: Regenerate.

	gcc/
	Revert
	2003-07-10  Eric Botcazou  <ebotcazou@libertysurf.fr>
	PR rtl-optimization/11320
	* sched-int.h (struct deps) [reg_conditional_sets]: New field.
	(struct sched_info) [compute_jump_reg_dependencies]: New prototype.
	* sched-deps.c (sched_analyze_insn) [JUMP_INSN]: Update call to
	current_sched_info->compute_jump_reg_dependencies. Record which
	registers are used and which registers are set by the jump.
	Clear deps->reg_conditional_sets after a barrier.
	Set deps->reg_conditional_sets if the insn is a COND_EXEC.
	Clear deps->reg_conditional_sets if the insn is not a COND_EXEC.
	(init_deps): Initialize reg_conditional_sets.
	(free_deps): Clear reg_conditional_sets.
	* sched-ebb.c (compute_jump_reg_dependencies): New prototype.
	Mark registers live on entry of the fallthrough block and conditionally
	set as set by the jump. Mark registers live on entry of non-fallthrough
	blocks as used by the jump.
	* sched-rgn.c (compute_jump_reg_dependencies): New prototype.
	Mark new parameters as unused.

	gcc/
	2011-08-11  Sergey Grechanik  <mouseentity@ispras.ru>
		    Alexander Monakov  <amonakov@ispras.ru>

	* sched-deps.c (sched_get_condition_with_rev): Rename to ...
	(sched_get_condition_with_rev_uncached): ... this.  Factor out
	condition caching logic into ...
	(sched_get_condition_with_rev): ... this.  Reimplement.  Do not
	attempt to use cache for instructions with zero luid.
	(sched_analyze_insn): Use INSN_CACHED_COND instead of INSN_COND.
	* sched-int.h (INSN_COND): Rename to INSN_CACHED_COND.

	gcc/
	2011-08-12  Richard Henderson  <rth@redhat.com>

	PR rtl-opt/49994
	* sched-init.h (struct deps_desc): Add sched_before_next_jump.
	* sched-deps.c (init_deps): Clear it.
	(deps_analyze_insn): Consume it.
	(sched_analyze_insn): Fill it.

	gcc/testsuite/
	* gcc.dg/pr49994-1.c: New test.
	* gcc.dg/pr49994-2.c: New test.
	* gcc.dg/pr49994-3.c: New test.

	gcc/
	2011-10-21  Bernd Schmidt  <bernds@codesourcery.com>

	* reg-notes.def (DEP_CONTROL): New.
	* sched-ebb.c (add_deps_for_risky_insns): Add a REG_DEP_CONTROL when
	not doing speculation.
	* rtlanal.c (record_hard_reg_sets, find_all_hard_reg_sets,
	record_hard_reg_uses_1, record_hard_reg_uses): New functions.
	* function.c (record_hard_reg_sets, record_hard_reg_uses,
	record_hard_reg_uses_1): Remove; move to rtlanal.c.
	* lists.c (copy_INSN_LIST, concat_INSN_LIST): New functions.
	* haifa-sched.c: Swap includes of "rtl.h" and "hard-reg-set.h".
	(MUST_RECOMPUTE_SPEC_P): New macro.
	(real_insn_for_shadow): New function.
	(cond_clobbered_p, recompute_todo_spec, check_clobbered_conditions,
	toggle_cancelled_flags): New static functions.
	(schedule_insn): Relax an assert to only check for empty hard back
	dependencies.  Skip cancelled dependencies.  Call
	check_clobbered_conditions.
	(copy_insn_list): Remove function, renamed moved to lists.c.
	(save_backtrack_point): Use new spelling copy_INSN_LIST.
	(unschedule_insns_until): Ensure TODO_SPEC is reset properly.
	(restore_last_backtrack_point): Likewise.  Call toggle_cancelled_flags.
	(estimate_insn_tick): Ignore cancelled dependencies.
	(haifa_speculate_insn): Move declaration.
	(try_ready): Move code into recompute_todo_spec and call it.  Tweak
	some asserts.  Ensure predicated patterns are restored if necessary.
	Dump DEP_CONTROL flag.
	(haifa_change_pattern): Merge with sched_change_pattern.
	(sched_change_pattern): Remove function.
	* sched-deps.c (NON_FLUSH_JUMP_KIND, NON_FLUSH_JUMP): Remove.  All
	uses changed to simply not test NON_FLUSH_JUMP_P.
	(ds_to_dk, dk_to_ds, dump_dep, ds_to_dt, dump_ds, check_dep): Handle
	REG_DEP_CONTROL.
	(dep_spec_p): If DO_PREDICATION, REG_DEP_CONTROL is speculative.
	(reg_pending_control_uses, control_dependency_cache): New static
	variables.
	(sched_get_reverse_condition_uncached): New function.
	(sd_find_dep_between): Remove pointless assert.  Look in
	control_dependency_cache.
	(ask_dependency_caches, set_dependency_caches, sd_delete_dep,
	extend_dependency_caches, sched_deps_finish): Handle REG_DEP_CONTROL
	and control_dependency_cache.
	(sd_unresolve_dep): Use dep_spec_p.
	(add_dependence): Now a wrapper around add_dependence_1, handling
	REG_DEP_CONTROL specially.
	(flush_pending_lists): Clear pending_jump_insns.
	(sched_analyze_1): Handle pending_jump_insns like a memory flush.
	(sched_analyze_2): Unconditionally add to pending memory flushes,
	keep previous behaviour but apply it to pending_jump_insns instead.
	(sched_analyze_insn): Defer adding jump reg dependencies using
	reg_pending_control_uses; add them to the control_uses list.  Handle
	pending_jump_insns and control_uses when adding dependence lists.
	(deps_analyze_insn): Update INSN_COND_DEPS.
	(deps_analyze_insn): Add jumps to pending_jump_insns rather than
	last_pending_memory_flush.
	(init_deps): Initialize pending_jump_insns.
	(free_deps): Free control_uses.
	(remove_from_deps): Remove from pending_jump_insns.
	(init_deps_global): Allocate reg_pending_control_uses).
	(finish_deps_global): Free it.
	(add_dependence_1): Renamed from add_dependence.  Handle
	REG_DEP_CONTROL.
	* rtl.h (record_hard_reg_uses, find_all_hard_reg_sets): Declare.
	(copy_INSN_LIST, concat_INSN_LIST): Declare.
	* sched-int.h (struct deps_reg): Add control_uses.
	(struct deps_desc): Add pending_jump_insns.
	(struct _haifa_deps_insn_data): Add cond_deps.
	(struct _haifa_insn_data): Add must_recompute_spec and predicated_pat.
	(INSN_COND_DEPS, PREDICATED_PAT): New macros.
	(BITS_PER_DEP_WEAK): Adjust for two extra bits in the word.
	(DEP_CONTROL): New macro.
	(DEP_TYPES): Include it.
	(HARD_DEP): Adjust definition.
	(DEP_CANCELLED): New macro.
	(enum SCHED_FLAGS): Add DO_PREDICATION.
	(sched_get_reverse_condition_uncached, real_insn_for_shadow): Declare.
	* sched-rgn.c (concat_INSN_LIST): Remove function.
	(deps_join): Handle pending_jump_insns.
	(free_pending_lists): Likewise.

2012-01-24  Catherine Moore  <clm@codesourcery.com>

	2010-07-21  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.4:	
	2009-06-15  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	2006-12-15  Richard Sandiford  <richard@codesourcery.com>
	Adapted from a patch by Cavium Networks.
	gcc/
	* config/mips/mips.opt (mocteon-useun): New option.
	* config/mips/mips.h: (ISA_HAS_UL_US): New macro.
	(ASM_SPEC): Pass down -mocteon-useun and -mno-octeon-useun.
	* config/mips/mips.c (mips_expand_ext_as_unaligned_load): Use
	mov_ulw and mov_uld if ISA_HAS_UL_US.
	(mips_expand_ins_as_unaligned_store): Likewise mov_usw and mov_usd.
	* config/mips/mips.md: (UNSPEC_UNALIGNED_LOAD,
	 UNSPEC_UNALIGNED_STORE): New constants.
	(mov_<load>l, mov_<load>r, mov_<store>l, mov_<store>r): Require
	ISA_HAS_UL_US.
	(mov_u<load>, mov_u<store>): New patterns.

	2009-06-16  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	2006-12-15  Richard Sandiford  <richard@codesourcery.com>
	gcc/testsuite/
	* gcc.target/mips/octeon-useun.c: New test.

	2009-07-02  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.h (ISA_HAS_UL_US): Delete extraneous
	definition.  Fix typo.
	* config/mips/mips.c (mips_expand_ext_as_unaligned_load):
	Generate mov_uld or mov_ulw if ISA_HAS_UL_US.
	* config/mips/mips.md (UNSPEC_UNALIGNED_LOAD): Equate to 60.
	(UNSPEC_UNALIGNED_STORE): Equate to 61.

	2009-07-01  Catherine Moore  <clm@codesourcery.com>
 	gcc/testsuite/
	* gcc.target/mips/mips.exp (mips_option_groups): Add
	-mocteon-useun.
	* gcc.target/mips/octeon-useun.c: Change dg-mips-options to
	dg-options.

2012-01-24  Bernd Schmidt  <bernds@codesourcery.com>

	Backport some patches from mainline.

	gcc/
	* haifa-sched.c (queue_insn): New arg REASON.  All callers
	changed.  Print it in debugging output.

	gcc/
	* sched-ebb.c (begin_schedule_ready): Remove second argument.
	Split most of the code into...
	(begin_move_insn): ... here.  New function.
	(ebb_sched_info): Add a pointer to it.
	* haifa-sched.c (scheduled_insns): New static variable.
	(sched_extend_ready_list): Allocate it.
	(schedule_block): Use it to record the order of scheduled insns.
	Perform RTL changes to move insns only after all scheduling
	decisions have been made.
	* modulo-sched.c (sms_sched_haifa_sched_info): Add NULL entry for the
	begin_move_insn field.
	* sel-sched-ir.c (sched_sel_haifa_sched_info): Likewise.
	* sched-int.h (struct haifa_sched_info): Remove second argument
	from begin_schedule_ready hook.  Add new member begin_move_insn.
	* sched-rgn.c (begin_schedule_ready): Remove second argument.
	(rgn_const_sched_info): Add NULL entry for the begin_move_insn field.

	PR bootstrap/48403
	* haifa-sched.c (nonscheduled_insns_begin): New static variable.
	(rank_for_schedule): Use scheduled_insns vector instead of
	last_scheduled_insn.
	(ok_for_early_queue_removal): Likewise.
	(queue_to_ready): Search forward in nonscheduled_insns_begin if
	we have a dbg_cnt.
	(choose_ready): Likewise.
	(commit_schedule): Use VEC_iterate.
	(schedule_block): Initialize nonscheduled_insns_begin.  If we have
	a dbg_cnt, use it and ensure the first insn is in the ready list.
	(haifa_sched_init): Allocate scheduled_insns.
	(sched_extend_ready_list): Don't allocate it; reserve space.
	(haifa_sched_finish): Free it.

	2011-04-29  Alexandre Oliva  <aoliva@redhat.com>
	* haifa-sched.c (last_nondebug_scheduled_insn): New.
	(rank_for_schedule): Use it.
	(schedule_block): Set it.

	2011-05-02  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>
	* haifa-sched.c (sched_emit_insn): Emit insn before first
	non-scheduled insn.  Inform back-end about new insn.  Add
	new insn to scheduled_insns list.

	gcc/
	* haifa-sched.c (prune_ready_list): New function, broken out of
	schedule_block.
	(schedule_block): Use it.

	2011-04-16  Bernd Schmidt  <bernds@codesourcery.com>
	PR target/48629
	* haifa-sched.c (prune_ready_list, schedule_block): Use
	sched_pressure_p rather than flag_sched_pressure.

	2011-04-05  Bernd Schmidt  <bernds@codesourcery.com>
	PR bootstrap/48403
	* haifa-sched.c (schedule_block): Increment cycle_issued_insns only
	if old and new states differ.

2012-01-16  Meador Inge  <meadori@codesourcery.com>

	CB-199

	* release-notes-csl.xml (New ARMv7-M multilib): New note.

	gcc/
	* config/arm/t-cs-eabi
	(MULTILIB_OPTIONS): Add 'march=armv7-m'.
	(MULTILIB_ALIASES): Add new aliases for 'march=armv7-m'.
	(MULTILIB_EXCEPTIONS): Add new exceptions for 'march=armv7-m'.
	(MULTILIB_MATCHES): Added matches for archs and cpus that
	support ARMv7-M.
	(MULTILIB_DIRNAMES): Add GCC directory for ARMv7-M.
	(MULTILIB_OSDIRNAMES): Add OS directory for ARMv7-M.

2011-12-19  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* attribs.c (decl_attributes): Avoid emitting a warning if
	ATTR_FLAG_BUILT_IN.
	* doc/rtl.texi (CALL_INSN_FUNCTION_USAGE): Use lowercase for rtx
	codes.  Document meaning of sets inside CALL_INSN_FUNCTION_USAGE.
	* c-family/c-common.c (DEF_ATTR_STRING): Define and undefine as
	necessary.
	* builtin-attrs.def (DEF_ATTR_FOR_STRING): Define.  Use it to
	define a string "1".
	(ATTR_RET1_NOTHROW_NONNULL_LEAF): New attr definition.
	* builtins.def (BUILT_IN_MEMCPY, BUILT_IN_MEMMOVE): Use it for
	these functions.
	* postreload.c (reload_combine): Deal with SETs inside
	CALL_INSN_FUNCTION_USAGE.
	* cse.c (cse_insn): Likewise.
	* sched-deps.c (sched_analyze_insn): Likewise.
	* expr.c (init_block_move_fn): Set a "fn spec" attribute.
	* calls.c (decl_return_flags): New static function.
	(expand_call): Generate a SET in CALL_INSN_FUNCTION_USAGE for
	functions that return one of their arguments.
	* lto/lto-lang.c (handle_fnspec_attribute): New static function.
	(lto_attribute_table): Add "fn spec".
	(DEF_ATTR_STRING): Define and undefine along with the other macros.
	* ira.c (create_sets_for_returned_args): New static function.
	(ira): Call it.
	* regcprop.c (struct kill_set_value_data): New.
	(kill_set_value): Interpret data as a pointer to such a struct.
	Do nothing if the caller wants the register to be ignored.
	(copyprop_hardreg_forward_1): Handle SETs in CALL_INSN_FUNCTION_USAGE.

2011-12-21  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config/s390/s390.c (s390_expand_cs_hqi, s390_expand_atomic):
	Update calls to store_bit_field.

2011-12-20  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #12604

	* release-notes-csl.xml (Compiler fix for section conflict error):
	New note.

	gcc/
	* varasm.c (default_section_type_flags): Set SECTION_CODE in
	flags when decl is NULL_TREE, and section name matches ".text*".

	gcc/testsuite/
	* gcc.target/powerpc/pr51623.c: New testcase.

2011-12-19  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* config/mips/netlogic.h (SUBTARGET_CC1_SPEC): Tune loop unroller.

2011-12-19  Bernd Schmidt  <bernds@codesourcery.com>

	NetLogic XLP optimization to improve hmmer.

	gcc/
	* dbgcnt.def (ira_move): New counter.
	* ira-int.h (ira_create_new_reg): Declare function.
	(first_moveable_pseudo, last_moveable_pseudo): Declare variables.
	* ira-emit.c (ira_create_new_reg): Renamed from craete_new_reg and
	no longer static.  All callers changed.
	* ira.c: Include "dbgcnt.h".
	(rtx_moveable_p, insn_dominated_by_p, find_moveable_pseudos,
	move_unallocated_pseudos): New static functions.
	(first_moveable_pseudo, last_moveable_pseudo): New global variables.
	(pseudo_replaced_reg, pseudo_move_insn): New static variables.
	(ira): Call find_moveable_pseudos and move_unallocated_pseudos.
	* ira-costs.c (find_costs_and_classes): Assign a memory cost of zero
	to the pseudos generated in find_moveable_pseudos.
	* Makefile.in (ira.o): Add $(DBGCNT_H).

2011-12-19  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #12534

	* release-notes-csl.xml (Fix for compiler hang): New note.

	Backport from mainline:

	2011-12-19  Sandra Loosemore  <sandra@codesourcery.com>
		    Tom de Vries <tom@codesourcery.com>

	PR rtl-opt/50380

	gcc/
	* cse.c (find_comparison_args): Detect fixed point and
	bail early.

	gcc/testsuite/
	* gcc.c-torture/compile/pr50380.c: New testcase.

2011-12-14  Kazu Hirata  <kazu@codesourcery.com>

	CB-744
	* release-notes-csl.xml (ARM miscompilation fix): New.

	Backport from FSF:

	gcc/
	2011-12-05  Kazu Hirata  <kazu@codesourcery.com>

	PR target/51408
	* config/arm/arm.md (*minmax_arithsi): Always require the else
	clause in the MINUS case.

	gcc/testsuite/
	2011-12-05  Kazu Hirata  <kazu@codesourcery.com>

	PR target/51408
	* gcc.dg/pr51408.c: New.

2011-12-13  Meador Inge  <meadori@codesourcery.com>

	Issue #12493

	* release-notes-csl.xml: New note.

	gcc/
	* config/rs6000/rs6000.h (TARGET_NO_LWSYNC): Extended to cover PPC
	440 and 603 processors.

2011-12-02  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/
	2011-12-02  Joseph Myers  <joseph@codesourcery.com>

	Revert:

	2008-09-18  Andrew Pinski  <andrew_pinski@playstation.sony.com>

	PR rtl-opt/37451
	* loop-doloop.c (doloop_modify): New argument zero_extend_p and
	zero extend count after the correction to it is done.
	(doloop_optimize): Update call to doloop_modify, don't zero extend
	count before call.

	2008-11-03  Andrew Pinski  <andrew_pinski@playstation.sony.com>

	PR rtl-opt/37782
	* loop-doloop.c (doloop_modify): Add from_mode argument that says what
	mode count is in.
	(doloop_optimize): Update call to doloop_modify.

	gcc/testsuite/
	2011-12-02  Joseph Myers  <joseph@codesourcery.com>

	* gcc.c-torture/execute/doloop-1.c,
	gcc.c-torture/execute/doloop-2.c: New tests.

2011-12-01  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/
	2011-11-29  Joseph Myers  <joseph@codesourcery.com>

	* config/sh/sh.h (enum reg_class, REG_CLASS_NAMES)
	(REG_CLASS_CONTENTS): Add NON_SP_REGS.
	(REGCLASS_HAS_GENERAL_REG): Handle NON_SP_REGS.
	* config/sh/constraints.md (u): New constraint.

2011-11-24  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-09-27  Oleg Endo  <oleg.endo@t-online.de>

	* gcc.target/sh/mfmovd.c: Extend list of supported targets.
	* gcc.target/sh/struct-arg-dw2.c: Fix typo.
	* gcc.target/sh/sh4a-sincos.c: Make test SH4A only.
	* gcc.target/sh/sh4a-sincosf.c: Ditto.
	* gcc.target/sh/sh4a-cos.c: Ditto.
	* gcc.target/sh/sh4a-cosf.c: Ditto.
	* gcc.target/sh/sh4a-sin.c: Ditto.
	* gcc.target/sh/sh4a-sinf.c: Ditto.
	* gcc.target/sh/sh4a-fsrra.c: Ditto.
	* gcc.target/sh/sh4a-memmovua.c: Ditto.
	* gcc.target/sh/sh4a-bitmovua.c: Ditto.

2011-11-23  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #10524

	* release-notes-csl.xml (Additional library required on link
	command line): New note.

2011-11-22  Sandra Loosemore  <sandra@codesourcery.com>

	libstdc++-v3/
	* configure.ac (GLIBCXX_COMPUTE_STDIO_INTEGER_CONSTANTS): Disable
	for unhosted library build.
	* configure: Regenerated.

2011-11-18  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-11-18  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/cpp/assert4.c: Test __linux__, not __gnu_linux__.

2011-11-18  Nathan Sidwell  <nathan@codesourcery.com>

	gcc/
	* config/t-slibgcc-symbian (SHLIB_MAPFILES): Use libgcc_objdir.

2011-11-16  Tom de Vries  <tom@codesourcery.com>

	Issue #12387

	gcc/
	* ee.c (remove_redundant_extensions): Save max_reg_num () in n_regs.
	Use n_regs.

2011-11-15  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* config/mips/netlogic.h (DRIVER_SELF_SPECS): Enable -msym32 for
	-mabi=64 by default.

2011-11-15  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config/i386/i386elf.h (PREFERRED_DEBUGGING_TYPE): Remove.

2011-11-14  Tom de Vries  <tom@codesourcery.com>

	Issue #12436

	gcc/
	* config/mips/mips.c (mips16_check_branches): Set JUMP_LABEL of new_jump
	to label1.

2011-11-10  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml: Fix "FreeScale" typos in release notes.

2011-11-07  Meador Inge  <meadori@codesourcery.com>

	Issue #12323

	* release-notes-csl.xml: New note.

	Backport from FSF:

	gcc/
	2011-04-20  Easwaran Raman  <eraman@google.com>

	* cfgexpand.c (add_alias_set_conflicts): Add conflicts with a variable
	containing union type only with -fstrict-aliasing.

	gcc/testsuite/
	2011-04-20  Easwaran Raman  <eraman@google.com>

	* gcc.dg/stack-layout-1.c: New test.

2011-11-07  Kwok Cheung Yeung  <kcy@codesourcery.com>

	* release-notes-csl.xml: Use ColdFire+ name consistently.

2011-11-03  Julian Brown  <julian@codesourcery.com>

	Issue #12388

	Backport from FSF mainline:

	2011-09-07  Richard Sandiford  <richard.sandiford@linaro.org>

	PR target/49030
	gcc/
	* config/arm/arm-protos.h (maybe_get_arm_condition_code): Declare.
	* config/arm/arm.c (maybe_get_arm_condition_code): New function,
	reusing the old code from get_arm_condition_code.  Return ARM_NV
	for invalid comparison codes.
	(get_arm_condition_code): Redefine in terms of
	maybe_get_arm_condition_code.
	* config/arm/predicates.md (arm_comparison_operator): Use
	maybe_get_arm_condition_code.

	gcc/testsuite/
	* gcc.dg/torture/pr49030.c: New test.

	2011-09-09  Georg-Johann Lay  <avr@gjlay.de>

	PR target/49030
	gcc/testsuite/
	* gcc.dg/torture/pr49030.c: Run only if target int32plus.

	2011-09-22  Richard Sandiford  <richard.sandiford@linaro.org>

	gcc/
	* config/arm/predicates.md (expandable_comparison_operator): New
	predicate, extracted from...
	(arm_comparison_operator): ...here.
	* config/arm/arm.md (cbranchsi4, cbranchsf4, cbranchdf4, cbranchdi4)
	(cstoresi4, cstoresf4, cstoredf4, cstoredi4, movsicc, movsfcc)
	(movdfcc): Use expandable_comparison_operator.

	gcc/testsuite/
	* gcc.target/arm/cmp-1.c: New test.
	* gcc.target/arm/cmp-2.c: Likewise.

2011-11-02  Julian Brown  <julian@codesourcery.com>

	Issue #10896

	gcc/testsuite/
	* lib/target-supports.exp (add_options_for_large_stack): New.
	* gcc.dg/graphite/interchange-7.c: Use large_stack dg option.

	libstdc++/testsuite/
	* 25_algorithms/random_shuffle/moveable.cc: Use large_stack dg
	option.

2011-11-02  Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.c-torture/execute/20101011-1.c: Skip on bare-metal m68k.

2011-11-02  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/m68k/m68k.c (TARGET_OVERRIDE_OPTIONS_AFTER_CHANGE): Define.

2011-10-31  Paul Brook  <paul@codesourcery.com>

	Backport from FSF
	gcc/
	* cgraphunit.c: Don't mark clones as static constructors.

	gcc/testsuite/
	* gcc.dg/constructor-1.c: New test.

2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/graphite/run-id-1.c: Pass -Wl,--stack,12582912 option for
	Windows targets.

	2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/tls/thr-cse-1.c: For i?86-*-mingw*, check for multiple
	calls.

2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	* gcc.target/i386/pad-4.c: Skip for Windows targets.

	2011-10-26  Joseph Myers  <joseph@codesourcery.com>

	* gcc.target/i386/pr37843-4.c: Allow for leading underscores on
	symbol names.

2011-10-25  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-25  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/format/ms_c90-printf-1.c, gcc.dg/format/ms_c90-scanf-1.c:
	Update expected messages.

2011-10-25  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #12354

	gcc/
	* config/m68k/m68k-devices.def: Add 51jg.
	* doc/invoke.texi (M680x0 Options): Document.

	* release-notes-csl.xml: Add note.

2011-10-21  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config/sh/cs-sgxxlite-linux.h (SUBTARGET_OVERRIDE_OPTIONS): Test
	OPTION_UCLIBC not linux_uclibc.

2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/lto/pr46940_0.c (ASMNAME, ASMNAME2, STRING): Define.
	(_moz_foo, EXT__foo): Use ASMNAME.

2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	* lib/lto.exp (lto-execute): Use .exe suffix for test executable
	names.

2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/tree-prof/val-prof-7.c: Declare bzero instead of
	including <strings.h>.

	2011-10-20  Joseph Myers  <joseph@codesourcery.com>

	* gcc.target/i386/pr40906-1.c, gcc.target/i386/pr40906-2.c,
	gcc.target/i386/pr46226.c: Do not use
	-mno-accumulate-outgoing-args.

2011-10-19  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-19  Joseph Myers  <joseph@codesourcery.com>

	* g++.dg/compat/struct-layout-1_generate.c: Also pass -mno-mmx
	-Wno-abi for i?86-*-mingw32* x86_64-*-mingw32* i?86-*-cygwin*.

2011-10-19  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-10-06  Joern Rennecke <joern.rennecke@embecosm.com>

	* gcc.dg/pr47276.c (ASMNAME, ASMNAME2, STRING): Define.
	(__EI___vsyslog_chk, __EI_syslog, __EI_vsyslog): Use ASMNAME.  
	(syslog, vsyslog, __vsyslog_chk): Likewise.

	* gcc.dg/lto/20081222_1.c (ASMNAME, ASMNAME2, STRING): Define.
	(x, EXT_x): Use ASMNAME.

	* gcc.dg/torture/pr48044.c (ASMNAME, ASMNAME2, STRING): Define.
	(a, c): Use ASMNAME.

2011-10-19  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* config.gcc (mips64*-*-linux*): Use N32 ABI by default for NetLogic
	toolchain.
	(mips64-netlogic-linux-gnu): Rename to mips64-nlm-linux-gnu.
	* config/mips/netlogic.h: Use N32 ABI by default.
	* config/mips/t-netlogic: Use default multilib configuration from
	t-linux64.

2011-10-18  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #12100
	* release-notes-csl.xml (Internal compiler error with NEON intrinsics):
	New note.

	Backport from mainline:

	gcc/
	2011-04-17  Chung-Lin Tang  <cltang@codesourcery.com>

	* config/arm/arm.c (neon_struct_mem_operand): Support POST_INC/PRE_DEC
	memory operands.

2011-10-17  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.target/powerpc/ppc-fpconv-3.c: Fix typo.
	* gcc.target/powerpc/ppc-fpconv-7.c: Likewise.
	* gcc.target/powerpc/ppc-fpconv-8.c: Likewise.

2011-10-17  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	2011-10-12  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.target/powerpc/warn-1.c: Skip if not powerpc_vsx_ok.
	* gcc.target/powerpc/warn-2.c: Ditto.

2011-10-17  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	2011-10-12  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.target/powerpc/ppc-fma-3.c: Require hard_float.
	* gcc.target/powerpc/ppc-fma-4.c: Likewise.
	* gcc.target/powerpc/ppc-fma-5.c: Likewise.
	* gcc.target/powerpc/ppc-fma-7.c: Likewise.
	* gcc.target/powerpc/ppc-fpconv-11.c: Likewise.
	* gcc.target/powerpc/ppc-fpconv-3.c: Likewise.
	* gcc.target/powerpc/ppc-fpconv-7.c: Likewise.
	* gcc.target/powerpc/ppc-fpconv-8.c: Likewise.
	* gcc.target/powerpc/ppc-pow.c: Likewise.
	* gcc.target/powerpc/recip-1.c: Likewise.
	* gcc.target/powerpc/recip-2.c: Likewise.
	* gcc.target/powerpc/recip-3.c: Likewise.
	* gcc.target/powerpc/recip-4.c: Likewise.
	* gcc.target/powerpc/recip-5.c: Likewise.


2011-10-17  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:
	gcc/testsuite/

	2011-09-29  Jiangning Liu  <jiangning.liu@arm.com>

	* gcc/testsuite/gcc.dg/tree-ssa/predcom-1.c: Explicitly turn on
	loop unroll and set max unroll times to 8.
	* gcc/testsuite/gcc.dg/tree-ssa/predcom-2.c: Likewise.
	* gcc/testsuite/gcc.dg/tree-ssa/predcom-3.c: Likewise.
	* gcc/testsuite/gcc.dg/tree-ssa/predcom-4.c: Likewise.
	* gcc/testsuite/gcc.dg/tree-ssa/predcom-5.c: Likewise.

	2011-09-21  Terry Guo  <terry.guo@arm.com>

	* gcc.target/arm/neon-thumb2-move.c: Skip the warning message
	on arch conflict when testing case on targets other than armv7-a.

	2011-09-19  Ian Bolton  <ian.bolton@arm.com>

	* gcc.dg/20100906-1.c: Use -fno-short-enums option for
	"target arm_eabi".

	2011-09-16  Terry Guo  <terry.guo@arm.com>

	* gcc.dg/tree-ssa/foldconst-3.c: Don't use short enums.

	2011-08-04  Ian Bolton  <ian.bolton@arm.com>

	* gcc.target/arm/vfp-1.c: no large negative offsets on Thumb2.

2011-10-13  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #11339
	Issue #12112
	* release-notes-csl.xml (ARM VFP9-S errata workaround): New note.

	gcc/
	* config/arm/arm.md (arch): Add vfp9, notvfp9 values. Add comments
	explaining use.
	(arch_enabled): Add cases for vfp9, notvfp9.
	* config/arm/vfp.md (divsf3_vfp,divdf3_vfp,sqrtsf2_vfp,sqrtdf2_vfp):
	Add alternative with early clobber destination, enabled by vfp9/notvfp9.

2011-10-12  Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/torture/stackalign/builtin-apply-2.c: Skip for hard-float
	ARM.

2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-07-27  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>

	* lib/target-supports.exp (check_effective_target_mmap): Use
	check_function_available.

2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	2011-07-25  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>

	gcc/
	* doc/sourcebuild.texi (Effective-Target Keywords, Environment
	attributes): Document mmap.

	gcc/testsuite/
	* lib/target-supports.exp (check_effective_target_mmap): New proc.

	* gcc.c-torture/execute/loop-2f.c: Remove #ifdef __unix__.
	* gcc.c-torture/execute/loop-2g.c: Likewise.
	* gcc.c-torture/execute/loop-2f.x: Load target-supports.exp.
	Require mmap support.
	* gcc.c-torture/execute/loop-2g.x: Likewise.
	* gcc.dg/20030711-1.c: Replace dg-do target list by mmap.
	(MAP_ANON): Provide default.
	* gcc.dg/20050826-1.c: Likewise.
	* gcc.target/i386/pr36533.c: Likewise.
	* gcc.dg/vect/pr49038.c: Use dg-require-effective-target mmap.

2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	gcc/testuite/
	2011-09-06  Michael Meissner  <meissner@linux.vnet.ibm.com>

	* g++.dg/ext/altivec-17.C: Fix dg-error to match current compiler.

2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	gcc/testsuite
	2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	* gcc.dg/graphite/id-pr46845.c: Include powerpc for warning options.

2011-10-10  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-05-11  Alan Modra  <amodra@gmail.com>

	PR target/47755
	* gcc.target/powerpc/pr47755-2.c: Require vsx_hw.

2011-10-10  Julian Brown  <julian@codesourcery.com>

	gcc/
	* calls.c (emit_library_call_value_1): Pass a tree not an int for
	fourth argument of expand_shift.

2011-10-07  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #11914
	Issue #12259

	gcc/
	* config/m68k/m68k-devices.def: Add 51jf and 51qm.
	* doc/invoke.texi (M680x0 Options): Document.

	* release-notes-csl.xml: Add note.

2011-10-07  Julian Brown  <julian@codesourcery.com>

	Issue #12169

	* release-notes-csl.xml (ColdFire comparison fix): New note.

	gcc/
	* config/m68k/m68k.c (notice_update_cc): Tighten condition for
	setting CC_REVERSED for FP comparisons.

2011-10-04  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF GCC 4.6:

	2011-07-14  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite
	* gcc.target/arm/pr40657-2.c: Remove -march.
	* gcc.target/arm/pr42235.c: Likewise.
	* gcc.target/arm/pr42495.c: Likewise.
	* gcc.target/arm/pr42574.c: Likewise.
	* gcc.target/arm/pr40956.c: Remove target-specific options.
	* gcc.target/arm/pr42505.c: Likewise.

	* lib/target-supports.exp (check_effective_target_arm_thumb1): New.
	* gcc.target/arm/mla-1.c: Skip for arm_thumb1, don't specify -march.

	* gcc.target/arm/pr42093.c: Use "-fno-reorder-blocks".

	* gcc.target/arm/pr39839.c: Don't specify -march, require thumb.
	* gcc.target/arm/thumb-branch1.c: Likewise.

	* gcc.target/arm/pr45701-1.c: Don't specify -march, require thumb.
	* gcc.target/arm/pr45701-2.c: Likewise.

	* gcc.target/arm/vfp-ldmdbs.c: Skip for soft float.
	* gcc.target/arm/vfp-ldmias.c: Likewise.
	* gcc.target/arm/vfp-ldmdbd.c: Likewise.
	* gcc.target/arm/vfp-stmdbs.c: Likewise.
	* gcc.target/arm/vfp-ldmiad.c: Likewise.
	* gcc.target/arm/vfp-stmias.c: Likewise.
	* gcc.target/arm/vfp-stmdbd.c: Likewise.
	* gcc.target/arm/vfp-stmiad.c: Likewise.

	* gcc.c-torture/compile/pr41679.c: Move from gcc.target/arm.
	* gcc.c-torture/compile/pr46883.c: Likewise.

	* gcc.target/arm/pr41679.c: Remove test directives in preparation
	for move to ../../gcc.c-torture/compile.
	* gcc.target/arm/pr46883.c: Likewise.

	* lib/target-supports.exp (check_effective_target_arm_dsp): New.
	* gcc.target/arm/wmul-1.c: Use it instead of specific -march.
	* gcc.target/arm/wmul-2.c: Likewise.
	* gcc.target/arm/wmul-3.c: Likewise.
	* gcc.target/arm/wmul-4.c: Likewise.

	2011-07-05  Janis Johnson  <janisjo@codesourcery.com>

	* gcc.target/arm/20031108-1.c: Require thumb1 or thumb2.
	* gcc.target/arm/pr40482.c: Likewise.
	* gcc.target/arm/stack-corruption.c: Likewise.

	* gcc.target/arm/ctz.c: Don't specify -march, require thumb2.
	* gcc.target/arm/pr42879.c: Likewise.
	* gcc.target/arm/pr45701-3.c: Likewise.

	* gcc.target/arm/thumb-bitfld1.c: Don't specify -march, require thumb1.

	* gcc.target/arm/scd42-3.c: Allow -march-xscale; skip if -mcpu
	is not xscale.

	* lib/target-supports-dg.exp (dg-require-effective-target): Return
	early if the test is already being skipped.

	* lib/target-supports.exp (add_options_for_arm_fp16): Renamed
	from add_options_for_arm_neon_fp16.
	(check_effective_target_arm_fp16_ok_nocache): Renamed from
	check_effective_target_arm_neon_fp16_ok_nocache.
	Check -mfpu and -mfloat-abi options from current multilib.
	Do not require neon support.
	(check_effective_target_arm_fp16_ok): Renamed from
	check_effecitve_target_arm_neon_fp16_ok.
	* g++.dg/ext/arm-fp16/arm-fp16-ops-5.C: Use new names for
	arm_neon_fp16_ok and arm_fp16.
	* g++.dg/ext/arm-fp16/arm-fp16-ops-6.C: Likewise.
	* gcc.dg/torture/arm-fp16-ops-5.c: Likewise.
	* gcc.dg/torture/arm-fp16-ops-6.c: Likewise.
	* gcc.target/arm/fp16-compile-vcvt.c: Likewise.

	* lib/scandump.exp (scan-dump, scan-dump-times, scan-dump-not,
	scan-dump-dem, scan-dump-dem-not): Treat a missing dump file as
	unresolved and report the reason to the log file.

	* lib/scanasm.exp (dg-scan, scan-assembler-times, scan-assembler-dem,
	scan-assembler-dem-not): For missing file, report unresolved with
	same message as for pass/fail, with reason reported in log file.

2011-10-03  Julian Brown  <julian@codesourcery.com>

	Issue #12170 (revised patch)

	gcc/
	* reload1.c (set_label_offsets): Force initial_p for labels
	receiving non-local gotos.

2011-10-04  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/
	2011-10-04  Joseph Myers  <joseph@codesourcery.com>

	* config.gcc (i[34567]86-*-elf*, x86_64-*-elf*): Use
	i386/t-crtstuff.

2011-10-03  Janis Johnson  <janisjo@codesourcery.com>

	Issue #12254
	Revert:

	Issue #12170

	gcc/
	* reload1.c (set_label_offsets): Force initial_p for labels
	receiving non-local gotos.

2011-10-03  Julian Brown  <julian@codesourcery.com>

	Issue #12170

	gcc/
	* reload1.c (set_label_offsets): Force initial_p for labels
	receiving non-local gotos.

2011-10-03  Julian Brown  <julian@codesourcery.com>

	Backport from FSF:

	gcc/
	2011-03-15  Xinliang David Li  <davidxl@google.com>
	PR c/47837
	* tree-ssa-uninit.c (pred_chain_length_cmp): New function.
	(normalize_preds): New function.
	(is_use_properly_guarded): Normalize def predicates.

	gcc/testsuite/
	2011-03-15  Xinliang David Li  <davidxl@google.com>
	PR c/47837
	* gcc.dg/uninit-pred-7_d.c: New test.
	* gcc.dg/uninit-pred-8_d.c: New test.

2011-10-02  Tom de Vries  <tom@codesourcery.com>

	Issue #12157

	gcc/
	* reorg.c (redundant_insn): Handle label in delay slot.

2011-09-29  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-09-28  Catherine Moore  <clm@codesourcery.com>
	Issue #12036
	gcc/
	* config/mips/mips.c (WALK_INSNS): New macro.
	(OK_FOR_MIPS16_BRANCH_OFFSET): New macro.
	(mips16_count_matching_branches): New function.
	(walk_insns_forward): New function.
	(walk_insns_reverse): New function.
	(mips16_update_branch_info): New function.
	(mips16_zero_branch_info): New function.
	(mips16_check_branches): New function.
	(mips_reorg_process_instructions): Call mips16_check_branches.
	* config/mips.h (mips16_branch_info_t): New typedef.

	* release-notes-csl.xml: Document.

2011-09-22  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2011-09-22  Joseph Myers  <joseph@codesourcery.com>

	* gcc.target/i386/pad-2.c, gcc.target/i386/pad-3.c,
	gcc.target/i386/pad-4.c, gcc.target/i386/pad-5a.c,
	gcc.target/i386/pad-5b.c, gcc.target/i386/pad-6a.c,
	gcc.target/i386/pad-6b.c, gcc.target/i386/pad-7.c,
	gcc.target/i386/pad-8.c, gcc.target/i386/pad-9.c,
	gcc.target/i386/pad-10.cm gcc.target/i386/vect-double-1.c: Skip if
	multilib options contain different -march= from dg-options.

2011-09-21  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	libquadmath/
	2011-09-21  Joseph Myers  <joseph@codesourcery.com>

	* Makefile.am (FLAGS_TO_PASS): Define.
	* Makefile.in: Regenerate.

2011-09-19  Bernd Schmidt  <bernds@codesourcery.com>

	Merge from sg++ 4.5
	gcc/
	* opts.c (default_options_table): Remove -fshrink-wrap from -O1.
	* doc/invoke.texi (-fshrink-wrap): Not enabled by -O anymore.

	Merge from sg++ 4.5
	Issue #11469

	gcc/
	* regcprop.c (early_copyprop_hardreg_forward): Call
	split_all_insns.

	Merge from sg++ 4.5
	Issue #11372

	gcc/
	* passes.c (init_optimization_passes): Move the first
	pass_cprop_hardreg before split_after_reload.

2011-09-19  Paul Brook  <paul@codesourcery.com>

	Merge from sg++ 4.5
	Issue #11876

	gcc/
	* config/arm/predicates.md (shift_amount_operand): Check constant
	shift count is in range.
	(const_shift_operand): Remove.

2011-09-15  Joe Seymour  <jseymour@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/vect/pr48172.c: Remove dg-do run.
	* gcc.dg/vect/pr48377.c: Likewise.

2011-09-12  Joe Seymour  <jseymour@codesourcery.com>

	Issue #11875

	Merge from Sourcery G++ 4.5:

	2009-08-26  Daniel Jacobowitz  <dan@codesourcery.com>

	       Issue #6131 - Enable additional optimizations by default in Lite
	       gcc/
	       (arm_optimization_options): Enable flag_promote_loop_indices.

2011-09-12  Zoran Jovanovic  <zoran.jovanovic@rt-rk.com>

	gcc/
	* common.opt (fuse-caller-save): New option.
	* final.c (collect_fn_hard_reg_usage, fn_hard_reg_usage_hash)
	(fn_hard_reg_usage_eq, get_fn_reg_set_usage, get_call_fndecl_rec)
	(get_call_fndecl, get_call_reg_set_usage): New function.
	(compute_alignments): Use collect_fn_hard_reg_usage.
	(struct fn_hard_reg_usage): New struct.
	(fn_hard_reg_usage_htab): New variable.
	* regs.h (get_call_reg_set_usage): Declare.
	* df-scan.c (df_get_call_refs): Use get_call_reg_set_usage.
	* caller-save.c (setup_save_areas, save_call_clobbered_regs): Use
	get_call_reg_set_usage.
	* resource.c (mark_set_resources, mark_target_live_regs): Use
	get_call_reg_set_usage.
	* ira-int.h (struct ira_allocno): Add crossed_calls_clobbered_regs
	field.
	(ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS): Define.
	* ira-lives.c (process_bb_node_lives): Use get_call_reg_set_usage.
	Calculate ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	* ira-build.c (ira_create_allocno): Init
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	(create_cap_allocno, propagate_allocno_info)
	(propagate_some_info_from_allocno)
	(copy_info_to_removed_store_destinations): Handle
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	* ira-costs.c (ira_tune_allocno_costs_and_cover_classes): Use
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS to adjust costs.
	* Makefile.in (GTFILES): add final.c.

2011-09-12  Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.c-torture/execute/20101011-1.c: Skip test on ARM if we have
	hardware division instructions.

2011-09-12  Paul Brook  <paul@codesourcery.com>

	Merge from SG++4.5
	2011-06-03  Paul Brook  <paul@codesourcery.com>
	gcc/
	* expmed.c (store_bit_field_1, store_bit_field): Add packedp argument.
	(warn_misaligned_bitfield): New function.
	(store_fixed_bit_field): Fix misaligned bitfields on and
	-fstrict-volatile-bitfields.
	(store_split_bit_field): Pass new argument.
	(extract_fixed_bit_field): Use warn_misaligned_bitfield.
	* calls.c (store_unaligned_arguments_into_pseudos): Pass new argument.
	* expr.c (store_field): Add packedp argument.
	(emit_group_store, copy_blkmode_from_reg, write_complex_part, 
	store_constructor_field, expand_expr_real_2): Pass new argument.
	(expand_assignment): Identify accesses to packed structures.
	* expr.h (store_bit_field): Update prototype.
	* ifcvt.c (noce_emit_move_insn): Pass new argument.
	* stmt.c (expand_return): Pass new argument.

2011-09-12  Nathan Sidwell  <nathan@codesourcery.com>

	Revert 2009-04-04  Sandra Loosemore  <sandra@codesourcery.com>
	it is no longer necessary.

	gcc/
	* tree-ssa-sink.c (sink_code_in_bb): Remove lexical block check code.

2011-09-12  Joe Seymour  <jseymour@codesourcery.com>

	Issue #11875
	
	Merge from Sourcery G++ 4.5:

	2009-03-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c: New file.
	* common.opt (fpromote-loop-indices): New option.
	* timevar.def (TV_TREE_LOOP_PROMOTE): New timevar.
	* Makefile.in (tree-ssa-loop-promote.o): New rule.
	(OBJS-comon): Include it.
	* tree-pass.h (pass_promote_short_indices): Declare.
	* passes.c (init_optimization_passes): Add it.
	* pointer-set.h (pointer_set_n_elements,
	pointer_set_clear,
	pointer_map_n_elements, pointer_map_clear): Declare.
	* pointer-set.c (pointer_set_n_elements,
	pointer_set_clear,
	pointer_map_n_elements, pointer_map_clear): Define.

	gcc/doc/
	* invoke.texi (-fpromote-loop-indices): New entry.

	gcc/testsuite/
	* gcc.dg/promote-short-1.c: New file.
	* gcc.dg/promote-short-2.c: New file.
	* gcc.dg/promote-short-3.c: New file.
	* gcc.dg/promote-short-4.c: New file.
	* gcc.dg/promote-short-5.c: New file.
	* gcc.dg/promote-short-6.c: New file.
	* gcc.dg/promote-short-7.c: New file.
	* gcc.dg/promote-short-8.c: New file.

	2009-03-31  Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* common.opt (fpromote-loop-indices): Add Optimization
	keyword.

	2009-04-08  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c
	(collection_promotion_candidates):
	Delay allocation and initialization of new promote_info
	until we know we have a candidate loop index.

	2009-04-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c (rebuild_with_promotion_1): Load
	a memory reference prior to promoting it.

	gcc/testsuite/
	* gcc.dg/promote-short-9.c: New test.

	2009-04-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/promote-short-3.c: XFAIL test for x86, m68k, sh,
	and mips.

	2009-04-13  Kazu Hirata  <kazu@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/promote-short-3.c: XFAIL on fido.

	2010-08-25  Jie Zhang  <jie@codesourcery.com>

	Issue #9156

	gcc/
	* tree-ssa-loop-promote.c (insert_along_edge): Use
	gimple_stmt_iterator to add statement to basic block.

	gcc/testsuite/
	* gcc.dg/promote-short-13.c: New test.

2011-09-12  Joe Seymour  <jseymour@codesourcery.com>

	Issue #11868

	Merge from Sourcery G++ 4.5:

	2009-09-08  Paul Brook  <paul@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #6027

	Merge submitted patches:
	http://gcc.gnu.org/ml/gcc-patches/2009-03/msg00250.html

	2009-02-02  J"orn Rennecke <amylaar@spamcop.net>

	gcc/
	* tree-ssa-pre.c (ppre_n_insert_for_speed_p): New function.
	* (do_partial_partial_insertion): Use it to throttle
	insert_into_preds_of_block calls.
	* common.opt (-ftree-pre-partial-partial-obliviously): New option.

	2009-01-15  J"orn Rennecke  <joern.rennecke@arc.com>

	gcc/
	* common.opt (ftree-pre-partial-partial): New option.
	* opts.c (decode_options): Initialize flag_tree_pre_partial_partial.
	* tree-ssa-pre.c (execute_pre): Use flag_tree_pre_partial_partial.

2011-09-12  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* final.c (shorten_branches): Handle deleted label in delay slot.
	* emit-rtl.c (verify_rtl_sharing): Same.
	* cfglayout.c (reemit_insn_block_notes): Same.
	* reorg.c (try_merge_delay_insns): Same.
	(redundant_insn): Handle (deleted) label in delay slot.
	(first_real_insn_in_seq): New function.
	(relax_delay_slots): Use first_insn.
	* rtl.h (DELETED_NOTE_P): Define.

2011-09-10  Tom de Vries  <tom@codesourcery.com>

	Issue #12030

	gcc/
	* stmt.c (emit_case_bit_tests): Calculate total_prob.  Scale label
	probabilities to total_prob.  Don't set jump probabilities if profile
	absent.

2011-09-08  Julian Brown  <julian@codesourcery.com>

	Backport from FSF GCC 4.6 branch:

	PR c++/49260

	2011-08-02  Jason Merrill  <jason@redhat.com>

	gcc/
	* g++.dg/cpp0x/lambda/lambda-eh2.C: Change options.

	gcc/cp/
	* call.c (build_call_a): Set cp_function_chain->can_throw here.
	(build_cxx_call): Not here.

2011-09-08  Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.c-torture/execute/20101011-1.c (__aeabi_idiv0): New, for ARM
	EABI.

2011-09-08  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12105
	Backport from mainline:

	2011-05-25  Bernd Schmidt  <bernds@codesourcery.com>

	PR bootstrap/49160
	* libgcc2.h (__powisf2, __powidf2, __powitf2, __powixf2,
	__mulsc3, __muldc3, __mulxc3, __multc3, __divsc3, __divdc3,
	__divxc3, __divtc3): Wrap definitions in #ifndef.

2011-09-06  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12073

	gcc/
	* cfgcleanup.c (try_head_merge_bb): If get_condition returns
	NULL for a jump that is a cc0 insn, pick the previous insn for
	move_before.

	gcc/testsuite/
	* gcc.c-torture/compile/20110907.c: New file.

2011-09-06  Julian Brown  <julian@codesourcery.com>

	Issue #11871

	Merge from Sourcery G++ 4.5:

	gcc/
	* config/arm/arm.c (arm_option_optimization_table): Turn on
	unrolling by default at -O2+.
	(arm_slowmul_tune, arm_fastmul_tune, arm_strongarm_tune)
	(arm_xscale_tune, arm_9e_tune, arm_v6t2_tune, arm_cortex_tune)
	(arm_cortex_a5_tune, arm_cortex_a9_tune, arm_fa726te_tune):
	Initialise aggressive_unrolling field.
	(arm_option_override): Limit maximum unrolling level, or disable
	default unrolling if not desired for current tuning setting.
	* config/arm/arm-protos.h (tune_params): Add aggressive_unrolling
	parameter.

2011-09-06  Tom de Vries  <tom@codesourcery.com>

	Issue #11755

	gcc/
	* reorg.c (steal_delay_list_from_target): Fix handling
	of annullable insns.

2011-09-02  Julian Brown  <julian@codesourcery.com>

	Issue #11884

	Backport from FSF mainline:

	gcc/
	* config/arm/arm.c (arm_block_move_unaligned_straight)
	(arm_adjust_block_mem, arm_block_move_unaligned_loop)
	(arm_movmemqi_unaligned): New.
	(arm_gen_movmemqi): Support unaligned block copies.

2011-09-02  Julian Brown  <julian@codesourcery.com>

	Issue #11884

	Backport from FSF mainline:

	gcc/
	* config/arm/arm.c (arm_override_options): Add unaligned_access
	support.
	(arm_file_start): Emit attribute for unaligned access as
	appropriate.
	* config/arm/arm.md (UNSPEC_UNALIGNED_LOAD)
	(UNSPEC_UNALIGNED_STORE): Add constants for unspecs.
	(insv, extzv): Add unaligned-access support.
	(extv): Change to expander. Likewise.
	(extzv_t1, extv_regsi): Add helpers.
	(unaligned_loadsi, unaligned_loadhis, unaligned_loadhiu)
	(unaligned_storesi, unaligned_storehi): New.
	(*extv_reg): New (previous extv implementation).
	* config/arm/arm.opt (munaligned_access): Add option.
	* config/arm/constraints.md (Uw): New constraint.
	* expmed.c (store_bit_field_1): Adjust bitfield numbering according
	to size of access, not size of unit, when BITS_BIG_ENDIAN !=
	BYTES_BIG_ENDIAN. Don't use bitfield accesses for
	volatile accesses when -fstrict-volatile-bitfields is in effect.
	(extract_bit_field_1): Likewise.

2011-09-02  Julian Brown  <julian@codesourcery.com>

	Issue #11870

	Backport from FSF mainline:

	2011-03-22  Bernd Schmidt  <bernds@codesourcery.com>
		    Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* config/arm/vfp.md (arm_movdi_vfp): Enable only when not tuning
	for Cortex-A8.
	(arm_movdi_vfp_cortexa8): New pattern.
	* config/arm/neon.md (adddi3_neon, subdi3_neon, anddi3_neon,
	iordi3_neon, xordi3_neon): Add alternatives to discourage Neon
	instructions when tuning for Cortex-A8.  Set attribute "arch".
	* config/arm/arm.md: Move include arm-tune.md up a bit.
	(define_attr "arch"): Add "onlya8" and "nota8" values.
	(define_attr "arch_enabled"): Handle "onlya8" and "nota8".

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline (candidate patch):

	Richard Sandiford  <richard.sandiford@linaro.org>
	
	gcc/
	* calls.c (emit_library_call_value_1): Pad according to
	BLOCK_REG_PADDING rather than FUNCTION_ARG_PADDING.
	* config/arm/ar.c (arm_pad_arg_upwards): Remove special
	handling for HFmode libcall arguments.
	(arm_pad_reg_upwards): Use mode to determine padding when type
	is not available.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	gcc/
	* configure.ac (fixed-point): Add ARM support.
	* configure: Regenerate.
	* config/arm/arm.c (arm_fixed_mode_set): New struct.
	(arm_set_fixed_optab_libfunc): New.
	(arm_set_fixed_conv_libfunc): New.
	(arm_init_libfuncs): Initialise fixed-point helper libfuncs with
	ARM-specific names.
	(aapcs_libcall_value): Return sub-word-size fixed-point libcall
	return values in SImode.
	(arm_return_in_msb): Return fixed-point types in the msb.
	(arm_pad_reg_upwards, arm_pad_arg_upwards): Pad fixed-point
	types upwards.
	(arm_scalar_mode_supported_p): Support fixed-point modes.
	(arm_vector_mode_supported_p): Support vector fixed-point modes.
	* config/arm/arm.h (SHORT_FRACT_TYPE_SIZE, FRACT_TYPE_SIZE)
	(LONG_FRACT_TYPE_SIZE, LONG_LONG_FRACT_TYPE_SIZE)
	(SHORT_ACCUM_TYPE_SIZE, ACCUM_TYPE_SIZE, LONG_ACCUM_TYPE_SIZE)
	(LONG_LONG_ACCUM_TYPE_SIZE, MAX_FIXED_MODE_SIZE): Define.
	* config/arm/iterators.md (FIXED, ADDSUB, UQADDSUB, QADDSUB,
	QMUL): New mode iterators.
	(qaddsub_suf): New mode attribute.
	* config/arm/arm-modes.def (FRACT, UFRACT, ACCUM, UACCUM):
	Declare vector modes.
	* config/arm/predicates.md (sat_shift_operator): New predicate.
	* config/arm/arm-fixed.md: New.
	* config/arm/arm.md: Include arm-fixed.md.
	* config/arm/t-arm (MD_INCLUDES): Add arm-fixed.md.

	libgcc/
	* config.host (arm*-*-linux*, arm*-*-uclinux*, arm*-*-eabi*)
	(arm*-*-symbianelf*): Add t-fixedpoint-gnu-prefix makefile
	fragment.
	* config/arm/bpabi-lib.h (LIBGCC2_FIXEDBIT_GNU_PREFIX): Define.

	gcc/testsuite/
	* gcc.target/arm/fixed-point-exec.c: New test.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-05-04  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>

	gcc/
	* calls.c (emit_library_call_value_1): Invoke
	promote_function_mode hook on libcall arguments.
	* explow.c (promote_function_mode, promote_mode): Handle TYPE
	argument being NULL.
	* targhooks.c (default_promote_function_mode): Lisewise.
	* config/s390/s390.c (s390_promote_function_mode): Likewise.
	* config/sparc/sparc.c (sparc_promote_function_mode): Likewise.

	* doc/tm.texi: Document that TYPE argument might be NULL.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:
	
	2011-08-01  H.J. Lu  <hongjiu.lu@intel.com>

	* calls.c (emit_library_call_value_1): Declare size only if
	BLOCK_REG_PADDING is defined.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	* calls.c (emit_library_call_value_1): Support padding for
	libcall arguments and return values.
	* config/arm/arm.c (arm_pad_arg_upward): Pad half-float values
	downwards in big-endian mode.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	* Makefile.in (LIBGCC_VER_FIXEDPOINT_GNU_PREFIX): New.
	(libgcc-std.ver.in): Use above.
	* fixed-bit.h (LIBGCC2_FIXEDBIT_GNU_PREFIX): Define, if
	LIBGCC2_GNU_PREFIX is defined.  Use instead of
	  LIBGCC2_GNU_PREFIX throughout file.
	* config/t-fixedpoint-gnu-prefix: New file.
	* config/t-gnu-prefix (LIBGCC_VER_FIXEDPOINT_GNU_PREFIX): Set.
	* libgcc-std.ver.in (fixed-point routines): Use __FIXPTPFX__
	instead of __PFX__.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-05-27  Bernd Schmidt  <bernds@codesourcery.com>

	PR bootstrap/49173
	libgcc/
	* config/t-slibgcc-darwin (SHLIB_MAPFILES): Look for
	libgcc-std.ver in the build directory.
	* config/s390/t-linux (SHLIB_MAPFILES): Likewise.
	* config/sh/t-linux (SHLIB_MAPFILES): Likewise.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-05-26  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* Makefile.in (srcdirify): Change order so that libgcc_objdir is
	substituted first.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-05-25  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* libgcc2.h (__NW, __NDW): Define using a __gnu_ prefix if
	LIBGCC2_GNU_PREFIX is defined.
	(__N): New macro.
	(__powisf2, __powidf2, __powitf2, __powixf2, __bswapsi2,
	__bswapdi2, __mulsc3, __muldc3, __mulxc3, __multc3, __divsc3,
	__divdc3, __divxc3, __divtc3, __udiv_w_sdiv, __clear_cache,
	__enable_execute_stack, __clz_tab): Define using __N.
	(__absvsi2, __negvsi2, __addvsi3, __subvsi3, __mulvsi3):
	Likewise if COMPAT_SIMODE_TRAPPING_ARITHMETIC.
	* target.def (libfunc_gnu_prefix): New hook.
	* doc/tm.texi.in (LIBGCC2_GNU_PREFIX): Document.
	(TARGET_LIBFUNC_GNU_PREFIX): Add hook.
	* doc/tm.texi: Regenerate.
	* system.h (LIBGCC2_GNU_PREFIX): Poison.
	* optabs.c (gen_libfunc): Take the libfunc_gnu_prefix hook into
	account.
	(gen_interclass_conv_libfunc, gen_intraclass_conv_libfunc):
	Likewise. (init_optabs): Likewise for the bswap libfuncs.
	* tree.c (build_common_builtin_nodes): Likewise for complex
	multiply and divide.
	* config/t-slibgcc-elf-ver (SHLIB_MAPFILES): Use
	$$(libgcc_objdir).
	* config/t-slibgcc-sld (SHLIB_MAPFILES): Likewise.
	* libgcc-std.ver: Remove.
	* Makefile.in (srcdirify): Handle $$(libgcc_objdir).
	* config/frv/t-linux (SHLIB_MAPFILES): Use $$(libgcc_objdir) for
	libgcc-std.ver.
	* config/i386/t-linux (SHLIB_MAPFILES): Likewise.
	* config/mips/t-slibgcc-irix (SHLIB_MAPFILES): Likewise.
	* config/rs6000/t-aix43 (SHLIB_MAPFILES): Likewise.
	* config/rs6000/t-aix52 (SHLIB_MAPFILES): Likewise.
	* config/sparc/t-linux (SHLIB_MAPFILES): Likewise.
	* config/i386/t-linux (SHLIB_MAPFILES): Likewise.
	* config/i386/t-linux (SHLIB_MAPFILES): Likewise.
	* config/fixed-bit.h (FIXED_OP): Define differently depending on
	LIBGCC2_GNU_PREFIX. All uses changed not to pass leading
	underscores. (FIXED_CONVERT_OP, FIXED_CONVERT_OP2): Likewise.

	libgcc/
	* libgcc-std.ver.in: New file.
	* Makefile.in (LIBGCC_VER_GNU_PREFIX,
	LIBGCC_VER_SYMBOLS_PREFIX): New variables.
	(libgcc-std.ver): New rule.
	* config/t-gnu-prefix: New file.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	gcc/
	* tree-ssa-sccvn.c (copy_reference_ops_from_ref): Support
	FIXED_CST.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	gcc/
	* final.c (output_addr_const): Print fixed-point constants as
	decimal not hex (avoiding an assembler overflow warning for
	negative byte constants).

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2011-08-01  Julian Brown  <julian@codesourcery.com>

	gcc/
	* optabs.c (prepare_cmp_insn): Use correct biasing for
	fixed-point comparison helpers.

2011-09-01  Julian Brown  <julian@codesourcery.com>

	Issue #11863

	gcc/testsuite/
	* gcc.target/arm/div64-unwinding.c: New test.

2011-09-01  Nathan Sidwell  <nathan@codesourcery.com>

	Port from sgxx 4.5:

	2011-07-08  Kwok Cheung Yeung  <kcy@codesourcery.com>
	Issue #6223
	Issue #6234
	Issue #9116

	gcc/
	* config/m68k/m68k-devices.def: Add 51ag, 51je and 51mm.
	* doc/invoke.texi (M680x0 Options): Document.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from netlogic-4_6 branch:

	2011-01-03  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* reorg.c
	(steal_delay_list_from_target): Check JUMP_LABELs for returns.
	Use simplejump_or_return_p.
	(fill_simple_delay_slots): Likewise.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from netlogic-4_6 branch:

	2011-05-18  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* tree-pass.h (pass_cprop_hardreg2): Declare.
	* passes.c (init_optimization_passes): Move first cprop pass before
	thread_prologue_and_epilogue_insns, add the second in the original
	place of the first.
	* regcprop.c: Include "dce.h".
	(gate_handle_cprop): Allow only if HAVE_simple_return.
	(gate_handle_cprop2): New function.
	(early_cprop_hardregs_forward): New function.
	(pass_cprop_hardreg2): New.
	* function.c (prepare_shrink_wrap): Also stop search when we see
	another set of the destination reg.
	* Makefile.in (regcprop.o): Update dependencies.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from netlogic-4_6 branch:

	2011-05-18  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* function.c (prepare_shrink_wrap): Also stop search when we see
	another set of the destination reg.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from netlogic-4_6 branch:

	2010-01-26  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* reorg.c (update_label_uses): Handle case that JUMP_LABEL (insn) is not
	a label.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from netlogic-4_6 branch:

	2011-05-16  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* config/mips/xlp.md: New pipeline description (from NetLogic).
	* config/mips/mips.md (processor): Add "xlp".
	(include "xlp.md"): New include.
	* config/mips/mips.c (mips_cpu_info_table, mips_rtx_cost_data):
	Add entries for NetLogic XLP.
	* config/mips/mips.h (MIPS_ISA_LEVEL_SPEC): Handle XLP.

	2011-08-02  Maxim Kuvyrkov  <maxim@codesourcery.com>
	XLP tuning from NetLogic.
	gcc/
	* config/mips/mips.c (mips_cpu_info, mips_rtx_cost_data): Update.
	(mips_issue_rate, mips_multipass_dfa_lookahead): Handle XLP.
	* config/mips/mips.h (TUNE_XLP): Define.
	(MIPS_ISA_LEVEL_OPTION_SPEC): Update.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from CodeBench 4.5 / netlogic-4_6 branch:

	2011-xx-xx  Bernd Scmidt  <bernds@codesourcery.com>
	gcc/
	* function.c (record_hard_reg_uses, record_hard_reg_uses_1): New static
	functions.
	(requires_stack_frame_p): New arg prologue_used.
	(thread_prologue_and_epilogue_insns): Compute the set of registers
	used in the prologue, and pass it to requires_stack_frame_p.

	gcc/
	* function.c (thread_prologue_and_epilogue_insns): Emit information
	about shrink wrapping in the dump file.

	gcc/testsuite/
	* gcc.target/i386/sw-1.c: New test.

	gcc/
	* function.c (record_hard_reg_uses_1, requires_stack_frame_p)
	(thread_prologue_and_epilogue_insns): Correct previous commit.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from CodeBench 4.5 / netlogic-4_6 branch:

	2011-xx-xx  Bernd Scmidt  <bernds@codesourcery.com>
	gcc/
	(bb_active_p): New function.
	* function.c (prepare_shrink_wrap): New function.
	(thread_prologue_and_epilogue_insns): Call prepare_shrink_wrap, and
	use bb_active_p to recompute the last_bb_active flag.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from CodeBench 4.5 / netlogic-4_6 branch:

	2011-xx-xx  Bernd Scmidt  <bernds@codesourcery.com>
	gcc/
	* doc/tm.texi (RETURN_ADDR_REGNUM): Document.
	* doc/md.texi (simple_return): Document pattern.
	(return): Add a sentence to clarify.
	* doc/rtl.texi (simple_return): Document.
	* doc/invoke.texi (Optimize Options): Document -fshrink-wrap.
	* common.opt (fshrink-wrap): New.
	* opts.c (default_options_table): Enable it for -O1 and above.
	* gengenrtl.c (special_rtx): SIMPLE_RETURN is special.
	* rtl.h (ANY_RETURN_P): New macro.
	(global_rtl_index): Add GR_SIMPLE_RETURN.
	(simple_return_rtx): New macro.
	* genemit.c (gen_exp): SIMPLE_RETURN has a unique rtx.
	(gen_expand, gen_split): Use ANY_RETURN_P.
	* rtl.c (copy_rtx): SIMPLE_RETURN is shared.
	* emit-rtl.c (verify_rtx_sharing): Likewise.
	(skip_consecutive_labels): Return the argument if it is a return rtx.
	(classify_insn): Handle both kinds of return.
	(init_emit_regs): Create global rtl for ret_rtx and simple_return_rtx.
	* df-scan.c (df_uses_record): Handle SIMPLE_RETURN.
	* rtl.def (SIMPLE_RETURN): New.
	* rtlanal.c (tablejump_p): Check JUMP_LABEL for returns.
	* final.c (final_scan_insn): Recognize both kinds of return.
	* reorg.c (function_return_label, function_simple_return_label): New
	static variables.
	(end_of_function_label): Remove.
	(simplejump_or_return_p): New static function.
	(find_end_label): Add a new arg, KIND.  All callers changed.
	Depending on KIND, look for a label suitable for return or
	simple_return.
	(make_return_insns): Make corresponding changes.
	(get_jump_flags): Check JUMP_LABELs for returns.
	(follow_jumps): Likewise.
	(get_branch_condition): Check target for return patterns rather
	than NULL.
	(own_thread_p): Likewise for thread.
	(steal_delay_list_from_target): Check JUMP_LABELs for returns.
	Use simplejump_or_return_p.
	(fill_simple_delay_slots): Likewise.
	(optimize_skip): Likewise.
	(fill_slots_from_thread): Likewise.
	(relax_delay_slots): Likewise.
	(dbr_schedule): Adjust handling of end_of_function_label for the
	two new variables.
	* ifcvt.c (find_if_case_1): Take care when redirecting jumps to the
	exit block.
	(dead_or_predicable): Change NEW_DEST arg to DEST_EDGE.  All callers
	changed.  Ensure that the right label is passed to redirect_jump.
	* jump.c (condjump_p, condjump_in_parallel_p, any_condjump_p,
	returnjump_p): Handle SIMPLE_RETURNs.
	(delete_related_insns): Check JUMP_LABEL for returns.
	(redirect_target): New static function.
	(redirect_exp_1): Use it.  Handle any kind of return rtx as a label
	rather than interpreting NULL as a return.
	(redirect_jump_1): Assert that nlabel is not NULL.
	(redirect_jump): Likewise.
	(redirect_jump_2): Handle any kind of return rtx as a label rather
	than interpreting NULL as a return.
	* dwarf2out.c (compute_barrier_args_size_1): Check JUMP_LABEL for
	returns.
	* function.c (emit_return_into_block): Remove useless declaration.
	(record_hard_reg_sets, frame_required_for_rtx, gen_return_pattern,
	requires_stack_frame_p): New static functions.
	(emit_return_into_block): New arg SIMPLE_P.  All callers changed.
	Generate either kind of return pattern and update the JUMP_LABEL.
	(thread_prologue_and_epilogue_insns): Implement a form of
	shrink-wrapping.  Ensure JUMP_LABELs for return insns are set.
	* print-rtl.c (print_rtx): Handle returns in JUMP_LABELs.
	* cfglayout.c (fixup_reorder_chain): Ensure JUMP_LABELs for returns
	remain correct.
	* resource.c (find_dead_or_set_registers): Check JUMP_LABELs for
	returns.
	(mark_target_live_regs): Don't pass a return rtx to next_active_insn.
	* basic-block.h (force_nonfallthru_and_redirect): Declare.
	* sched-vis.c (print_pattern): Add case for SIMPLE_RETURN.
	* cfgrtl.c (force_nonfallthru_and_redirect): No longer static.  New arg
	JUMP_LABEL.  All callers changed.  Use the label when generating
	return insns.

	* config/i386/i386.md (returns, return_str, return_cond): New
	code_iterator and corresponding code_attrs.
	(<return_str>return): Renamed from return and adapted.
	(<return_str>return_internal): Likewise for return_internal.
	(<return_str>return_internal_long): Likewise for return_internal_long.
	(<return_str>return_pop_internal): Likewise for return_pop_internal.
	(<return_str>return_indirect_internal): Likewise for
	return_indirect_internal.
	* config/i386/i386.c (ix86_expand_epilogue): Expand a simple_return as
	the last insn.
	(ix86_pad_returns): Handle both kinds of return rtx.
	* config/arm/arm.c (use_simple_return_p): new function.
	(is_jump_table): Handle returns in JUMP_LABELs.
	(output_return_instruction): New arg SIMPLE.  All callers changed.
	Use it to determine which kind of return to generate.
	(arm_final_prescan_insn): Handle both kinds of return.
	* config/arm/arm.md (returns, return_str, return_simple_p,
	return_cond): New code_iterator and corresponding code_attrs.
	(<return_str>return): Renamed from return and adapted.
	(arm_<return_str>return): Renamed from arm_return and adapted.
	(cond_<return_str>return): Renamed from cond_return and adapted.
	(cond_<return_str>return_inverted): Renamed from cond_return_inverted
	and adapted.
	* config/arm/thumb2.md (thumb2_<return_str>return): Renamed from
	thumb2_return and adapted.
	* config/arm/arm.h (RETURN_ADDR_REGNUM): Define.
	* config/arm/arm-protos.h (use_simple_return_p): Declare.
	(output_return_instruction): Adjust declaration.
	* config/mips/mips.c (mips_expand_epilogue): Generate a simple_return
	as final insn.
	* config/mips/mips.md (simple_return): New expander.
	(*simple_return, simple_return_internal): New patterns.
	* config/sh/sh.c (barrier_align): Handle return in a JUMP_LABEL.
	(split_branches): Don't pass a null label to redirect_jump.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from CodeBench 4.5 / netlogic-4_6 branch:

	2011-xx-xx  Bernd Scmidt  <bernds@codesourcery.com>
	gcc/
	* gengenrtl.c (special_rtx): PC, CC0 and RETURN are special.
	* genemit.c (gen_exp): Handle RETURN.
	* emit-rtl.c (verify_rtx_sharing): Likewise.
	(init_emit_regs): Create pc_rtx, ret_rtx and cc0_rtx specially.
	* rtl.c (copy_rtx): RETURN is shared.
	* rtl.h (enum global_rtl_index): Add GR_RETURN.
	(ret_rtx): New.
	* jump.c (redirect_exp_1): Don't use gen_rtx_RETURN.
	* config/s390/s390.c (s390_emit_epilogue): Likewise.
	* config/rx/rx.c (gen_rx_rtsd_vector): Likewise.
	* config/cris/cris.c (cris_expand_return): Likewise.
	* config/m68k/m68k.c (m68k_expand_epilogue): Likewise.
	* config/rs6000/rs6000.c (rs6000_make_savres_rtx,
	rs6000_emit_epilogue, rs6000_output_mi_thunk): Likewise.
	* config/picochip/picochip.c (picochip_expand_epilogue): Likewise.
	* config/h8300/h8300.c (h8300_push_pop, h8300_expand_epilogue):
	Likewise.
	* config/v850/v850.c (expand_epilogue): Likewise.
	* config/bfin/bfin.c (bfin_expand_call): Likewise.
	* config/arm/arm.md (epilogue): Likewise.
	* config/sparc/sparc.c (sparc_struct_value_rtx): Rename ret_rtx
	variable to ret_reg.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from CodeBench 4.5 / netlogic-4_6 branch:

	2011-05-16  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* ifcvt.c (cond_exec_process_insns): Disallow converting a block
	that contains the prologue.
	gcc/testsuite/
	* gcc.c-torture/compile/20110322-1.c: New test.

2011-08-31  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Update merged patch to what checked in upstream and merge
	the following follow up patch.

	2011-04-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
 		Eric Botcazou <ebotcazou@adacore.com>

	* combine.c (combine_simplify_rtx): Avoid mis-simplifying conditionals
	for STORE_FLAG_VALUE==-1 case.

2011-08-31  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from SG++ 4.5/backport from mainline:

	2011-07-13  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #11564

	* release-notes-csl.xml (Map file name demangling bug fix):
	New note.

	gcc/
	* configure.ac (demangler_in_ld): Default to yes.
	* configure: Regenerated.
	* collect2.c (main): When HAVE_LD_DEMANGLE is defined, don't mess with
	COLLECT_NO_DEMANGLE, and just pass --demangle and --no-demangle options
	straight through to ld.  When HAVE_LD_DEMANGLE is not defined, set
	COLLECT_NO_DEMANGLE in a way that has the intended effect on Windows.

	2011-07-24  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	Backport from mainline:

	2011-07-24  H.J. Lu  <hongjiu.lu@intel.com>

	PR bootstrap/49835
	* collect2.c (demangle_flag): Removed.

2011-08-31  Meador Inge  <meadori@codesourcery.com>

	Issue #12083 - Merge from Sourcery G++ 4.5

	gcc/
	* config/rs6000/t-cs-eabi
	(MULTILIB_OPTIONS): Add 'mno-powerpc-gfxopt'.
	(MULTILIB_DIRNAMES): Add 'nogfxopt'.
	(MULTILIB_EXCEPTIONS): Add new exceptions for 'mno-power-gfxopt'.
	(MULTILIB_MATCHES): Added 'mcpu=' matches for CPUs that do *not*
	support the PowerPC Graphics instructions.
	* config/rs6000/t-cs-eabi-lite
	(MULTILIB_OPTIONS): Add 'mno-powerpc-gfxopt'.
	(MULTILIB_DIRNAMES): Add 'nogfxopt'.
	(MULTILIB_EXCEPTIONS): Add new exceptions for 'mno-power-gfxopt'.
	(MULTILIB_MATCHES): Added 'mcpu=' matches for CPUs that do *not*
	support the PowerPC Graphics instructions.

2011-08-31  Nathan Sidwell  <nathan@codesourcery.com>

	Merge from Sourcery G++ 4.5:
 
	2009-10-06  Paul Brook  <paul@codesourcery.com>
	Issue #3869
        gcc/
	* target.def (TARGET_WARN_FUNC_RESULT): Define hook.
	* doc/tm.texi.in (TARGET_WARN_FUNC_RESULT): New hook.
	* doc/tm.texi: Rebuilt.
	* tree-cfg.h (execute_warn_function_return): Use
	targetm.warn_func_result.
	* config/arm/arm.c (TARGET_WARN_FUNC_RESULT): Define hook.
	(arm_warn_func_result): New function.

	gcc/testsuite/
	 * gcc.target/arm/naked-3.c: New test.

2011-08-31  Nathan Sidwell  <nathan@codesourcery.com>

	# Issue 10472
	gcc/testsuite/
	* gcc.target/arm/tlscall.c: New.

2011-08-31  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #12073

	Backport from mainline:
	2011-05-04  Bernd Schmidt  <bernds@codesourcery.com>

	PR rtl-optimization/47612
	* df-problems.c (can_move_insns_across): Don't pick a cc0 setter
	as the last insn of the sequence to be moved.

2011-08-30  Joseph Myers  <joseph@codesourcery.com>

	Issue #11864

	Merge from SG++ 4.5:

	2009-07-01  Joseph Myers  <joseph@codesourcery.com>

	Issue #4168

	gcc/
	* gcc.c (using_libgcc, executing_linker): New.
	(execute): Check that libgcc.a exists in the multilib directory
	when linking.
	(process_command): Set using_libgcc to 0 for -nodefaultlibs,
	-nostdlib and -B options.
	(main): Set executing_linker when processing spec that may run the
	linker.

2011-08-30  Joseph Myers  <joseph@codesourcery.com>

	Issue #11859

	gcc/
	* gcc.c (do_self_spec): Don't set license_checked here.
	(driver_handle_option): Set it here for TARGET_FLEXLM instead.

2011-08-29  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Port delay slot improvements from Sourcery CodeBench GCC 4.5:

	2010-11-20  Tom de Vries  <tom@codesourcery.com>
	gcc/
        * reorg.c (has_opposite_duplicate): New function.
	* reorg.c (steal_delay_list_from_target, fill_slots_from_thread): Use
        new function.
	* reorg.c (steal_delay_list_from_target): Allow stealing from delay slot
        of return jump.
	* reorg.c (steal_delay_list_from_target): Add other_thread and
        own_opposite_thread function parameters.
        * reorg.c (fill_slots_from_thread): Additional function arguments for
        steal_delay_list_from_target.
        * reorg.c (fill_slots_from_thread): Add own_opposite_thread function
        parameter.
        * reorg.c (fill_simple_delay_slots, fill_eager_delay_slots): Additional
        function argument for fill_slots_from_thread.

	2010-11-25  Tom de Vries  <tom@codesourcery.com>
	* release-notes-csl.xml: Add delay slot filling release note.

	2010-12-13  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* hooks.c (hook_int_void_0): New function.
	* target.h (struct gcc_target): New substruct target_align with field
	align_insns.
	* final.c (shorten_branches, final_scan_insn): Handle label in delay
	slot.
	* reorg.c (emit_delay_sequence, delete_from_delay_slot)
	(try_merge_delay_insns, fill_simple_delay_slots, fill_eager_delay_slots)
	* reorg.c (delay_list_has_label): New function.
	* reorg.c (fill_slots_from_thread): Detect when label in delay slot is
	safe and insert it.
	* reorg.c (relax_delay_slots): Remove unused labels in delay slots.
	* emit-rtl.c (verify_rtl_sharing): Handle label in delay slot.
	* cfglayout.c (reemit_insn_block_notes): Handle label in delay slot.
	* target-def.h (TARGET_ALIGN_INSNS, TARGET_ALIGN_HOOKS): Add define.
	* target-def.h (TARGET_INITIALIZER): Use TARGET_ALIGN_HOOKS.
	* config/mips/mips.md (define_peephole2): Add peephole to convert
	zero_extend into and.
	* config/mips/mips.c (mips_align_insns): New function.
	* config/mips/mips.c (TARGET_ALIGN_INSNS): Redefine as mips_align_insns.
	* doc/tm.texi (TARGET_ALIGN_INSNS): Add deftypefn.

	gcc/
	* hooks.h (hook_int_void_0): Add prototype.

	2010-12-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* reorg.c (fill_eager_delay_slots): Recompute own_target,
	fallthrough_insn and own_fallthrough when required.

	2011-01-12  Tom de Vries  <tom@codesourcery.com
	gcc/
	* reorg.c (fill_slots_from_thread): Fix handling of
	targetm.target_align.align_insns == 0.

	2011-01-12  Tom de Vries  <tom@codesourcery.com
	Issue #10308
	gcc/
	* config/mips/mips.c (mips_align_insns): Disable label in delay slot.

	2011-02-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* resource.c (struct target_info): Add label field.
	* resource.c (find_basic_block): New parameter label.
	* resource.c (find_basic_block): Set label.
	* resource.c (get_block): New function.
	* resource.c (mark_target_live_regs): Use get_block.
	* resource.c (mark_target_live_regs, clear_hashed_info_for_insn): Pass
	extra argument to find_basic_block.
	* resource.c (mark_target_live_regs): Set label field.

	2011-02-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* reorg.c (redundant_insn): Add missing incr_ticks_for_insn.

	2011-02-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* reorg.c (update_label_uses): New function.

	2011-02-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* reorg.c (fill_slots_from_thread): Add update_block call for
	duplicate.
	* reorg.c (fill_slots_from_thread): Add update_label_uses calls around
	delete_related_insns call.
	* reorg.c (fill_slots_from_thread): Replace delete_related_insns (label)
	with remove_insn and setting of INSN_DELETED_P.
	* reorg.c (fill_slots_from_thread): Use duplicate rather than trial in
	delay slot.
	* reorg.c (fill_slots_from_thread): Remove ineffective copy of label.

	2011-02-15  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* config/mips/mips.c (mips_align_insns): Re-enable label in delay slot.

2011-08-28  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge MODE_INDEX_REG_CLASS from Sourcery CodeBench 4.5:

	2007-02-16  Richard Sandiford  <richard@codesourcery.com>
	gcc/
	* Makefile.in (postreload.o): Depend on addresses.h.
	* addresses.h (index_reg_class, ok_for_index_p_1): New functions.
	(regno_ok_for_index_p): New function.
	* postreload.c: Include addresses.h.
	(reload_combine): Use index_reg_class instead of INDEX_REG_CLASS.
	* ira-costs.c (ok_for_index_p_nonstrict): Add a mode argument.
	Use ok_for_index_p_1 instead of REGNO_OK_FOR_INDEX_P.
	(record_address_regs): Use index_reg_class instead of INDEX_REG_CLASS.
	Update calls to ok_for_index_p_nonstrict.
	* regrename.c (scan_rtx_address): Use regno_ok_for_index_p instead of
	REGNO_OK_FOR_INDEX_P and index_reg_class instead of INDEX_REG_CLASS.
	(replace_oldest_value_addr): Likewise.
	* reload.c (find_reloads_address): Use index_reg_class instead
	of INDEX_REG_CLASS.  Do not push an index register reload if
	index_reg_class returns NO_REGS.
	(find_reloads_address_1): Use index_reg_class instead
	of INDEX_REG_CLASS and regno_ok_for_index_p instead of
	REGNO_OK_FOR_INDEX_P.
	* doc/tm.texi (MODE_INDEX_REG_CLASS): Document new macro.
	(REGNO_MODE_OK_FOR_INDEX_P): Likewise.

	2010-07-23  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* regcprop.c (replace_oldest_value_addr): Use regno_ok_for_index_p.

	2011-08-29  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* doc/tm.texi.in: Update.

2011-08-28  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Enable ColdFire multilibs for GNU/Linux

	gcc/
	* config/m68k/t-linux (M68K_MLIB_CPU): Add ColdFire CPUs.

2011-08-27  Tom de Vries  <tom@codesourcery.com>

	gcc/
	Port from NetLogic branch:
	2011-05-16  Maxim Kuvyrkov  <maxim@codesourcery.com>
	Port from Sourcery CodeBench GCC 4.5:

	2011-02-25  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* tree-ssa-loop-ivopts.c (may_eliminate_iv): Fix boundary checks.
	* testsuite/gcc.dg/tree-ssa/ivopts-max.c: New test.

	2011-02-25  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* tree-ssa-loop-ivopts.c (struct cost_pair): Add comp field.
	(set_use_iv_cost): Add comp parameter.
	(set_use_iv_cost): Use comp parameter to init comp field.
	(determine_use_iv_cost_generic, determine_use_iv_cost_address)
	(determine_use_iv_cost_condition): Add comp argument to set_use_iv_cost
	call.
	(may_eliminate_iv): Add comp parameter and set.
	(determine_use_iv_cost_condition): Add comp argument to may_eliminate_iv
	call.
	(determine_use_iv_cost_condition): Reset comp if too expensive.
	(rewrite_use_compare): Use compare from comp field of cp.

	2011-02-25  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* tree-ssa-loop-ivopts.c (fold_build_plus): New function factored out of
	add_autoinc_candidates.
	(add_autoinc_candidates): Use fold_build_plus.

	2011-02-25  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* tree-ssa-loop-ivopts.c (niter_for_exit): Return COND_EXPR if
	!integer_zerop (desc->may_be_zero).
	(cand_valid_pointer_at_use_p, get_lt_bound, iv_elimination_compare_lt):
	New function.
	(may_eliminate_iv): Use iv_elimination_compare_lt.

	2011-03-25  Tom de Vries  <tom@codesourcery.com>
	* release-notes-csl.xml (Improved loop optimizer): New note.
	gcc/
	* tree-ssa-loop-ivopts.c (struct ivopts_data): New field
	loop_single_exit_p.
	(robust_plus, fold_plus, fold_diff_to_ssa_name): New function.
	(fold_build_plus): Use robust_plus.
	(cand_valid_pointer_at_use_p, get_lt_bound): Remove function.
	(get_use_lt_bound): New function.
	(iv_elimination_compare_lt): Use get_use_lt_bound.  Use
	fold_diff_to_ssa_name.  Add detailed comment.  Handle loop test that
	exits loop if true.  Fix incorrect handling of positive and negative
	step.  Allow only equal step to be handled.  Handle LE_EXPR exit tests.
	Only allow source level pointer iterator.  Check if loop bound is
	reached.
	(may_eliminate_iv): Remove superfluous tests for TYPE_OVERFLOW_WRAPS.
	(may_eliminate_iv): Restructure code realted to call to
	iv_elimination_compare_lt and add comment.
	(tree_ssa_iv_optimize_loop): Always compute single_dom_exit (loop).
	Init data->loop_single_exit_p.

2011-08-25  Julian Brown  <julian@codesourcery.com>

	Issue #11885, #10448

	Merge from Linaro GCC 4.5:

	Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* emit-rtl.c (immed_double_const): Allow wider than
	2*HOST_BITS_PER_WIDE_INT mode constants when they are
	representable as a single const_int RTX.

	gcc/testsuite/
	* gcc.target/arm/pr48183.c: New test.

2011-08-23  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* config/mips/linux.h (SUBTARGET_OVERRODE_OPTIONS):
	Correct merge error; use OPTION_UCLIBC rather than linux_uclibc.

	gcc/
	Port from Netlogic branch:
	2011-05-19  Tom de Vries  <tom@codesourcery.com>
	Port from Sourcery CodeBench GCC 4.5:

	2010-10-20  Tom de Vries  <tom@codesourcery.com>
	gcc/
	* config/mips/constraints.md (YE): New constraint.
	* config/mips/mips-ftypes.def (MIPS_SI_FTYPE_VPOINTER_SI)
	(MIPS_DI_FTYPE_VPOINTER_DI, MIPS_SI_FTYPE_VPOINTER_SI_SI)
	(MIPS_DI_FTYPE_VPOINTER_DI_DI):	New function type.
	* config/mips/mips.md (UNSPEC_COMPARE_AND_SWAP_ACQ)
	(UNSPEC_COMPARE_AND_SWAP_REL, UNSPEC_SWAP_ACQ, UNSPEC_SWAP_REL): New
        UNSPEC constant.
        * config/mips/mips.md (sync_cmp, sync_acquire_barrier)
        (sync_atomic_insn): New attribute.
        * config/mips/mips.md (sync_insn1): Add new value 'neg' to attribute.
	* config/mips/sync.md (sync_add<mode>, sync_sub<mode>)
	(sync_old_add<mode>, sync_old_sub<mode>, sync_new_add<mode>)
	(sync_new_sub<mode>, sync_lock_test_and_set<mode>):
	Change define_insn into define_expand.
	* config/mips/sync.md (sync_add_ll_sc<mode>, sync_add_ldadd<mode>)
	(sync_sub_ll_sc<mode>, sync_sub_ldadd<mode>, sync_old_add_ll_sc<mode>)
	(sync_old_add_ldadd<mode>, sync_old_sub_ll_sc<mode>)
	(sync_old_sub_ldadd<mode>, sync_new_add_ll_sc, gen_sync_new_sub_ll_sc)
	(mips_swap_ll_sc<mode>, mips_swap<mode>)
        (mips_val_compare_and_swap<d>_acq, mips_val_compare_and_swap<d>_rel)
        (mips_bool_compare_and_swap<d>_acq, mips_bool_compare_and_swap<d>_rel)
        (mips_swap<d>_acq, (mips_swap<d>_rel): New define_insn.
	* config/mips/mips-protos.h (mips_output_atomic): New prototype.
	* config/mips/mips.c (MIPS_BUILTIN_ATOMIC): New	builtin type.
	* config/mips/mips.c (mips_print_operand): New format identifier 'b'.
        * config/mips/mips.c (mips_sync_insn1_template): Handle neg.
        * config/mips/mips.c (mips_process_sync_loop): Handle sync_cmp, don't
        emit sync for xlp.
        * config/mips/mips.c (mips_sync_loop_insns): Handle atomic insns.
	* config/mips/mips.c (mips_builtin_avail_swap)
	(mips_builtin_avail_swapd, mips_builtin_avail_ll_sc)
	(mips_builtin_avail_lld_scd): New function.
	* config/mips/mips.c (ATOMIC_BUILTIN): New define.
	* config/mips/mips.c (__builtin_mips_swap_acq)
	(__builtin_mips_swap_rel, __builtin_mips_swapd_acq)
	(__builtin_mips_swapd_rel, __builtin_mips_val_compare_and_swap_acq)
	(__builtin_mips_val_compare_and_swap_rel)
	(__builtin_mips_val_compare_and_swapd_acq)
	(__builtin_mips_val_compare_and_swapd_rel)
	(__builtin_mips_bool_compare_and_swap_acq)
	(__builtin_mips_bool_compare_and_swap_rel)
	(__builtin_mips_bool_compare_and_swapd_acq)
	(__builtin_mips_bool_compare_and_swapd_rel): Declare builtin.
	* config/mips/mips.c (mips_build_vpointer_type): New function.
	* config/mips/mips.c (MIPS_ATYPE_VPOINTER): New define.
	* config/mips/mips.c (mips_expand_builtin_atomic): New function.
	* config/mips/mips.c (mips_expand_builtin): Handle
	MIPS_BUILTIN_ATOMIC using mips_expand_builtin_atomic.
	* config/mips/mips.c (mips_process_atomic, mips_output_atomic): New
	function.
	* config/mips/mips.h (TARGET_XLR, TARGET_XLP, GENERATE_SWAP)
        (GENERATE_LDADD): New define.
	* testsuite/gcc.target/mips/sync.c: New file.

	* config/mips/mips.md (enum "processor"): Add xlp.

2011-08-23  Julian Brown  <julian@codesourcery.com>

	* gcc/config/arm/nocrt0.h: Add missing file (from ARM multilib
	settings).

2011-08-04  Julian Brown  <julian@codesourcery.com>

	Revert:

	Merge from Sourcery G++ 4.5:

	Mark Mitchell  <mark@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Mark Shinwell  <shinwell@codesourcery.com>
	Vladimir Prus  <vladimir@codesourcery.com>
	Paul Brook  <paul@codesourcery.com>

	gcc/
	* config.gcc (arm-wrs-linux-gnueabi, i586-wrs-linux-gnu,
	mips-wrs-linux-gnu, powerpc-wrs-linux-gnu):
	Handle new targets.
	* config/arm/t-wrs-linux, config/arm/wrs-linux.h,
	config/i386/t-wrs-linux, config/i386/wrs-linux.h,
	config/i386/wrs-linux.opt, config/mips/t-wrs-linux,
	config/mips/wrs-linux.h, config/rs6000/t-wrs-linux,
	config/rs6000/wrs-linux.h: New.
	* config/mips/t-octeon-elf (MULTILIB_OPTIONS, MULTILIB_DIRNAMES,
	MULTILIB_EXCEPTIONS): Add Octeon II multilibs.

2011-08-04  Julian Brown  <julian@codesourcery.com>

	Revert:

	Merge from Sourcery G++ 4.5:	

	2009-05-15  Joseph Myers  <joseph@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	NOT ASSIGNED TO FSF
	COPYRIGHT CAVIUM
	gcc/
	* config/mips/octeon-elf-unwind.h, config/mips/octeon-elf.h,
	config/mips/octeon.h, config/mips/t-octeon-elf: New.
	* config.gcc: Handle mips64octeon*-wrs-elf*.
	(mips-wrs-linux-gnu): Use mips/octeon.h.
	* config/mips/mips-protos.h (octeon_output_shared_variable): New.
	* config/mips/mips.c (octeon_handle_cvmx_shared_attribute,
	octeon_select_section, octeon_unique_section,
	octeon_output_shared_variable): New.
	(mips_attribute_table): Add cvmx_shared.
	(mips_in_small_data_p): Check for cvmx_shared attribute.
	libgcc/
	* config.host: Handle mips64octeon*-wrs-elf*.

2011-08-04  Julian Brown  <julian@codesourcery.com>

	Revert:

	Merge from Sourcery G++ 4.5:

	Kazu Hirata  <kazu@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-linux*): Handle enable_extra_asa_multilibs.
	* config/arm/t-asa: New.

2011-08-04  Nathan Sidwell  <nathan@codesourcery.com>

	Merge from Sourcery G++ 4.5
	
	Issue #8915, 10472
	gcc/
	* doc/invoke.texi (ARM Options): Document -mtls-dialect option.
	* doc/install.texi (with-tls): Document.
	* config.gcc (arm*-*-linux*): Default with_tls.
	(with_tls): New.
	* config/arm/arm.c (target_tls_dialect): New.
	(enum tls_reloc): Add TLS_DESCSEQ.
	(arm_override_options): Process target_tls_dialect_switch value.
	(arm_call_tls_get_addr): Clean up.
	(arm_cannot_copy_insn_p): Check for tlscall.
	(arm_tls_descseq_addr): New.
	(legitimize_tls_address): Add tlsdesc support.
	(arm_emit_tls_decoration): Likewise.
	* config/arm/arm.h (TARGET_ARM_TLS, TARGET_GNU_TLS): New.
	(enum arm_tls_type): New.
	(target_tls_dialect): New.
	(OPTION_DEFAULT_SPECS): Add tls-dialect.
	* config/arm/arm.opt (mtls-dialect): New switch.
	* config/arm/arm.md (R1_REGNUM): New.
	(tlscall): New.

	gcc/testsuite/
	* gcc.target/arm/tlscall.c: New.

2011-08-02  Nathan Sidwell  <nathan@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-07-09  Sandra Loosemore  <sandra@codesourcery.com>
		    Mark Shinwell  <shinwell@codesourcery.com>
		    Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* doc/invoke.texi (-falign-arrays): Document.
	* function.h (alignment_for_aligned_arrays): Declare.
	* function.c (get_stack_local_alignment): Use it.
	(alignment_for_aligned_arrays): Define.
	* cfgexpand.c (get_decl_align_unit): Use it here, too.
	* common.opt (-falign-arrays): New.
	* varasm.c (assemble_variable): Use alignment_for_aligned_arrays,
	and use it irrespective of whether DATA_ALIGNMENT is defined.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	2010-06-12  Jie Zhang  <jie@codesourcery.com>

	gcc/
	* config/arm/vfp.md (arm_movsi_vfp): Set neon_type correctly
	for neon_ldr and neon_str instructions.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Jie Zhang  <jie@codesourcery.com>

	Issue #7122

	gcc/
	* config/arm/vfp.md (movdf_vfp): Add load double 0.0 case.
	(thumb2_movdf_vfp): Likewise. Require that one of the operands be a
	register.
	* config/arm/constraints.md (D0): New constraint.
	
	gcc/testsuite/
	* gcc.target/arm/neon-load-df0.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Mark Shinwell  <shinwell@codesourcery.com>

	gcc/
	* config/arm/vfp.md (*arm_movsi_vfp, *thumb2_movsi_vfp)
	(*arm_movdi_vfp, *thumb2_movdi_vfp, *movsf_vfp, *thumb2_movsf_vfp)
	(*movdf_vfp, *thumb2_movdf_vfp, *movsfcc_vfp, *thumb2_movsfcc_vfp)
	(*movdfcc_vfp, *thumb2_movdfcc_vfp): Add neon_type.
	* config/arm/arm.md (neon_type): Update comment.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	gcc/
	* config/mips/mips-protos.h (mips_dspalu_bypass_p): Add prototype.
	* config/mips/mips.c (dspalu_bypass_table): New.
	(mips_dspalu_bypass_p): New.
	* config/mips/mips.md (dspmac, dspmacsat, accext, accmod, dspalu)
	(dspalusat): Add insn types.
	* config/mips/mips-dsp.md (add<DSPV:mode>3)
	(mips_add<DSP:dspfmt1>_s_<DSP:dspfmt2>)
	(sub<DSPV:mode>3, mips_sub<DSP:dspfmt1>_s_<DSP:dspfmt2>, mips_addsc)
	(mips_addwc, mips_modsub, mips_raddu_w_qb, mips_absq_s_<DSPQ:dspfmt2>)
	(mips_precrq_qb_ph, mips_precrq_ph_w, mips_precrq_rs_ph_w)
	(mips_precrqu_s_qb_ph, mips_preceq_w_phl, mips_preceq_w_phr)
	(mips_precequ_ph_qbl, mips_precequ_ph_qbr, mips_precequ_ph_qbla)
	(mips_precequ_ph_qbra, mips_preceu_ph_qbl, mips_preceu_ph_qbr)
	(mips_preceu_ph_qbla, mips_preceu_ph_qbra, mips_shll_<DSPV:dspfmt2>)
	(mips_shll_s_<DSPQ:dspfmt2>, mips_shll_s_<DSPQ:dspfmt2>, mips_shrl_qb)
	(mips_shra_ph, mips_shra_r_<DSPQ:dspfmt2>, mips_bitrev, mips_insv)
	(mips_repl_qb, mips_repl_ph, mips_cmp<DSPV:dspfmt1_1>_eq_<DSPV:dspfmt2>)
	(mips_cmp<DSPV:dspfmt1_1>_lt_<DSPV:dspfmt2>)
	(mips_cmp<DSPV:dspfmt1_1>_le_<DSPV:dspfmt2>, mips_cmpgu_eq_qb)
	(mips_cmpgu_lt_qb, mips_cmpgu_le_qb, mips_pick_<DSPV:dspfmt2>)
	(mips_packrl_ph, mips_wrdsp, mips_rddsp): Change type to dspalu.
	(mips_dpau_h_qbl, mips_dpau_h_qbr, mips_dpsu_h_qbl, mips_dpsu_h_qbr)
	(mips_dpaq_s_w_ph, mips_dpsq_s_w_ph, mips_mulsaq_s_w_ph)
	(mips_maq_s_w_phl, mips_maq_s_w_phr, mips_maq_sa_w_phr): Set type to
	dspmac.
	(mips_dpaq_sa_l_w, mips_dpsq_sa_l_w, mips_maq_sa_w_phl): Set type to
	dspmacsat.
	(mips_extr_w, mips_extr_r_w, mips_extr_rs_w, mips_extp, mips_extpdp):
	Set type to accext.
	(mips_shilo, mips_mthlip): Set type to accmod.
	* config/mips/mips-dspr2.md (mips_absq_s_qb, mips_addu_s_ph)
	(mips_adduh_r_qb): Set type to dspalusat.
	(mips_addu_ph, mips_adduh_qb, mips_append, mips_balign)
	(mips_cmpgdu_eq_qb, mips_cmpgdu_lt_qb, mips_cmpgdu_le_qb)
	(mips_precr_qb_ph, mips_precr_sra_ph_w, mips_precr_sra_r_ph_w)
	(mips_prepend, mips_shra_qb, mips_shra_r_qb, mips_shrl_ph)
	(mips_subu_ph, mips_subuh_qb, mips_subuh_r_qb, mips_addqh_ph)
	(mips_addqh_r_ph, mips_addqh_w, mips_addqh_r_w, mips_subqh_ph)
	(mips_subqh_r_ph, mips_subqh_w, mips_subqh_r_w): Set type to dspalu.
	(mips_dpa_w_ph, mips_dps_w_ph, mips_mulsa_w_ph, mips_dpax_w_ph)
	(mips_dpsx_w_ph, mips_dpaqx_s_w_ph, mips_dpsqx_s_w_ph): Set type to
	dspmac.
	(mips_subu_s_ph): Set type to dspalusat.
	(mips_dpaqx_sa_w_ph, mips_dpsqx_sa_w_ph): Set type to dspmacsat.

	Merge from MIPS:

	2007-11-06  David Ung  <davidu@mips.com>

	gcc/
	* config/mips/mips.h (AC1HI_REGNUM, AC1LO_REGNUM, AC2HI_REGNUM)
	(AC2LO_REGNUM, AC3HI_REGNUM, AC3LO_REGNUM): Define constants.

	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/mips/74k.md: (r74k_dsp_alu, r74k_dsp_alu_sat, r74k_dsp_mac)
	(r74k_dsp_mac_sat, r74k_dsp_acc_ext, r74k_dsp_acc_mod): New insn
	reservations.
	(r74k_dsp_mac, r74k_dsp_mac_sat, r74k_int_mult, r74k_int_mul3)
	(r74k_dsp_mac, r74k_dsp_mac_sat): New bypasses.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Julian Brown  <julian@codesourcery.com>

	Issue #11669

	gcc/
	* config/mips/mips.md (MIPS16_T_REGNUM): New constant.
	(tablejump): Don't use for MIPS16_SHORT_JUMP_TABLES.
	(casesi): New.
	(casesi_internal_mips16): New.
	* config/mips/mips.h (TARGET_MIPS16_SHORT_JUMP_TABLES): Update
	comment.
	(CASE_VECTOR_MODE): Use ptr_mode unconditionally.
	(CASE_VECTOR_SHORTEN_MODE): Define.
	(ASM_OUTPUT_ADDR_DIFF_ELT): Output word-sized addr_diff_elts when
	necessary for MIPS16_SHORT_JUMP_TABLES.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-06-27  Paul Brook  <paul@codesourcery.com>

	gcc/
	* except.c (switch_to_exception_section): Place tables for
	DECL_ONE_ONLY functions in comdat groups.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-eabi* | arm*-*-nucleuseabi* |
	arm*-*-symbianelf*): Handle --enable-extra-brewmp-multilibs.
	* config/arm/t-brewmp-eabi: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-06-16  Catherine Moore  <clm@codesourcery.com>

	Issue #11516

	gcc/
	* config/mips/mips.h (BASE_DRIVER_SELF_SPECS): -m14ke*
	implies -mdspr2.
	* config/mips/mips.c (mips_cpu_info_table): Add m14ke and -m14kec.
	* doc/invoke.texi: Document.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Maciej W. Rozycki  <macro@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_local_function_p): Also reject weak
	and linkonce definitions.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Maciej W. Rozycki  <macro@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_local_alias): Use
	LOCAL_LABEL_PREFIX for the symbol generated.
	(mips16_build_function_stub): Declare stub once-only if target
	function is likewise.
	(mips16_build_call_stub): Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-05-23  Mark Mitchell <mark@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_build_function_stub): New argument alias.
	(mips16_build_function_stub_and_local_alias): New function.
	(mips_output_function_prologue):  Call
	mips16_build_function_stub_and_local_alias if TARGET_HARD_FLOAT_ABI
	and either a floating-point return value or floating-pointe arguments.

	gcc/testsuite/
	* gcc.target/mips/mips.exp: Add interlink-mips16 to mips_option_groups.
	* gcc.target/mips/mips16-fn-local.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-05  Paul Brook  <paul@cpodesourcery.com>

	gcc/
	* config/arm/arm-cores.def: Add cortex-r5.
	* config/arm/arm-tune.md: Regenerate.
	* config/arm/arm.c (FL_DIV): Rename...
	(FL_THUMB_DIV): ... to this.
	(FL_ARM_DIV): Define.
	(FL_FOR_ARCH7R, FL_FOR_ARCH7M): Use FL_THUMB_DIV.
	(arm_arch_hwdiv): Remove.
	(arm_arch_thumb_hwdiv, arm_arch_arm_hwdiv): New variables.
	(arm_option_override): Set arm_arch_thumb_hwdiv, arm_arch_arm_hwdiv
	instead of arm_arch_hwdiv.
	(thumb2_size_rtx_costs): Use TARGET_IDIV.
	(arm_issue_rate): Add cortexr5.
	* config/arm/arm.h (TARGET_CPU_CPP_BUILTINS): Set
	__ARM_ARCH_EXT_IDIV__.
	(TARGET_IDIV): Define.
	(arm_arch_hwdiv): Remove.
	(arm_arch_arm_hwdiv, arm_arch_thumb_hwdiv): New prototypes.
	* config/arm/arm.md (tune_cortexr4): Add cortexr5.
	(divsi3, udivsi3): New patterns.
	* config/arm/thumb2.md (divsi3, udivsi3): Remove.
	* doc/invoke.texi: Document ARM -mcpu=cortex-r5

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-03-28  Paul Brook  <paul@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #3772
	gcc/
	* final.c (notice_source_line): Ignore zero length instructions.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10413
	gcc/
	* config/rs6000/rs6000.h (EXTRA_SPECS): Add cc1_float.
	(host_detect_local_float): Declare.
	(EXTRA_SPEC_FUNCTIONS): Add local_float_detect.
	(HAVE_LOCAL_FLOAT_DETECT): Define as necessary.
	(CC1_FLOAT_SPEC): Define.
	* config/rs6000/driver-rs6000.c: #include asm/cputable.h.
	(platform, hard_float, auxv_read): New static vars.
	(elf_auxv): New.  Cache auxv values.
	(elf_platform): Use elf_auxv.
	(elf_float): New.
	(host_detect_local_float): New.
	* config/rs6000/sysv4.h (CC1_SPEC): Add cc1_float.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10459
	gcc/
	* config.gcc (powerpc-*): Allow native for with-cpu.
	* config/rs6000/apm-linux.h (DRIVER_SELF_SPECS): Set for native builds.

	Issue #10413
	gcc/
	* config/rs6000/apm-linux.h (DRIVER_SELF_SPECS): Remove.
	* config/rs6000/rs6000.c (rs6000_option_override_internal)
	(rs6000_file_start): Ignore "native" default cpu.
	* config/rs6000/driver-rs6000.c (elf_platform): Strip leading
	'ppc' from cpu name.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Bernd Schmidt  <bernds@codesourcery.com>
	Nathan Sidwell  <nathan@codesourcery.com>

	gcc/
	* config.gcc (powerpc-apm-linux): New sub-target.
	* config/rs6000/apm-linux.h: New.
	* config/rs6000/t-apm-linux: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Mark Mitchell  <mark@codesourcery.com>

	Issue #7581
	libstdc++-v3/
	* acinclude.m4 (GLIBCXX_WITH_CSLIBC): Define it.
	* configure.ac (GLIBCXX_WITH_CSLIBC): Use it.
	* configure: Regenerated.
	* libsupcc+/Makefile.am (sources): Do not add pure.cc if building
	for CSLIBC.
	* libsupc++/Makefile.in: Regenerated.

        Issue #9394
	libstdc++-v3/
	* acinclude.m4 (GLIBCXX_WITH_CSLIBC): Define _GLIBCXX_CSLIBC in
	config.h.
	* configure: Regenerated.
	* config.h.in: Likewise.
	* libsupc++/Makefile.am (sources): Add recursive_init_error.cc.
	* libsupc++/Makefile.in: Regenerated.
	* libsupc++/guard.cc (throw_recursive_init_exception): Do not throw an
	exception when building for CSLIBC.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Froyd  <froydnj@codesourcery.com>
	Tom de Vries  <tom@codesourcery.com>

	Issue #8708

	gcc/
	* config/rs6000/rs6000-protos.h (altivec_resolve_overloaded_builtin):
	Delete.
	(rs6000_resolve_overloaded_builtin): Declare.
	* config/rs6000/rs6000-c.c (altivec_resolve_overloaded_builtin): Make
	static.
	(isel_arguments_valid): New function.
	(rs6000_resolve_isel_builtin): New function.
	(rs6000_resolve_overloaded_builtin): New function.
	* config/rs6000/rs6000-builtin.def: Declare isel builtins.
	* config/rs6000/rs6000.h (struct isel_builtin_desc): Declare.
	(builtin_iselw, builtin_iseld): Likewise.
	* config/rs6000/rs6000.c (rs6000_init_builtins): Initialize isel
	builtins.
	(rs6000_expand_builtins): Try to expand isel builtins.
	(ISEL_Pmode): Define.
	(ISEL_BASE, ISEL_P_RESULT, ISEL_S_RESULT, ISEL_U_RESULT): Define.
	(ISEL_EXPAND_ARG, ISEL_PTR_ARG, ISEL_SIGNED_ARG, ISEL_UNSIGNED_ARG):
	Define.
	(ISEL_EQ, ISEL_LT, ISEL_GT, ISEL_LTU, ISEL_GTU): Define.
	(builtin_iselw, builtin_iseld): Define.
	(isel_cmp_mode, isel_sel_mode, isel_argtype): New functions.
	(isel_strdesc): New function.
	(rs6000_init_isel_builtins): New function.
	(rs6000_expand_isel_builtin): New function.
	* doc/extend.texi (PowerPC AltiVec/VSX Builtin-in Functions): Document
	__builtin_isel functions.

	gcc/testsuite/
	* gcc.target/powerpc/builtin-isel.h: New file.
	* gcc.target/powerpc/builtin-isel.c: New test.
	* gcc.target/powerpc/builtin-isel-errors.c: New test.
	* gcc.target/powerpc/builtin-isel64.c: New test.
	* gcc.target/powerpc/builtin-isel64-errors.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c: New file.
	* tree-pass.h (pass_ee): Declare.
	* opts.c (default_options_table): Turn on extension elimination at -O2.
	* timevar.def (TV_EE): New timevar.
	* common.opt (fextension-elimination): New option.
	* Makefile.in (OBJS-common): Add ee.o.
	(ee.o): New rule.
	* passes.c (pass_ee): Add it.
	
	gcc/testsuite/
	* gcc.dg/extend-1.c: New test.
	* gcc.dg/extend-2.c: New test.
	* gcc.dg/extend-2-64.c: New test.
	* gcc.dg/extend-3.c: New test.
	* gcc.dg/extend-4.c: New test.
	* gcc.target/mips/octeon-bbit-2.c: Make test more robust.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-09-08  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* emit-rtl.c (set_mem_attributes_minus_bitpos): Set MEM_READONLY_P
	for static const strings.
	
	gcc/testsuite/
	* gcc.dg/memcpy-3.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-06-15  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* config/mips/t-netlogic: Define NetLogic multilibs.
	* config.gcc (mips64-nelogic-linux-gnu): New target.

	2010-07-20  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* config.gcc (mips64*-*-linux*): Make O32 the default ABI for NetLogic
	target.
	* config/mips/netlogic.h: New file, make O32 the default ABI for
	NetLogic target.
	* config/mips/t-netlogic: Update.

	2010-08-17 Catherine Moore  <clm@codesourcery.com>
        gcc/
        * config/mips/netlogic.h (SUBTARGET_CC1_SPEC): New.

	2010-09-01  Tom de Vries  <tom@codesourcery.com>
	Issue #9098
	gcc/
	* config/mips/netlogic.h: Set -funwind-tables by default.
	* config/mips/t-netlogic: Set -fno-unwind-tables for CRTSTUFF.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon-testgen.ml (regexps): Allow any characters
	in comments after assembly instructions.

	gcc/testsuite/
	* gcc.target/arm/neon/vfp-shift-a2t2.c: Allow any characters in
	comments after assembly instructions.
	* gcc.target/arm/neon/v*.c: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Julian Brown  <julian@codesourcery.com>

	libstdc++-v3/
	* python/Makefile.am (install-data-local): Only define rule if
	GLIBCXX_HOSTED.
	* python/Makefile.in: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/Warray-bounds-3.c: Add -fno-unroll-loops for ARM.
	* lib/target-supports.exp (check_vect_support_and_set_flags):
	Likewise, for all vect tests.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Julian Brown  <julian@codesourcery.com>

	Issue #6223

	gcc/
	* config/arm/arm.c (arm_vector_alignment_reachable): Don't use
	peeling for alignment for NEON.

	gcc/testsuite/
	* lib/target-supports.exp
	(check_effective_target_vector_alignment_reachable): Not true for
	ARM NEON.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-05-11  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* cfgrtl.c (try_redirect_by_replacing_jump): Treat EXIT_BLOCK_PTR case
	separately before call to redirect_jump(). Add assertion.
	(patch_jump_insn): Same.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-01-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/mips.md (define_peephole2): Add 2 new peepholes.
	
	gcc/testsuite/
	* gcc.target/mips/switch-peephole2.c: Add test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-12-13  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-if-switch-conversion.c: New pass.
	* tree-pass.h (pass_if_to_switch): Declare.
	* common.opt (ftree-if-to-switch-conversion): New switch.
	* opts.c (decode_options): Set flag_tree_if_to_switch_conversion at -O2
	and higher.
	* passes.c (init_optimization_passes): Use new pass.
	* params.def (PARAM_IF_TO_SWITCH_THRESHOLD): New param.
	* doc/invoke.texi (-ftree-if-to-switch-conversion)
	(if-to-switch-threshold): New item.
	(Optimization Options, option -O2): Add -ftree-if-to-switch-conversion.
	* Makefile.in (OBJS-common): Add tree-if-switch-conversion.o.
	(tree-if-switch-conversion.o): New rule.
	* stmt.c (emit_case_bit_tests): Change prototype.
	(struct  case_bit_test): 
	(struct case_bit_test): Add rev_hi, rev_lo and prob fields.
	(emit_case_bit_test_jump): New function.
	(rtx_seq_cost): New function.
	(choose_case_bit_test_expand_method): New function.
	(get_label_prob): New function.
	(set_jump_prob): New function.
	(set_bit): New function.
	(emit_case_bit_tests): Use get_label_prob. Set and update rev_hi and
	rev_lo fields. Set prob field. Use set_bit. Use set_jump_prob. Use
	choose_case_bit_test_expand_method. Use emit_case_bit_test_jump.
	(expand_case): Add new args to emit_case_bit_tests invocation.
	
	gcc/testsuite/
	* gcc.dg/switch-bittest.c: New test.
	* gcc.dg/switch-prob.c: Add test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* libfuncs.h (enum libfunc_index): Add LTO_profile_call_entry,
	LTI_profile_call_inside, LTI_profile_call_exit.
	(profile_call_entry_libfunc, profile_call_inside_libfunc): Define.
	(profile_call_exit_libfunc): Define.
	* optabs.c (init_optabs): Initialize them.
	* builtins.c (is_inexpensive_builtin): Add BUILT_IN_VA_START.
	* builtins.def (BUILT_IN_PROFILE_CALL_ENTER): Define.
	(BUILT_IN_PROFILE_CALL_INSIDE, BUILT_IN_PROFILE_CALL_EXIT): Define.
	* gimplify.c (fndecl_for_call_instrumentation): New function.
	(maybe_add_profile_call): New function.
	(replace_body_for_instrumentation): New function.
	(gimplify_call_expr): Call maybe_add_profile_call.
	(gimplify_modify_expr): Likewise.
	(gimplify_function_tree): Likewise.
	* common.opt (finstrument-function-calls): New option.
	* doc/invoke.texi: Document it.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-21  Catherine Moore  <clm@codesourcery.com>

	Issue #10594
 
	* config/mips/mips.opt (mfix-24k): New.
	* config/mips/mips.h (ASM_SPEC): Handle -mfix-24k.
	* config/mips/mips.md (length): Increase by 4 for stores if
	fixing 24K errata.
	* config/mips/mips.c (mips_reorg_process_insns): Do not allow
	all noreorder if fixing 24K errata.
	* doc/invoke.texi: Document mfix-24k.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-19  Catherine Moore  <clm@codesourcery.com>

	Issue #10598

	gcc/
	* config/mips/mips.h (ADJUST_REG_ALLOC_ORDER): Delete.
	* config/mips/mips.c (mips_order_regs_for_local_alloc): Delete.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-04  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config/arm/arm-cores.def (cortex-m0, cortex-m1): Change arch to 6SM.
	* config/arm/arm-t-softfp (softfp_wrap_start): Include ARMv6S-M.
	* config/arm/elf.h: Ditto.
	* config/arm/libunwind.S: Ditto.
	* config/arm/lib1funcs.asm: Ditto.
	(__thumb1_only): Define and use.
	* config/arm/arm.c (FL_FOR_ARCH6SM): Define.
	(all_architectures): Add armv6s-m.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.target/arm/pr43698.c: Remove -march option.
	* gcc.target/arm/sync-1.c: Limit to sync_int_long, do not use
	-march option.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-03-23  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/46934
	gcc/
	* config/arm/arm.md (casesi): Use the gen_int_mode() function
	to subtract lower bound instead of GEN_INT().

	gcc/testsuite/
	* gcc.target/arm/pr46934.c: New.

	2011-03-17  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/43872
	gcc/
	* config/arm/arm.c (arm_get_frame_offsets): Adjust early
	return condition with !cfun->calls_alloca.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	Issue #10917

	gcc/
	* expr.c (expand_expr_real_1): Only use BLKmode for volatile
	accesses which are not naturally aligned.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-11  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #9845
	* release-notes-csl.xml (Internal compiler error with pointer casting):
	New note.

	gcc/
	* config/arm/arm.h (ARM_LEGITIMIZE_RELOAD_ADDRESS): Do not handle
	when DImode address has unaligned index under TARGET_NEON.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/testsuite/
	* gcc/testsuite/gcc.dg/lto/20090210_0.c: Require tls_runtime target.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-01-27  Pat Wellander  <pwelland@codesourcery.com>

	Issue #9850

	gcc/
	* config/rs6000/rs6000.h (LOCAL_ALIGNMENT): Altivec local
	arrays >= 16 bytes are now aligned to at least 16 bytes.

	gcc/testsuite/
	* gcc.target/powerpc/altivec-34.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2011-04-06  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #10935
	PR target/44557

	gcc/
	* config/arm/arm.h (PREFERRED_RELOAD_CLASS): Add CORE_REGS to
	Thumb-1 return LO_REGS case.
	* config/arm/arm.md (reload_inhi): Change scratch constraint
	from 'r' to 'l'.

	gcc/testsuite/
	* gcc.target/arm/pr44557.c: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Sidwell  <nathan@codesourcery.com>

	libgcc/
	* config.host (powerpc-*-elf): Add t-ppccomm & t-spe-fprules, if
	necessary.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips16.S (DELAYf): Alias to DELAYt for the MIPS IV
	ISA and up.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.h (ISA_HAS_FP4): Don't restrict ISA_MIPS32R2
	to TARGET_FLOAT64.
	(ISA_HAS_NMADD4_NMSUB4): Remove the MODE argument; don't restrict
	ISA_MIPS32R2.
	(ISA_HAS_NMADD3_NMSUB3): Remove the MODE argument.
	* config/mips/mips.c (mips_rtx_costs): Update according to
	changes to ISA_HAS_NMADD4_NMSUB4 and ISA_HAS_NMADD3_NMSUB3.
	* config/mips/mips.md (nmadd4<mode>, nmadd3<mode>): Likewise.
	(nmadd4<mode>_fastmath, nmadd3<mode>_fastmath): Likewise.
	(nmsub4<mode>, nmsub3<mode>): Likewise.
	(nmsub4<mode>_fastmath, nmsub3<mode>_fastmath): Likewise.
	* doc/invoke.texi (MIPS Options): Update documentation of the
	floating-point multiply-accumulate instruction restrictions.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10861

	gcc/
	* config/rs6000/e500mc.h (SETUP_FRAME_ADDRESSES): Remove, in line
	with merged fix for upstream PR target/45807.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #10166

	gcc/
	* config/mips/linux64.h (LINK_SPEC): Use compatible linker emulation
	for -mabi=64 -msym32.

	gcc/testsuite/
	* gcc.target/mips/mips-nonpic/main-msym32-mplt-1.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Issue #10483

	gcc/
	Backport from mainline:

	2011-03-22  Eric Botcazou  <ebotcazou@adacore.com>

        * combine.c (simplify_set): Try harder to find the best CC mode when
        simplifying a nested COMPARE on the RHS.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/tree-ssa/20040204-1.c: Add arm*-*-* to targets expected
	not to fail scan.
	* gcc.dg/vect/vect-16.c: Do not expect arm*-*-* to fail scan.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10762
	gcc/
	* config/mips/cs-sgxxlite-linux.h (SUBTARGET_CC1_SPEC): Override.
	* config/mips/cs-sgxx-linux.h (SUBTARGET_CC1_SPEC): Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-06-03  Julian Brown  <julian@codesourcery.com>

	* config/arm/arm-cores.def (strongarm, strongarm110, strongarm1100)
	(strongarm1110): Use strongarm tuning.
	* config/arm/arm-protos.h (tune_params): Add max_insns_skipped field.
	* config/arm/arm.c (arm_strongarm_tune): New.
	(arm_slowmul_tune, arm_fastmul_tune, arm_xscale_tune, arm_9e_tune)
	(arm_v6t2_tune, arm_cortex_tune, arm_cortex_a5_tune)
	(arm_cortex_a9_tune, arm_fa726te_tune): Add max_insns_skipped field
	setting, using previous defaults or 1 for Cortex-A5.
	(arm_option_override): Set max_insns_skipped from current tuning.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-06-02  Julian Brown  <julian@codesourcery.com>

	* config/arm/arm-cores.def (cortex-a5): Use cortex_a5 tuning.
	* config/arm/arm.c (arm_cortex_a5_branch_cost): New.
	(arm_cortex_a5_tune): New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-06-02  Julian Brown  <julian@codesourcery.com>

	* config/arm/arm-protos.h (tune_params): Add branch_cost hook.
	* config/arm/arm.c (arm_default_branch_cost): New.
	(arm_slowmul_tune, arm_fastmul_tune, arm_xscale_tune, arm_9e_tune)
	(arm_v6t2_tune, arm_cortex_tune, arm_cortex_a9_tune)
	(arm_fa726_tune): Set branch_cost field using
	arm_default_branch_cost.
	* config/arm/arm.h (BRANCH_COST): Use branch_cost hook from
	current_tune structure.
	* dojump.c (tm_p.h): Include file.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-06-02  Julian Brown  <julian@codesourcery.com>

	* config/arm/arm-cores.def (arm1156t2-s, arm1156t2f-s): Use v6t2
	tuning.
	(cortex-a5, cortex-a8, cortex-a15, cortex-r4, cortex-r4f, cortex-m4)
	(cortex-m3, cortex-m1, cortex-m0): Use cortex tuning.
	* config/arm/arm-protos.h (tune_params): Add prefer_constant_pool
	field.
	* config/arm/arm.c (arm_slowmul_tune, arm_fastmul_tune)
	(arm_xscale_tune, arm_9e_tune, arm_cortex_a9_tune)
	(arm_fa726te_tune): Add prefer_constant_pool setting.
	(arm_v6t2_tune, arm_cortex_tune): New.
	* config/arm/arm.h (TARGET_USE_MOVT): Make dependent on
	prefer_constant_pool setting.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10439
	gcc/
	* config/arm/unwind-arm.c (enum __cxa_type_match_result): New.
	(cxa_type_match): Correct declaration.
	(__gnu_unwind_pr_common): Reconstruct
	additional indirection when __cxa_type_match returns
	succeeded_with_ptr_to_base.

	libstdc++/
	* libsupc++/eh_arm.c (__cxa_type_match): Construct address of
	thrown object here.  Return succeded_with_ptr_to_base for all
	pointer cases.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/testsuite/
	* gcc.target/mips/call-1.c: Accept JALRS too where JALR would do.
	* gcc.target/mips/call-2.c: Likewise.
	* gcc.target/mips/call-3.c: Likewise.
	* gcc.target/mips/lazy-binding-1.c: Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10377

	gcc/
	* config/sh/sh.c (expand_cbranchdi4): Preserve copied op2h for
	reuse.

	testsuite/
	* gcc.target/sh/crash-1.c: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10339

	gcc/
	* config/sparc/sparc.c (sparc_struct_value_rtx): Rename ret_rtx to
	ret_reg to avoid collision with new macro.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Bernd Schmidt  <bernd@codesourcery.com>

	Issue #10089

	gcc/
	* expr.c (store_field): Avoid a direct store if the mode is larger
	than the size of the bit field.
	* stor-layout.c (layout_decl): If flag_strict_volatile_bitfields,
	treat non-volatile bit fields like volatile ones.
	* toplev.c (process_options): Disallow combination of
	-fstrict-volatile-bitfields and ABI versions less than 2.
	* config/arm/arm.c (arm_option_override): Don't enable
	flag_strict_volatile_bitfields if the ABI version is less than 2.
	* config/h8300/h8300.c (h8300_option_override): Likewise.
	* config/rx/rx.c (rx_option_override): Likewise.
	* config/m32c/m32c.c (m32c_option_override): Likewise.
	* config/sh/sh.c (sh_option_override): Likewise.

	gcc/testsuite/
	* gcc.target/arm/volatile-bitfields-4.c: New test.
	* c-c++-common/abi-bf.c: New test.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* combine.c (subst, combine_simlify_rtx): Add new argument, use it
	to track processing of conditionals.  Update all callers.
	(try_combine, simplify_if_then_else): Update.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-07-08  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon.md (vec_shr_<mode>, vec_shl_<mode>): Disable in
	big-endian mode.
	(reduc_splus_<mode>, reduc_uplus_<mode>, reduc_smin_<mode>)
	(reduc_smax_<mode>, reduc_umin_<mode>, reduc_umax_<mode>)
	(neon_vec_unpack<US>_lo_<mode>, neon_vec_unpack<US>_hi_<mode>)
	(vec_unpack<US>_hi_<mode>, vec_unpack<US>_lo_<mode>)
	(neon_vec_<US>mult_lo_<mode>, vec_widen_<US>mult_lo_<mode>)
	(neon_vec_<US>mult_hi_<mode>, vec_widen_<US>mult_hi_<mode>)
	(vec_pack_trunc_<mode>, neon_vec_pack_trunc_<mode>): Disable for Q
	registers in big-endian mode.

	gcc/testsuite/
	* lib/target-supports.exp
	(check_effective_target_arm_little_endian): New.
	(check_effective_target_vect_pack_trunc): Use above.
	(check_effective_target_vect_unpack): Likewise.
	(check_effective_target_vect_element_align): Test
	check_effective_target_arm_vect_no_misalign for ARM.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Jie Zhang  <jie@codesourcery.com>

	* config/arm/arm.c (arm_override_options): Disable
	-fsched-interblock for Cortex-M4.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-08-23  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config/i386/i386elf.h (ENDFILE_SPEC): Add crtn.o.
	(STARTFILE_SPEC): Remove crt0.o. Add crti.o.
	* config/i386/t-i386elf: Build crti.o and crtn.o.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Issue #5256

	libstdc++-v3/

	Merge from WRS Linux 4.4:

	2010-05-18  Joseph Myers  <joseph@codesourcery.com>
	Issue #5256
	Issue #5834
	* config/locale/gnu/c_locale.cc,
	config/locale/gnu/monetary_members.cc,
	config/locale/gnu/numeric_members.cc,
	config/locale/gnu/time_members.cc, src/codecvt.cc, src/ctype.cc,
	src/locale-inst.cc, src/wlocale-inst.cc: Add aliases for generic
	locale symbol names.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* config/m68k/m68k.c (m68k_sched_variable_issue): Handle
	-fsched-pressure.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-09-09  Catherine Moore  <clm@codesourery.com>

        gcc/
        * config/mips/xlr.md (ir_xlr_alu_clz): New insn_reservation.
        (ir_xlr_alu): Remove clz.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Kazu Hirata  <kazu@codesourcery.com>

	Issue #8579
	libiberty/
	* pex-win32.c (pex_win32_exec_child): Move calls to _close() to
	the end of the function.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-09-01  Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* config/sh/sh.h (SH_ASM_SPEC): Add spaces between options.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Backport of patch posted here:
	http://gcc.gnu.org/ml/gcc-patches/2010-08/msg01462.html

	2010-08-19  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* Makefile.in: (mode-switching.o): Depend on integrate.h.
	* doc/md.texi (Standard Pattern Names For Generation):
	Document use_initial_val.
	* integrate.c (initial_value_pair): Add new member "initialized".
	(get_hard_reg_initial_val): Set initialized.
	(emit_initial_value_sets): Emit result of gen_use_initial_val.
	* mode-switching.c: Include integrate.h.
	(rest_of_handle_mode_switching): Call emit_initial_value_sets.

2011-07-28  Julian Brown  <julian@codesourcery.com>

        Merge from Sourcery G++ 4.5:

        2010-08-20  Catherine Moore  <clm@codesourcery.com>

        Issue #9258

        gcc/
        * config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Add 34kn.
        * config/mips/mips.c (mips_cpu_info): Likewise.
        * config/mips/mips.h (MIPS_ARCH_FLOAT_SPEC): Likewise.
        (BASE_DRIVER_SELF_SPECS): Do not imply -mdsp for the 34kn.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-08-16  Catherine Moore  <clm@codesourcery.com>

        gcc/
        * config/mips/mips.c (mips_cpu_info): Set tune_flags for
        the XLR processor to PTF_AVOID_BRANCH_LIKELY.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Issue #9186 - Contents test failure for Python scripts.

	libstdc++-v3/
	* python/Makefile.am (pythondir): Use $(tooldir)/share.
	* python/Makefile.in: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

        Merge from Sourcery G++ 4.5:

        Daniel Jacobowitz  <dan@codesourcery.com>
	Andrew Stubbs  <ams@codesourcery.com>

        gcc/testsuite/
        * gcc.dg/vect/vect-shift-2.c (stdio.h): Include if TRACE.
	* gcc.dg/vect/vect-shift-3.c: New.
        * lib/target-supports.exp (check_effective_target_vect_shift_char): New
        function.
	* gcc.dg/vect/vect-shift-4.c: New file.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Kazu Hirata  <kazu@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-linux*): Handle enable_extra_asa_multilibs.
	* config/arm/t-asa: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5, not suitable for upstream:

	2009-05-12  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* common.opt (feglibc): New dummy option.
	* opts.c (common_handle_option): Handle it.
	* config.gcc: Handle 'eglibc' vendor.
	* config/t-eglibc: Define multilibs for testing EGLIBC features.
	* configure.ac (--with-eglibc-configs, EGLICB_CONFIGS): New option and
	variable.
	* configure: Regenerate.
	* Makefile.in (EGLIBC_CONFIGS): Handle

2011-07-28  Julian Brown  <julian@codesourcery.com>

        Merge from Sourcery G++ 4.5:

        * gcc/config/mips/linux.h (SUBTARGET_OVERRIDE_OPTIONS):
        Disable thread support for uclibc.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO THE FSF
	COPYRIGHT FREESCALE

	gcc/
	* config/rs6000/rs6000.mc (floatdidf2): Use for PROCESSOR_PPCE500MC64.
	(fix_truncdfdi2): Likewise.

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/rs6000.c
	(rs6000_override_options) [processor_target_table]: Add e5500 entry.

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO THE FSF
	COPYRIGHT FREESCALE

	gcc/
	* config/rs6000/rs6000.c (expand_block_clear): Permit non-word-aligned
	stores for PROCESSOR_PPCE500MC64.
	(expand_block_move): Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	gcc/
	* config.gcc (powerpc*-*-*): Add e5500 as a valid 64-bit cpu name.
	* config/rs6000/rs6000.h (ASM_CPU_SPEC): Add mcpu=e5500 case.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Sidwell  <nathan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	* libtool.m4 (nucleus*): Add shared library logic, deplibs check
	method.
	* configure.ac: Handle arm*-*-nucleuseabi.
	* configure: Regenerate.

	gcc/
	* config.gcc: Handle arm*-*-nucleuseabi*.
	* config/arm/nucleus.h: New.
	* config/arm/t-cs-nucleuseabi: New.
	* config/arm/unwind-arm.h (_Unwind_decode_target2): Target2 on
	nucleus-shared is the same as linux.

	libgcc/
	* config.host: Handle arm*-*-nucleuseabi*.

	libstdc++-v3/
	* config/os/nucleus/arm-eabi-extra.ver: New.
	* configure.host (arm*-*-nucleauseabi): Add arm-eabi-extra.ver.
	* configure: Regenerated.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-04-02  Nathan Froyd  <froydnj@codesourcery.com>
	libgcc/
	* configure.ac: Check for __SPE__ when compiling for powerpc*.
	* configure: Regenerate.
	* config.host: Add t-spe-fprules if compiling for SPE.
	* config/rs6000/spe_adddf3.S: New file.
	* config/rs6000/spe_subdf3.S: New file.
	* config/rs6000/spe_muldf3.S: New file.
	* config/rs6000/spe_divdf3.S: New file.
	* config/rs6000/spe_add_exception.S: New file.
	* config/rs6000/spe_muldiv_scale2.S: New file.
	* config/rs6000/spe_cmpdf2.S: New file.
	* config/rs6000/spe_eqdf2.S: New file.
	* config/rs6000/spe_gedf2.S: New file.
	* config/rs6000/spe_ledf2.S: New file.
	* config/rs6000/spe_unorddf2.S: New file.
	* config/rs6000/spe_unord_sub.S: New file.
	* config/rs6000/fixdfdi.S: New file.
	* config/rs6000/fixdfsi.S: New file.
	* config/rs6000/fixunsdfdi.S: New file.
	* config/rs6000/fixunsdfsi.S: New file.
	* config/rs6000/floatdidf.S: New file.
	* config/rs6000/floatsidf.S: New file.
	* config/rs6000/floatundidf.S: New file.
	* config/rs6000/floatunsidf.S: New file.
	* config/rs6000/extendsfdf2.S: New file.
	* config/rs6000/truncdfsf2.S: New file.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

	2010-05-18  Paul Brook  <paul@codesourcery.com>

	Issue #8426 - Fix libsupc++ symbol visibility
	gcc/
	* config/arm/eabi-memset.c (__aeabi_memset): Remove bogus return value.

	libstdc++-v3/
	* libsupc++/eh_arm.cc (__cxa_type_match): Use correct namespace.
	(__cxa_begin_cleanup): Ditto.
	* libsupc++/unwind-cxx.h (__cxa_call_unexpected, __cxa_call_terminate,
	__cxa_type_match, __cxa_begin_cleanup): Use correct types on ARM EABI.
	* libsupc++/cxxabi.h: Add prototypes for __aeabi routines.
	* libsupc++/eh_personality.cc (PERSONALITY_FUNCTION): Export with
	default visibility.
	* libsupc++/eh_call.cc (__cxa_call_terminate, __cxa_call_unexpected):
	Use correct namespace and types.

	* release-notes-csl.xml: New note.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-06-04  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8426 - build dlls.

	* libtool.m4 (symbian*): Add support for building shared libs.

	gcc/
	* configure: Rebuilt.
	* config.gcc (arm*-*-symbianelf*): Add shared-lib make file
	fragments.
	* config/t-slibgcc-symbian: New.

	libstdc++-v3/
	* configure: Rebuilt.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-05-24  Paul Brook  <paul@codesourcery.com>

	Issue #8426 - Avoid libsupc++ static writable data
	libstdc++-v3/
	* libsupc++/unwind-cxx.h (__get_terminate_handler,
	__get_unexpected_handler): New.
	* libsupc++/eh_throw.cc: Use them.
	* libsupc++/eh_ptr.cc: Ditto.
	* libsupc++/eh_terminate.cc: Ditto.
	* libsupc++/eh_term_handler.cc: Avoid static initializer on SymbianOS.
	* libsupc++/eh_unex_handler.cc: Avoid static initializer on SymbianOS.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

	2009-05-29  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.md (movsi): Don't split symbol refs here.
	(define_split): New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-04-12  Andrew Stubbs  <ams@codesourcery.com>

	Issue #7178

	gcc/
	* config/arm/arm.c (arm_init_libfuncs): Change __gnu_f2h_ieee to
	__aeabi_f2h, __gnu_f2h_alternative to __aeabi_f2h_alt, __gnu_h2f_ieee
	to __aeabi_h2f, and __gnu_h2f_alternative to __aeabi_h2f_alt.
	* config/arm/fp16.c (__gnu_f2h_internal): Change return type to
	unsigned int. Change 'sign' variable likewise.
	(__gnu_h2f_internal): Set to static inline.
	Change return type to unsigned int. Change 'sign' variable likewise.
	(ALIAS): New define.
	(__gnu_f2h_ieee): Change unsigned short to unsigned int.
	(__gnu_h2f_ieee): Likewise.
	(__gnu_f2h_alternative): Likewise.
	(__gnu_h2f_alternative): Likewise.
	(__aeabi_f2h, __aeabi_h2f): New aliases.
	(__aeabi_f2h_alt, __aeabi_h2f_alt): Likewise.
	* config/arm/sfp-machine.h (__extendhfsf2): Set to __aeabi_h2f.
	(__truncsfhf2): Set to __aeabi_f2h.

	gcc/testsuite/
	* g++.dg/ext/arm-fp16/arm-fp16-ops-5.C: Check for __aeabi_h2f
	and __aeabi_f2h.
	* g++.dg/ext/arm-fp16/arm-fp16-ops-6.C: Likewise.
	* gcc.dg/torture/arm-fp16-ops-5.c: Likewise.
	* gcc.dg/torture/arm-fp16-ops-6.c: Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-04-13  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* regmove.c (fixup_match_2): Swap incorrect uses of src and dst.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-02-23  Julian Brown  <julian@codesourcery.com>

	gcc/
	* calls.c (precompute_register_parameters): Avoid generating a
	register move if optimizing for size.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-02-16  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-symbianelf*): Add t-bpabi to t-symbian.
	* config/arm/symbian.h (RENAME_LIBRARY): Remove.
	* config/arm/lib1funcs.asm: Remove __symbian__ conditionals.
	* config/arm/libunwind.S: Ditto.
	* config/arm/t-symbian (LIB1ASMFUNCS): Remove.
	(UNWIND_H, LIB2ADDEH, LIB2ADDEHDEP): Remove.
	(LIB2FUNCS_STATIC_EXTRA): Remove.
	(LIB2FUNCS_EXTRA): Add eabi-memcpy.c and eabi-memset.c.
	* config/arm/eabi-memcpy.c: New file.
	* config/arm/eabi-memset.c: New file.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2011-06-08  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_libcall_uses_aapcs_base): Use correct ABI
	for double-precision helper functions in hard-float mode if only
	single-precision arithmetic is supported in hardware.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Jie Zhang  <jie@codesourcery.com>

	Issue #7122

	gcc/
	* config/arm/arm.c (arm_rtx_costs_1): Adjust cost for
	CONST_VECTOR.
	(arm_size_rtx_costs): Likewise.
	(thumb2_size_rtx_costs): Likewise.
	(neon_valid_immediate): Add a case for double 0.0.

	gcc/testsuite/
	* gcc.target/arm/neon-vdup-1.c: New test case.
	* gcc.target/arm/neon-vdup-2.c: New test case.
	* gcc.target/arm/neon-vdup-3.c: New test case.
	* gcc.target/arm/neon-vdup-4.c: New test case.
	* gcc.target/arm/neon-vdup-5.c: New test case.
	* gcc.target/arm/neon-vdup-6.c: New test case.
	* gcc.target/arm/neon-vdup-7.c: New test case.
	* gcc.target/arm/neon-vdup-8.c: New test case.
	* gcc.target/arm/neon-vdup-9.c: New test case.
	* gcc.target/arm/neon-vdup-10.c: New test case.
	* gcc.target/arm/neon-vdup-11.c: New test case.
	* gcc.target/arm/neon-vdup-12.c: New test case.
	* gcc.target/arm/neon-vdup-13.c: New test case.
	* gcc.target/arm/neon-vdup-14.c: New test case.
	* gcc.target/arm/neon-vdup-15.c: New test case.
	* gcc.target/arm/neon-vdup-16.c: New test case.
	* gcc.target/arm/neon-vdup-17.c: New test case.
	* gcc.target/arm/neon-vdup-18.c: New test case.
	* gcc.target/arm/neon-vdup-19.c: New test case.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:	

	2009-05-15  Joseph Myers  <joseph@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	NOT ASSIGNED TO FSF
	COPYRIGHT CAVIUM
	gcc/
	* config/mips/octeon-elf-unwind.h, config/mips/octeon-elf.h,
	config/mips/octeon.h, config/mips/t-octeon-elf: New.
	* config.gcc: Handle mips64octeon*-wrs-elf*.
	(mips-wrs-linux-gnu): Use mips/octeon.h.
	* config/mips/mips-protos.h (octeon_output_shared_variable): New.
	* config/mips/mips.c (octeon_handle_cvmx_shared_attribute,
	octeon_select_section, octeon_unique_section,
	octeon_output_shared_variable): New.
	(mips_attribute_table): Add cvmx_shared.
	(mips_in_small_data_p): Check for cvmx_shared attribute.
	libgcc/
	* config.host: Handle mips64octeon*-wrs-elf*.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Mark Mitchell  <mark@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Mark Shinwell  <shinwell@codesourcery.com>
	Vladimir Prus  <vladimir@codesourcery.com>
	Paul Brook  <paul@codesourcery.com>

	gcc/
	* config.gcc (arm-wrs-linux-gnueabi, i586-wrs-linux-gnu,
	mips-wrs-linux-gnu, powerpc-wrs-linux-gnu):
	Handle new targets.
	* config/arm/t-wrs-linux, config/arm/wrs-linux.h,
	config/i386/t-wrs-linux, config/i386/wrs-linux.h,
	config/i386/wrs-linux.opt, config/mips/t-wrs-linux,
	config/mips/wrs-linux.h, config/rs6000/t-wrs-linux,
	config/rs6000/wrs-linux.h: New.
	* config/mips/t-octeon-elf (MULTILIB_OPTIONS, MULTILIB_DIRNAMES,
	MULTILIB_EXCEPTIONS): Add Octeon II multilibs.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-02-23  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.c (thumb2_size_rtx_costs): New.
	(arm_rtx_costs): Call above for Thumb-2.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-02-04  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #7197 - backtrace() through throw()

	libstdc++-v3/
	* libsupc++/eh_personality.cc (PERSONALITY_FUNCTION): For
	ARM EABI, skip handlers for _US_VIRTUAL_UNWIND_FRAME
	| _US_FORCE_UNWIND.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-08-26  Julian Brown  <julian@codesourcery.com>

	gcc/config/arm/
	* uclinux-eabi.h (LINK_GCC_C_SEQUENCE_SPEC): Override definition
	for uclinux.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-02-17  Andrew Jenner  <andrew@codesourcery.com>
	            Maciej Rozycki  <macro@codesourcery.com>

	gcc/
	* unwind.inc (_Unwind_RaiseException, _Unwind_ForcedUnwind)
	(_Unwind_Resume, _Unwind_Resume_or_Rethrow, _Unwind_Backtrace): Use
	return value of uw_init_context.
	* unwind-dw2.c (uw_init_context): Make macro an expression instead of
	a statement.
	(uw_init_context_1): Add return value.
	* unwind-sjlj.c (uw_init_context): Add return value.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-07-07  Catherine Moore  <clm@codesourcery.com>
	gcc/testsuite/
	* gcc.target/mips/clear-cache-2.c: Add target checks for
	mips-sde-elf.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-03-17  Julian Brown  <julian@codesourcery.com>
	2009-08-04  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Override, adding
	-mno-float option.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-07-20  Joseph Myers  <joseph@codesourcery.com>

	Issue #5565

	fixincludes/
	* fixincl.tpl (sed_cmd_z): Hardcode to "sed".
	* fixincl.x: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-07-14  Paul Brook  <paul@codesourcery.com>

	Issue #5829

	config/
	* stdint.m4: Avoid pulling in headers when checking basic type sizes.

	libstdc++-v3/
	* configure: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

        2008-07-08  Catherine Moore  <clm@codesourcery.com>
        gcc/testsuite/
        * gcc.dg/torture/type-generic-1.c: Link with floating point
        emulation for target mips-sde-elf.

2011-07-28  Julian Brown  <julian@codesourcery.com>

        Merge from Sourcery G++ 4.5:

        2009-07-01  Catherine Moore  <clm@codesourcery.com>
        gcc/testsuite/
        * gcc.c-torture/execute/ieee/ieee.exp: Link with floating
        point emulation for mips-sde-elf targets.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-07-09  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* config/sh/cs-sgxxlite-linux.h (SUBTARGET_OVERRIDE_OPTIONS): Define.

2011-07-28  Julian Brown  <julian@codesourcery.com>

        Merged from Sourcery G++ 4.5:

        2009-05-28  Julian Brown  <julian@codesourcery.com>

        libgcc/
        * config.host (arm*-*-linux*, arm*-*-uclinux*, arm*-*-eabi*)
        (arm*-*-symbianelf): Add arm/t-divmod-ef to tmake_file.
        * Makefile.in (LIB2_DIVMOD_EXCEPTION_FLAGS): Set to previous
        default if not set by a target-specific Makefile fragment.
        (lib2-divmod-o, lib2-divmod-s-o): Use above.
        * config/arm/t-divmod-ef: New.

        2009-09-02  Daniel Jacobowitz  <dan@codesourcery.com>

        libgcc/
        * shared-object.mk (c_flags-$(base)$(objext)): New.
        ($(base)$(objext)): Use above.
        ($(base)_s$(objext)): Likewise.
        * static-object.mk (c_flags-$(base)$(objext)): New.
        ($(base)$(objext)): Use above.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

        2009-06-10  Catherine Moore  <clm@codesourcery.com>
        Merge from Sourcery G++ 4.3:
        gcc/
        2008-11-23  Richard Sandiford  <rsandiford@googlemail.com>
        * config/mips/mips.c (mips_legitimize_address): Handle
        illegitimate CONST_INT addresses.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Catherine Moore  <clm@codesourcery.com>

	Merge from MIPS:
	2007-11-29  Thiemo Seufer  <ths@mips.com>
	gcc/
	* config/mips/mips.c (mips_option_override): Let -fpic imply
	-mabicalls, forward port from SDE	.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

        Catherine Moore  <clm@codesourcery.com>

	Merge from MIPS:
	2007-12-21  David Ung  <davidu@mips.com>
	gcc/
	* config/mips/mips.h (TARGET_MIPS_SDE): Define macro as 0.
	* config/mips/sde.h (TARGET_MIPS_SDE): Define to 1.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2010-11-03  Paul Brook  <paul@codesourcery.com>

	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>
	
	* config/mips/74k.md (r74k_int_mult, r74k_int_madd): Don't use
	mips_linked_madd_p for bypasses.
	(r74k_int_mul3): Use mips_mult_madd_chain_bypass_p for bypass.
	* config/mips/mips.c (mips_mult_madd_chain_bypass_p): New.
	* config/mips/mips-protos.h (mips_mult_madd_chain_bypass_p): Add
	prototype.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-04-04  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #5104
	PR tree-optimization/39604

	gcc/testsuite
	* g++.dg/tree-ssa/sink-1.C: New.

	gcc/
	* tree-ssa-sink.c (sink_code_in_bb): Do not sink statements out
	of a lexical block containing variable definitions.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2009-06-22  Kazu Hirata  <kazu@codesourcery.com>

	Issue #5105
	gcc/testsuite/
	* gcc.target/m68k/pr36134.c: Use dg-skip-if to skip the testcase
	if there is a conflict with -mcpu=.  Use -mcpu=5208.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	gcc/
	* config/arm/arm.c (arm_option_override): Override alignments if
	tuning for Cortex-A8.
	(create_fix_barrier, arm_reorg): If aligning to jumps or loops,
	make labels have a size.
	* config/arm/arm.md (VUNSPEC_ALIGN16, VUNSPEC_ALIGN32): New constants.
	(align_16, align_32): New patterns.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-09-08  Daniel Jacobowitz  <dan@codesourcery.com>

	gcc/
	* config/arm/unwind-arm.c (__gnu_unwind_pr_common): Correct test
	for barrier handlers.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-02-12  Nathan Sidwell  <nathan@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* config/rs6000/eabi-ci.asm (__init): Add _init func start.
	(__fini): Also declare _fini for newlib.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-08-16  Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* config/rs6000/rs6000.c (rs6000_conditional_register_usage): Mark
	call-saved AltiVec registers call-used if ! TARGET_ALTIVEC_ABI.
	* config/rs6000/rs6000.h (CALL_USED_REGISTERS): Mark the first 20
	AltiVec registers call-used.
	(CALL_REALLY_USED_REGISTERS): Likewise.

	gcc/testsuite/
	* gcc.target/powerpc/altivec-consts.c: Remove -mabi=altivec.
	* gcc.target/powerpc/altivec-varargs-1.c: Likewise.
	* gcc.dg/vmx/vmx.exp: Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-07-02  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/eabi.h (NAME__MAIN, INVOKE__main): Remove.
	* config/rs6000/t-ppccomm (LIB2FUNCS_STATIC_EXTRA): Remove eabi.S.
	(eabi.S): Remove rule.

	2008-10-13  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* doc/invoke.texi (PowerPC Options): -meabi option no longer places
	__eabi function in main.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Julian Brown  <julian@codesourcery.com>
	Mark Shinwell  <mark@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_class_likely_spilled_p): Check against LO_REGS
	only for Thumb-1.
	* config/arm/arm.h (MODE_BASE_REG_CLASS): Restrict base registers to
	those which can be used in short instructions when optimising for size
	on Thumb-2.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-09-19  Vladimir Prus  <vladimir@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_option_override): Disable
	-fmove-loop-invariants. Use very restrictive inlining heuristics.

	gcc/testsuite/
	* gcc.c-torture/execute/bcp-1.x: New.  Don't run bcp-1.c test on arm,
	with -Os.
	* gcc.c-torture/execute/990208-1.x: New.  Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-06-06  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config/arm/arm.h (VALID_IWMMXT_REG_MODE): Allow SImode.
	* config/arm/arm.c (arm_legitimize_reload_address): Reduce range
	allowed for SImode offsets with iWMMXt.
	(arm_hard_regno_mode_ok): Update for change to VALID_IWMMXT_REG_MODE.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-07-05  Mark Shinwell  <shinwell@codesourcery.com>

	gcc/
	* config/arm/arm.h (BRANCH_COST): Set to 1 when optimizing for size
	on Thumb-2.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-02-16  Richard Sandiford  <richard@codesourcery.com>
 	gcc/
	* config/m68k/m68k.h (INDEX_REG_CLASS): Delete in favor of...
	(MODE_INDEX_REG_CLASS): ...this new macro.  Return NO_REGS unless
	MODE_OK_FOR_INDEX_P.
	(MODE_OK_FOR_INDEX_P): New macro.
	(REGNO_OK_FOR_INDEX_P): Delete in favor of...
	(REGNO_MODE_OK_FOR_INDEX_P): ...this new macro.  Return false
	unless MODE_OK_FOR_INDEX_P.
	(REG_OK_FOR_INDEX_P): Delete in favor of...
	(REG_MODE_OK_FOR_INDEX_P): ...this new macro.  Return false
	unless MODE_OK_FOR_INDEX_P.
	* m68k-protos.h (m68k_legitimate_index_reg_p): Add mode argument.
	* m68k.c (m68k_legitimate_index_reg_p, m68k_decompose_index):
	Add mode argument.  Use it.
	* config/m68k/m68k.md (tst<mode>_cf, cmp<mode>_cf, movsf_cf_hard)
	(movdf_cf_hard, extendsfdf2_cf, truncdfsf2_cf, ftrunc<mode>2_cf)
	(add<mode>3_cf, sub<mode>3_cf, fmul<mode>3_cf, div<mode>3_cf)
	(neg<mode>2_cf, sqrt<mode>2_cf, abs<mode>2_cf): Replace "Q<U>"
	constraints for FP addresses with "m" constraints.

	2007-02-16  Nathan Sidwell  <nathan@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/m68k-fp-1.c: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	http://gcc.gnu.org/ml/gcc-patches/2006-03/msg00038.html

	* g++.dg/other/armv7m-1.C: New.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-03-05  Mark Mitchell  <mark@codesourcery.com>
	* configure.in (*-*-vxworks*): Remove target-libstdc++-v3 from
	noconfigdirs.
	* configure: Regenerated.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-03-12  Richard Sandiford  <richard@codesourcery.com>
	gcc/
	* config/vx-common.h (TARGET_FLEXLM): Define.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

 	Mark Mitchell  <mark@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>

	gcc/testsuite/
	* lib/prune.exp (prune_warnings): Extend the default
	implementation to prune linker warnings about libm on Solaris.
	libstdc++-v3/
	* testsuite/lib/prune.exp (prune_g++_output): Prune linker
	warnings about libm on Solaris.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

	Mark Mitchell  <mark@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>

	fixincludes/
	* inclhack.def (solaris_mutex_init_2): Remove precise machine
	checks; look at <sys/types.h> to determine whether fix is
	required.
	(solaris_rwlock_init_1): Likewise.
	(solaris_once_init_2): Likewise.
	* tests/base/sys/types.h: Add output generated by
	solaris_mutex_init_2.
	* fixincl.x: Regenerated.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Issue #1510

	2007-04-27  Paul Brook  <paul@codesourcery.com>
	gcc/
	* cse.c (cse_process_notes): Make sure PLUS are canonical.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2007-03-30  Paul Brook  <paul@codesourcery.com>

	gcc/
	* calls.c (store_one_arg): Check alignment of mode used for save.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Joseph Myers  <joseph@codesourcery.com>
	Paul Brook  <paul@codesourcery.com>
	Daniel Gutson  <dgutson@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>

	gcc/
	* config.gcc: Add ARM multilib configurations.
	* config/arm/nocrt0.h, config/arm/t-cs-eabi,
	config/arm/t-cs-eabi-lite, config/arm/t-cs-linux,
	config/arm/t-cs-linux-lite, config/arm/t-cs-uclinux-eabi: New.
	* config/arm/t-arm-elf (MULTILIB_MATCHES): Add armv7e-m.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Julian Brown  <julian@codesourcery.com>
	Catherine Moore  <clm@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>
	Richard Sandiford  <richard@codesourcery.com>
	Nigel Stephens  <nigel@mips.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc: Add MIPS multilib configurations. Enable soft-fp for
	mips-sde-elf.
	* config/mips/cs-sgxx-linux.h, config/mips/cs-sgxxlite-linux.h,
	config/mips/t-sgxx-linux, config/mips/t-sgxx-sde,
	config/mips/t-sgxxlite-linux, config/mips/t-fprules-softfp,
	config/mips/sfp-machine.h: New.
	* config/mips/mips.opt (mips16e): Add as deprecated alias
	for -mips16.
	* doc/invoke.texi (Option Summary, MIPS Options): Document it.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Joseph Myers  <joseph@codesourcery.com>
	
	gcc/
	* config.gcc (i[34567]86-*-linux*): Use extra config files if
	--enable-extra-sgxx-multilibs or --enable-extra-sgxxlite-multilibs.
	* config/i386/cs-linux-lite.h, config/i386/t-cs-linux-lite,
	config/i386/cs-linux.h, config/i386/cs-linux.opt,
	config/i386/t-cs-linux: New.
	* configure.ac (gcc_cv_libc_provides_ssp): Set to yes for
	GNU/Linux targets with libssp disabled.
	* configure: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	2009-05-01  Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* config/sh/cs-sgxxlite-linux.h, config/sh/t-sgxxlite-linux: New.
	* config.gcc: Add SH multilib configurations.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Nathan Froyd  <froydnj@codesourcery.com>
	Kazu Hirata <kazu@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Nathan Sidwell  <nathan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc: Add Power multilib configurations. Use
	rs6000/t-fprules-softfp and soft-fp/t-softfp.
	* config/rs6000/e500mc.h, config/rs6000/t-cs-eabi,
	config/rs6000/t-cs-eabi-lite, config/rs6000/t-cs-linux,
	config/rs6000/t-ppc-e500mc: New.
	* config/rs6000/cs-linux.h: New.
	* config/rs6000/eabi.h (CC1_EXTRA_SPEC, ASM_DEFAULT_SPEC): Define.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	2008-08-25  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/sysv4.h (LIB_SIM_SPEC): Use LIB_DEFAULT_SPEC.
	(STARTFILE_SIM_SPEC): Remove sim-crt0.o%s.
	(ENDFILE_SIM_SPEC): Add -Tsim-hosted.ld.
	(LINK_OS_SIM_SPEC): Define to empty.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Joseph Myers  <joseph@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/option-defaults.h (OPTION_DEFAULT_SPECS): Handle
	-te500mc, -te500v1, -te500v2 and -te600.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	gcc/
	* config/rs6000/sysv4.h (CC1_EXTRA_SPEC): Define and use.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Nathan Froyd  <froydnj@codesourcery.com>
	Andrew Stubbs  <ams@codesourcery.com>
	Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* doc/invoke.texi: Document -fremove-local-statics.
	* Makefile.in (OBJS-common): Add tree-ssa-remove-local-statics.o.
	* cgraph.c (cgraph_node): Set ever_was_nested in the node and
	its parent when creating a new node.
	* cgraph.h (struct cgraph_node): Add 'ever_was_nested'.
	* passes.c (init_optimization_passes): Add
	pass_remove_local_statics to the optimization passes.
	* timevar.def (TV_RLS): New timevar.
	* toplev.h (flag_remove_local_statics): Declare.
	* tree-pass.h (pass_remove_local_statics): Declare.
	* tree-ssa-remove-local-statics.c: New file.

	gcc/c-family/
	* c.opt (fremove-local-statics): New option (for C and C++).

	gcc/cp/
	* decl2.c (mark_used): Mark _DECLs as DECL_NONLOCAL if appropriate.

	gcc/testsuite/
	* g++.dg/remove-local-statics-1.C: New test.
	* g++.dg/remove-local-statics-2.C: New test.
	* gcc.dg/remove-local-statics-1.c: New file.
	* gcc.dg/remove-local-statics-2.c: New file.
	* gcc.dg/remove-local-statics-3.c: New file.
	* gcc.dg/remove-local-statics-4.c: New file.
	* gcc.dg/remove-local-statics-5.c: New file.
	* gcc.dg/remove-local-statics-6.c: New file.
	* gcc.dg/remove-local-statics-7.c: New file.
	* gcc.dg/remove-local-statics-8.c: New file.
	* gcc.dg/remove-local-statics-9.c: New file.
	* gcc.dg/remove-local-statics-10.c: New file.
	* gcc.dg/remove-local-statics-11.c: New file.
	* gcc.dg/remove-local-statics-12.c: New file.
	* gcc.dg/remove-local-statics-13.c: New test.
	* gcc.dg/remove-local-statics-14.c: New test.
	* gcc.dg/remove-local-statics-15.c: New test.
	* gcc.dg/remove-local-statics-16.c: New test.
	* gcc.dg/remove-local-statics-17.c: New test.
	* gcc.dg/remove-local-statics-18.c: New test.
	* gcc.dg/tree-ssa/pr21559.c: Compile with -fno-remove-local-statics.
	* gcc.dg/tree-ssa/ssa-dse-6.c: Likewise.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:
	
	Mark Mitchell  <mark@codesourcery.com>
	Vladimir Prus  <vladimir@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Carlos O'Donell  <carlos@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Kazu Hirata  <kazu@codesourcery.com>
	Pedro Alves  <pedro@codesourcery.com>

	libiberty/
	* configure.ac: Add cygpath for mingw hosts.
	* configure: Regenerate.
	* Makefile.in: Add cygpath.
	* cygpath.c: New.
	* lrealpath.c (lrealpath): Use cygpath on Windows.
	* pex-win32.c (pex_win32_open_read, pex_win32_open_write): Use
	open not _open.

	include/
	* libiberty.h (cygpath): Declare.

	config/
	* mh-mingw (CFLAGS, BOOT_CFLAGS): Do not use -D__USE_MINGW_ACCESS.
	Add a comment.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Paul Brook  <paul@codesourcery.com>
	Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* doc/fragments.texi: Document MULTILIB_ALIASES.
	* genmultilib: Add aliases.
	* Makefile.in (s-mlib): Pass MULTILIB_ALIASES.
	* config/print-sysroot-suffix.sh: Add support for MULTILIB_ALIASES.
	* config/t-sysroot-suffix: Pass MULTILIB_ALIASES.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:
	
	2008-09-03  Nathan Froyd  <froydnj@codesourcery.com>

	libgomp/
	* libgomp.texi (Library Index): Renamed from "Index" to prevent
	conflict with index.html on case-insensitive file systems.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

	2009-02-10  Mark Mitchell  <mark@codesourcery.com>

	libjava/classpath/
	* m4/acinclude.m4 (CLASSPATH_TOOLEXECLIBDIR): Match libjava.
	* configure.ac (--enable-version-specific-runtime-libs): Support.
	* Makefile.in, */Makefile.in: Regenerated.

	libjava/
	* Makefile.am (pkgconfigdir): Use toolexeclibdir, not $(libdir).
	* configure.ac (dbexecdir): Likewise.
	* configure: Regenerated.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.5:

	2009-02-10  Mark Mitchell  <mark@codesourcery.com>

	libjava/
	* Makefile.am (jardir): Set to a target-specific location.
	* Makefile.in: Regenerate.

	gcc/java/
	* Make-lang.in: Adjust to match.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Daniel Jacobowitz  <dan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* doc/invoke.texi (-Wno-poison-system-directories): Document.
	* gcc.c (LINK_COMMAND_SPEC): Pass --no-poison-system-directories
	if -Wno-poison-system-directories and --error-poison-system-directories
	if -Werror=poison-system-directories to linker.
	* incpath.c: Include flags.h. Include toplev.h.
	(merge_include_chains): If ENABLE_POISON_SYSTEM_DIRECTORIES defined
	and flag_poison_system_directories is true, warn for use of
	/usr/include, /usr/local/include or /usr/X11R6/include.
	* Makefile.in (incpath.o): Depend on $(FLAGS_H) and toplev.h.
	* common.opt (--Wno-poison-system-directories): New.
	* configure.ac (--enable-poison-system-directories): New option.
	* configure: Regenerate.
	* config.in: Regenerate.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.5:

	Mark Mitchell  <mark@codesourcery.com>
	Richard Sandiford  <richard@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Nathan Sidwell  <nathan@codesourcery.com>
	Nathan Froyd  <froydnj@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	NOT ASSIGNED TO FSF
	COPYRIGHT CODESOURCERY
	
	gcc/
	* Makefile.in (CSL_LICENSEINC): Define it.
	(CSL_LICENSELIB): Likewise.
	(CSL_LICENSE_PROG): Likewise.
	(LIBS): Depend on CSL_LICENSELIB.
	(GCC_PASSES): Depend on CSL_LICENSE_PROG.
	(INCLUDES): Add CSL_LICENSEINC.
	* acinclude.m4 (--with-license): New option.
	(--with-csl-license-feature): Likewise.
	(--with-csl-license-version): Likewise.
	* common.opt (flicense-me): Add option.
	(ffeature-proxy): Likewise.
	* gcc.c (csl/license.h): Include, if required.
	(license_checked): New variable.
	Define license_me_flag 1 if not TARGET_FLEXLM.
	(driver_handle_option): Handle -flicense-me, -ffeature-proxy and
	-fno-feature-proxy.
	(do_self_specs): Don't call get_feature for -E or -M.
	(main): Check licenses.
	* configure.ac (CSL_AC_LICENSE_VERSION): Use it.
	(CSL_AC_LICENSE): Likewise.
	(CSL_AC_LICENSE_FEATURE): Likewise.
	* config.in: Regenerated.
	* configure: Regenerated.

2011-07-28  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml: New.

Local Variables:
mode: change-log
change-log-default-name: "ChangeLog.csl"
End:
